/*!
 * This file is part of ReSampled SoundBox.
 *
 * Based on SoundBox by Marcus Geelnard (c) 2011-2013
 * 2016 pointofpresence
 * ReSampled.SoundBox (resampled-sound-box) - Online music tracker
 *
 * @version v0.0.1
 * @build Thu Feb 04 2016 00:56:11
 * @link https://github.com/pointofpresence/resampled-sound-box
 * @license GPL-3.0
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 * 1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 * 2. Altered source versions must be plainly marked as such, and must not be
 *    misrepresented as being the original software.
 *
 * 3. This notice may not be removed or altered from any source
 *    distribution.
 */
"use strict";var CPlayerWorker=function(){var t=function(t){return Math.sin(6.283184*t)},i=function(t){return 2*(t%1)-1},r=function(t){return.5>t%1?1:-1},s=function(t){var i=t%1*4;return 2>i?i-1:3-i},o=[t,r,i,s],n=function(t){return.003959503758*Math.pow(2,(t-128)/12)};this.init=function(t,i){this.firstRow=0,this.lastRow=t.endPattern-2,this.firstCol=0,this.lastCol=7,i&&(this.firstRow=i.firstRow,this.lastRow=i.lastRow,this.firstCol=i.firstCol,this.lastCol=i.lastCol),this.song=t,this.numSamples=t.rowLen*t.patternLen*(this.lastRow-this.firstRow+1),this.numWords=2*this.numSamples,this.mixBufWork=new Int32Array(this.numWords)};var e=function(t,i){var r,s,e,a,f=o[t.i[0]],h=t.i[1],l=t.i[3],u=o[t.i[4]],g=t.i[5],w=t.i[8],c=t.i[9],m=t.i[10]*t.i[10]*4,p=t.i[11]*t.i[11]*4,R=t.i[12]*t.i[12]*4,C=1/R,W=new Int32Array(m+p+R),d=n(i+t.i[2]-128),v=n(i+t.i[6]-128)*(1+8e-4*t.i[7]),k=0,y=0;for(r=0;m+p+R>r;r++)s=1,m>r?s=r/m:r>=m+p&&(s-=(r-m-p)*C),e=d,l&&(e*=s*s),k+=e,a=f(k)*h,e=v,w&&(e*=s*s),y+=e,a+=u(y)*g,c&&(a+=(2*Math.random()-1)*c),W[r]=80*a*s|0;return W};this.generate=function(){var i,r,s,n,a,f,h,l,u,g,w,c,m;for(f=this.firstCol;f<=this.lastCol;f++){var p,R,C=new Int32Array(this.numWords),W=this.mixBufWork,d=this.song.songData[f],v=this.song.rowLen,k=this.song.patternLen,y=0,M=0,P=!1,B=[];for(s=this.firstRow;s<=this.lastRow;++s){for(l=d.p[s],n=0;k>n;++n){var L=l?d.c[l-1].f[n]:0;L&&(d.i[L-1]=d.c[l-1].f[n+k]||0,14>L&&(B=[]));var x=o[d.i[13]],A=d.i[14]/512,I=Math.pow(2,d.i[15]-9)/v,b=d.i[16],S=d.i[17],D=43.23529*d.i[18]*3.141592/44100,j=1-d.i[19]/255,q=1e-5*d.i[20],z=d.i[21]/32,E=d.i[22]/512,F=6.283184*Math.pow(2,d.i[23]-9)/v,G=d.i[24]/255,H=d.i[25]*v;for(c=((s-this.firstRow)*k+n)*v,a=0;4>a;++a)if(h=l?d.c[l-1].n[n+a*k]:0){B[h]||(B[h]=e(d,h));var J=B[h];for(r=0,i=2*c;r<J.length;r++,i+=2)C[i]+=J[r]}for(r=0;v>r;r++)u=2*(c+r),w=C[u],w||P?(m=D,b&&(m*=x(I*u)*A+.5),m=1.5*Math.sin(m),y+=m*M,p=j*(w-M)-y,M+=m*p,w=3==S?M:1==S?p:y,q&&(w*=q,w=1>w?w>-1?t(.25*w):-1:1,w/=q),w*=z,P=w*w>1e-5,g=Math.sin(F*u)*E+.5,R=w*(1-g),w*=g):R=0,u>=H&&(R+=C[u-H+1]*G,w+=C[u-H]*G),C[u]=0|R,C[u+1]=0|w,W[u]+=0|R,W[u+1]+=0|w}var K=(f-this.firstCol+(s-this.firstRow)/(this.lastRow-this.firstRow+1))/(this.lastCol-this.firstCol+1);postMessage({cmd:"progress",progress:K,buffer:null})}}},this.getBuf=function(){return this.mixBufWork}},gPlayerWorker=new CPlayerWorker;onmessage=function(t){"generate"===t.data.cmd&&(gPlayerWorker.init(t.data.song,t.data.opts),gPlayerWorker.generate(),postMessage({cmd:"progress",progress:1,buffer:gPlayerWorker.getBuf()}))};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsYXllci13b3JrZXIuanMiXSwibmFtZXMiOlsiQ1BsYXllcldvcmtlciIsIm9zY19zaW4iLCJ2YWx1ZSIsIk1hdGgiLCJzaW4iLCJvc2Nfc2F3Iiwib3NjX3NxdWFyZSIsIm9zY190cmkiLCJ2MiIsIm1Pc2NpbGxhdG9ycyIsImdldG5vdGVmcmVxIiwibiIsInBvdyIsInRoaXMiLCJpbml0Iiwic29uZyIsIm9wdHMiLCJmaXJzdFJvdyIsImxhc3RSb3ciLCJlbmRQYXR0ZXJuIiwiZmlyc3RDb2wiLCJsYXN0Q29sIiwibnVtU2FtcGxlcyIsInJvd0xlbiIsInBhdHRlcm5MZW4iLCJudW1Xb3JkcyIsIm1peEJ1ZldvcmsiLCJJbnQzMkFycmF5IiwiY3JlYXRlTm90ZSIsImluc3RyIiwiaiIsImUiLCJ0IiwicnNhbXBsZSIsIm9zYzEiLCJpIiwibzF2b2wiLCJvMXhlbnYiLCJvc2MyIiwibzJ2b2wiLCJvMnhlbnYiLCJub2lzZVZvbCIsImF0dGFjayIsInN1c3RhaW4iLCJyZWxlYXNlIiwicmVsZWFzZUludiIsIm5vdGVCdWYiLCJvMXQiLCJvMnQiLCJjMSIsImMyIiwicmFuZG9tIiwiZ2VuZXJhdGUiLCJwIiwicm93IiwiY29sIiwiY3VycmVudENvbCIsImNwIiwiayIsInJvd1N0YXJ0U2FtcGxlIiwiZiIsImhpZ2giLCJsc2FtcGxlIiwiY2huQnVmIiwibWl4QnVmIiwic29uZ0RhdGEiLCJsb3ciLCJiYW5kIiwiZmlsdGVyQWN0aXZlIiwibm90ZUNhY2hlIiwiY21kTm8iLCJjIiwib3NjTEZPIiwibGZvQW10IiwibGZvRnJlcSIsImZ4TEZPIiwiZnhGaWx0ZXIiLCJmeEZyZXEiLCJxIiwiZGlzdCIsImRyaXZlIiwicGFuQW10IiwicGFuRnJlcSIsImRseUFtdCIsImRseSIsImxlbmd0aCIsInByb2dyZXNzIiwicG9zdE1lc3NhZ2UiLCJjbWQiLCJidWZmZXIiLCJnZXRCdWYiLCJnUGxheWVyV29ya2VyIiwib25tZXNzYWdlIiwiZXZlbnQiLCJkYXRhIl0s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bkNELEVBQUk3QixLQUFLQyxJQUFJOEUsRUFBVXhCLEdBQUt1QixFQUFTLEdBQ3JDbkIsRUFBVTdCLEdBQVcsRUFBSUQsR0FDekJDLEdBQVdELEdBRVg4QixFQUFVLEVBSVZKLEdBQUswQixJQUVMdEIsR0FBV0MsRUFBT0wsRUFBSTBCLEVBQU0sR0FBS0QsRUFHakNsRCxHQUFXOEIsRUFBT0wsRUFBSTBCLEdBQU9ELEdBSWpDcEIsRUFBT0wsR0FBZSxFQUFWSSxFQUNaQyxFQUFPTCxFQUFJLEdBQWUsRUFBVnpCLEVBR2hCK0IsRUFBT04sSUFBZ0IsRUFBVkksRUFDYkUsRUFBT04sRUFBSSxJQUFnQixFQUFWekIsRUFLekIsR0FBSXFELElBQVk5QixFQUFhM0MsS0FBS08sVUFBWWlDLEVBQUl4QyxLQUFLSSxXQUNsREosS0FBS0ssUUFBVUwsS0FBS0ksU0FBVyxLQUMvQkosS0FBS1EsUUFBVVIsS0FBS08sU0FBVyxFQUdwQ21FLGNBQ0lDLElBQVUsV0FDVkYsU0FBVUEsRUFDVkcsT0FBVSxVQU8xQjVFLEtBQUs2RSxPQUFTLFdBQ1YsTUFBTzdFLE1BQUthLGFBSWhCaUUsY0FBZ0IsR0FBSTNGLGNBRXhCNEYsV0FBWSxTQUFVQyxHQUNLLGFBQW5CQSxFQUFNQyxLQUFLTixNQUVYRyxjQUFjN0UsS0FBSytFLEVBQU1DLEtBQUsvRSxLQUFNOEUsRUFBTUMsS0FBSzlFLE1BQy9DMkUsY0FBY3ZDLFdBSWRtQyxhQUNJQyxJQUFVLFdBQ1ZGLFNBQVUsRUFDVkcsT0FBVUUsY0FBY0QiLCJmaWxlIjoicGxheWVyLXdvcmtlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgQ1BsYXllcldvcmtlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlIG1ldGhvZHNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8vIE9zY2lsbGF0b3JzXG4gICAgdmFyIG9zY19zaW4gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguc2luKHZhbHVlICogNi4yODMxODQpO1xuICAgIH07XG5cbiAgICB2YXIgb3NjX3NhdyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gMiAqICh2YWx1ZSAlIDEpIC0gMTtcbiAgICB9O1xuXG4gICAgdmFyIG9zY19zcXVhcmUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuICh2YWx1ZSAlIDEpIDwgMC41ID8gMSA6IC0xO1xuICAgIH07XG5cbiAgICB2YXIgb3NjX3RyaSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgdjIgPSAodmFsdWUgJSAxKSAqIDQ7XG5cbiAgICAgICAgaWYgKHYyIDwgMikge1xuICAgICAgICAgICAgcmV0dXJuIHYyIC0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAzIC0gdjI7XG4gICAgfTtcblxuICAgIC8vIEFycmF5IG9mIG9zY2lsbGF0b3IgZnVuY3Rpb25zXG4gICAgdmFyIG1Pc2NpbGxhdG9ycyA9IFtcbiAgICAgICAgb3NjX3NpbixcbiAgICAgICAgb3NjX3NxdWFyZSxcbiAgICAgICAgb3NjX3NhdyxcbiAgICAgICAgb3NjX3RyaVxuICAgIF07XG5cbiAgICB2YXIgZ2V0bm90ZWZyZXEgPSBmdW5jdGlvbiAobikge1xuICAgICAgICAvLyAxNzQuNjEuLiAvIDQ0MTAwID0gMC4wMDM5NTk1MDM3NTggKEYpXG4gICAgICAgIHJldHVybiAwLjAwMzk1OTUwMzc1OCAqIE1hdGgucG93KDIsIChuIC0gMTI4KSAvIDEyKTtcbiAgICB9O1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljIG1ldGhvZHNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8vIEluaXRpYWxpemUgYnVmZmVycyBldGMuXG4gICAgdGhpcy5pbml0ID0gZnVuY3Rpb24gKHNvbmcsIG9wdHMpIHtcbiAgICAgICAgLy8gSGFuZGxlIG9wdGlvbmFsIGFyZ3VtZW50c1xuICAgICAgICB0aGlzLmZpcnN0Um93ID0gMDtcbiAgICAgICAgdGhpcy5sYXN0Um93ID0gc29uZy5lbmRQYXR0ZXJuIC0gMjtcbiAgICAgICAgdGhpcy5maXJzdENvbCA9IDA7XG4gICAgICAgIHRoaXMubGFzdENvbCA9IDc7XG5cbiAgICAgICAgaWYgKG9wdHMpIHtcbiAgICAgICAgICAgIHRoaXMuZmlyc3RSb3cgPSBvcHRzLmZpcnN0Um93O1xuICAgICAgICAgICAgdGhpcy5sYXN0Um93ID0gb3B0cy5sYXN0Um93O1xuICAgICAgICAgICAgdGhpcy5maXJzdENvbCA9IG9wdHMuZmlyc3RDb2w7XG4gICAgICAgICAgICB0aGlzLmxhc3RDb2wgPSBvcHRzLmxhc3RDb2w7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQcmVwYXJlIHNvbmcgaW5mb1xuICAgICAgICB0aGlzLnNvbmcgPSBzb25nO1xuICAgICAgICB0aGlzLm51bVNhbXBsZXMgPSBzb25nLnJvd0xlbiAqIHNvbmcucGF0dGVybkxlbiAqICh0aGlzLmxhc3RSb3cgLSB0aGlzLmZpcnN0Um93ICsgMSk7XG4gICAgICAgIHRoaXMubnVtV29yZHMgPSB0aGlzLm51bVNhbXBsZXMgKiAyO1xuXG4gICAgICAgIC8vIENyZWF0ZSB3b3JrIGJ1ZmZlcnMgKGluaXRpYWxseSBjbGVhcmVkKVxuICAgICAgICB0aGlzLm1peEJ1ZldvcmsgPSBuZXcgSW50MzJBcnJheSh0aGlzLm51bVdvcmRzKTtcbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZU5vdGUgPSBmdW5jdGlvbiAoaW5zdHIsIG4pIHtcbiAgICAgICAgdmFyIG9zYzEgPSBtT3NjaWxsYXRvcnNbaW5zdHIuaVswXV0sXG4gICAgICAgICAgICBvMXZvbCA9IGluc3RyLmlbMV0sXG4gICAgICAgICAgICBvMXhlbnYgPSBpbnN0ci5pWzNdLFxuICAgICAgICAgICAgb3NjMiA9IG1Pc2NpbGxhdG9yc1tpbnN0ci5pWzRdXSxcbiAgICAgICAgICAgIG8ydm9sID0gaW5zdHIuaVs1XSxcbiAgICAgICAgICAgIG8yeGVudiA9IGluc3RyLmlbOF0sXG4gICAgICAgICAgICBub2lzZVZvbCA9IGluc3RyLmlbOV0sXG4gICAgICAgICAgICBhdHRhY2sgPSBpbnN0ci5pWzEwXSAqIGluc3RyLmlbMTBdICogNCxcbiAgICAgICAgICAgIHN1c3RhaW4gPSBpbnN0ci5pWzExXSAqIGluc3RyLmlbMTFdICogNCxcbiAgICAgICAgICAgIHJlbGVhc2UgPSBpbnN0ci5pWzEyXSAqIGluc3RyLmlbMTJdICogNCxcbiAgICAgICAgICAgIHJlbGVhc2VJbnYgPSAxIC8gcmVsZWFzZTtcblxuICAgICAgICB2YXIgbm90ZUJ1ZiA9IG5ldyBJbnQzMkFycmF5KGF0dGFjayArIHN1c3RhaW4gKyByZWxlYXNlKTtcblxuICAgICAgICAvLyBDYWxjdWxhdGUgbm90ZSBmcmVxdWVuY2llcyBmb3IgdGhlIG9zY2lsbGF0b3JzXG4gICAgICAgIHZhciBvMXQgPSBnZXRub3RlZnJlcShuICsgaW5zdHIuaVsyXSAtIDEyOCk7XG4gICAgICAgIHZhciBvMnQgPSBnZXRub3RlZnJlcShuICsgaW5zdHIuaVs2XSAtIDEyOCkgKiAoMSArIDAuMDAwOCAqIGluc3RyLmlbN10pO1xuXG4gICAgICAgIC8vIFJlLXRyaWcgb3NjaWxsYXRvcnNcbiAgICAgICAgdmFyIGMxID0gMCwgYzIgPSAwO1xuXG4gICAgICAgIC8vIExvY2FsIHZhcmlhYmxlcy5cbiAgICAgICAgdmFyIGosIGUsIHQsIHJzYW1wbGU7XG5cbiAgICAgICAgLy8gR2VuZXJhdGUgb25lIG5vdGUgKGF0dGFjayArIHN1c3RhaW4gKyByZWxlYXNlKVxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgYXR0YWNrICsgc3VzdGFpbiArIHJlbGVhc2U7IGorKykge1xuICAgICAgICAgICAgLy8gRW52ZWxvcGVcbiAgICAgICAgICAgIGUgPSAxO1xuXG4gICAgICAgICAgICBpZiAoaiA8IGF0dGFjaykge1xuICAgICAgICAgICAgICAgIGUgPSBqIC8gYXR0YWNrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChqID49IGF0dGFjayArIHN1c3RhaW4pIHtcbiAgICAgICAgICAgICAgICBlIC09IChqIC0gYXR0YWNrIC0gc3VzdGFpbikgKiByZWxlYXNlSW52O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBPc2NpbGxhdG9yIDFcbiAgICAgICAgICAgIHQgPSBvMXQ7XG5cbiAgICAgICAgICAgIGlmIChvMXhlbnYpIHtcbiAgICAgICAgICAgICAgICB0ICo9IGUgKiBlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjMSArPSB0O1xuICAgICAgICAgICAgcnNhbXBsZSA9IG9zYzEoYzEpICogbzF2b2w7XG5cbiAgICAgICAgICAgIC8vIE9zY2lsbGF0b3IgMlxuICAgICAgICAgICAgdCA9IG8ydDtcblxuICAgICAgICAgICAgaWYgKG8yeGVudikge1xuICAgICAgICAgICAgICAgIHQgKj0gZSAqIGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGMyICs9IHQ7XG4gICAgICAgICAgICByc2FtcGxlICs9IG9zYzIoYzIpICogbzJ2b2w7XG5cbiAgICAgICAgICAgIC8vIE5vaXNlIG9zY2lsbGF0b3JcbiAgICAgICAgICAgIGlmIChub2lzZVZvbCkge1xuICAgICAgICAgICAgICAgIHJzYW1wbGUgKz0gKDIgKiBNYXRoLnJhbmRvbSgpIC0gMSkgKiBub2lzZVZvbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWRkIHRvIChtb25vKSBjaGFubmVsIGJ1ZmZlclxuICAgICAgICAgICAgbm90ZUJ1ZltqXSA9ICg4MCAqIHJzYW1wbGUgKiBlKSB8IDA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbm90ZUJ1ZjtcbiAgICB9O1xuXG4gICAgLy8gR2VuZXJhdGUgYXVkaW8gZGF0YSBmb3IgYSBzaW5nbGUgdHJhY2tcbiAgICB0aGlzLmdlbmVyYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBMb2NhbCB2YXJpYWJsZXNcbiAgICAgICAgdmFyIGksIGosIHAsIHJvdywgY29sLCBjdXJyZW50Q29sLCBuLCBjcCxcbiAgICAgICAgICAgIGssIHQsIHJzYW1wbGUsIHJvd1N0YXJ0U2FtcGxlLCBmO1xuXG4gICAgICAgIGZvciAoY3VycmVudENvbCA9IHRoaXMuZmlyc3RDb2w7IGN1cnJlbnRDb2wgPD0gdGhpcy5sYXN0Q29sOyBjdXJyZW50Q29sKyspIHtcbiAgICAgICAgICAgIC8vIFB1dCBwZXJmb3JtYW5jZSBjcml0aWNhbCBpdGVtcyBpbiBsb2NhbCB2YXJpYWJsZXNcbiAgICAgICAgICAgIHZhciBjaG5CdWYgPSBuZXcgSW50MzJBcnJheSh0aGlzLm51bVdvcmRzKSxcbiAgICAgICAgICAgICAgICBtaXhCdWYgPSB0aGlzLm1peEJ1ZldvcmssXG4gICAgICAgICAgICAgICAgLy8gd2F2ZVNhbXBsZXMgPSB0aGlzLm51bVNhbXBsZXMsXG4gICAgICAgICAgICAgICAgLy8gd2F2ZVdvcmRzID0gdGhpcy5udW1Xb3JkcyxcbiAgICAgICAgICAgICAgICBpbnN0ciA9IHRoaXMuc29uZy5zb25nRGF0YVtjdXJyZW50Q29sXSxcbiAgICAgICAgICAgICAgICByb3dMZW4gPSB0aGlzLnNvbmcucm93TGVuLFxuICAgICAgICAgICAgICAgIHBhdHRlcm5MZW4gPSB0aGlzLnNvbmcucGF0dGVybkxlbjtcblxuICAgICAgICAgICAgLy8gQ2xlYXIgZWZmZWN0IHN0YXRlXG4gICAgICAgICAgICB2YXIgbG93ID0gMCwgYmFuZCA9IDAsIGhpZ2g7XG4gICAgICAgICAgICB2YXIgbHNhbXBsZSwgZmlsdGVyQWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIENsZWFyIG5vdGUgY2FjaGUuXG4gICAgICAgICAgICB2YXIgbm90ZUNhY2hlID0gW107XG5cbiAgICAgICAgICAgIC8vIFBhdHRlcm5zXG4gICAgICAgICAgICBmb3IgKHAgPSB0aGlzLmZpcnN0Um93OyBwIDw9IHRoaXMubGFzdFJvdzsgKytwKSB7XG4gICAgICAgICAgICAgICAgY3AgPSBpbnN0ci5wW3BdO1xuXG4gICAgICAgICAgICAgICAgLy8gUGF0dGVybiByb3dzXG4gICAgICAgICAgICAgICAgZm9yIChyb3cgPSAwOyByb3cgPCBwYXR0ZXJuTGVuOyArK3Jvdykge1xuICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIGVmZmVjdCBjb21tYW5kLlxuICAgICAgICAgICAgICAgICAgICB2YXIgY21kTm8gPSBjcCA/IGluc3RyLmNbY3AgLSAxXS5mW3Jvd10gOiAwO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjbWRObykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdHIuaVtjbWRObyAtIDFdID0gaW5zdHIuY1tjcCAtIDFdLmZbcm93ICsgcGF0dGVybkxlbl0gfHwgMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIG5vdGUgY2FjaGUgc2luY2UgdGhlIGluc3RydW1lbnQgaGFzIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY21kTm8gPCAxNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGVDYWNoZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUHV0IHBlcmZvcm1hbmNlIGNyaXRpY2FsIGluc3RydW1lbnQgcHJvcGVydGllcyBpbiBsb2NhbCB2YXJpYWJsZXNcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9zY0xGTyA9IG1Pc2NpbGxhdG9yc1tpbnN0ci5pWzEzXV0sXG4gICAgICAgICAgICAgICAgICAgICAgICBsZm9BbXQgPSBpbnN0ci5pWzE0XSAvIDUxMixcbiAgICAgICAgICAgICAgICAgICAgICAgIGxmb0ZyZXEgPSBNYXRoLnBvdygyLCBpbnN0ci5pWzE1XSAtIDkpIC8gcm93TGVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnhMRk8gPSBpbnN0ci5pWzE2XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ4RmlsdGVyID0gaW5zdHIuaVsxN10sXG4gICAgICAgICAgICAgICAgICAgICAgICBmeEZyZXEgPSBpbnN0ci5pWzE4XSAqIDQzLjIzNTI5ICogMy4xNDE1OTIgLyA0NDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHEgPSAxIC0gaW5zdHIuaVsxOV0gLyAyNTUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXN0ID0gaW5zdHIuaVsyMF0gKiAxZS01LFxuICAgICAgICAgICAgICAgICAgICAgICAgZHJpdmUgPSBpbnN0ci5pWzIxXSAvIDMyLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFuQW10ID0gaW5zdHIuaVsyMl0gLyA1MTIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYW5GcmVxID0gNi4yODMxODQgKiBNYXRoLnBvdygyLCBpbnN0ci5pWzIzXSAtIDkpIC8gcm93TGVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGx5QW10ID0gaW5zdHIuaVsyNF0gLyAyNTUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkbHkgPSBpbnN0ci5pWzI1XSAqIHJvd0xlbjtcblxuICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgc3RhcnQgc2FtcGxlIG51bWJlciBmb3IgdGhpcyByb3cgaW4gdGhlIHBhdHRlcm5cbiAgICAgICAgICAgICAgICAgICAgcm93U3RhcnRTYW1wbGUgPSAoKHAgLSB0aGlzLmZpcnN0Um93KSAqIHBhdHRlcm5MZW4gKyByb3cpICogcm93TGVuO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIG5vdGVzIGZvciB0aGlzIHBhdHRlcm4gcm93XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29sID0gMDsgY29sIDwgNDsgKytjb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBjcCA/IGluc3RyLmNbY3AgLSAxXS5uW3JvdyArIGNvbCAqIHBhdHRlcm5MZW5dIDogMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFub3RlQ2FjaGVbbl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90ZUNhY2hlW25dID0gY3JlYXRlTm90ZShpbnN0ciwgbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29weSBub3RlIGZyb20gdGhlIG5vdGUgY2FjaGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90ZUJ1ZiA9IG5vdGVDYWNoZVtuXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDAsIGkgPSByb3dTdGFydFNhbXBsZSAqIDI7IGogPCBub3RlQnVmLmxlbmd0aDsgaisrLCBpICs9IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2huQnVmW2ldICs9IG5vdGVCdWZbal07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUGVyZm9ybSBlZmZlY3RzIGZvciB0aGlzIHBhdHRlcm4gcm93XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCByb3dMZW47IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRHJ5IG1vbm8tc2FtcGxlXG4gICAgICAgICAgICAgICAgICAgICAgICBrID0gKHJvd1N0YXJ0U2FtcGxlICsgaikgKiAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcnNhbXBsZSA9IGNobkJ1ZltrXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2Ugb25seSBkbyBlZmZlY3RzIGlmIHdlIGhhdmUgc29tZSBzb3VuZCBpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJzYW1wbGUgfHwgZmlsdGVyQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhdGUgdmFyaWFibGUgZmlsdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGZ4RnJlcTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmeExGTykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmICo9IG9zY0xGTyhsZm9GcmVxICogaykgKiBsZm9BbXQgKyAwLjU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IDEuNSAqIE1hdGguc2luKGYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvdyArPSBmICogYmFuZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWdoID0gcSAqIChyc2FtcGxlIC0gYmFuZCkgLSBsb3c7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFuZCArPSBmICogaGlnaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByc2FtcGxlID0gZnhGaWx0ZXIgPT0gMyA/IGJhbmQgOiBmeEZpbHRlciA9PSAxID8gaGlnaCA6IGxvdztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERpc3RvcnRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByc2FtcGxlICo9IGRpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzYW1wbGUgPSByc2FtcGxlIDwgMSA/IHJzYW1wbGUgPiAtMSA/IG9zY19zaW4ocnNhbXBsZSAqIC4yNSkgOiAtMSA6IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzYW1wbGUgLz0gZGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEcml2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzYW1wbGUgKj0gZHJpdmU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJcyB0aGUgZmlsdGVyIGFjdGl2ZSAoaS5lLiBzdGlsbCBhdWRpYWJsZSk/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQWN0aXZlID0gcnNhbXBsZSAqIHJzYW1wbGUgPiAxZS01O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGFubmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBNYXRoLnNpbihwYW5GcmVxICogaykgKiBwYW5BbXQgKyAwLjU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbHNhbXBsZSA9IHJzYW1wbGUgKiAoMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzYW1wbGUgKj0gdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbHNhbXBsZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlbGF5IGlzIGFsd2F5cyBkb25lLCBzaW5jZSBpdCBkb2VzIG5vdCBuZWVkIHNvdW5kIGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayA+PSBkbHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMZWZ0IGNoYW5uZWwgPSBsZWZ0ICsgcmlnaHRbLXBdICogdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxzYW1wbGUgKz0gY2huQnVmW2sgLSBkbHkgKyAxXSAqIGRseUFtdDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJpZ2h0IGNoYW5uZWwgPSByaWdodCArIGxlZnRbLXBdICogdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzYW1wbGUgKz0gY2huQnVmW2sgLSBkbHldICogZGx5QW10O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTdG9yZSBpbiBzdGVyZW8gY2hhbm5lbCBidWZmZXIgKG5lZWRlZCBmb3IgdGhlIGRlbGF5IGVmZmVjdClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNobkJ1ZltrXSA9IGxzYW1wbGUgfCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2huQnVmW2sgKyAxXSA9IHJzYW1wbGUgfCAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAuLi5hbmQgYWRkIHRvIHN0ZXJlbyBtaXggYnVmZmVyXG4gICAgICAgICAgICAgICAgICAgICAgICBtaXhCdWZba10gKz0gbHNhbXBsZSB8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaXhCdWZbayArIDFdICs9IHJzYW1wbGUgfCAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gUG9zdCBwcm9ncmVzcyB0byB0aGUgbWFpbiB0aHJlYWQuLi5cbiAgICAgICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSAoY3VycmVudENvbCAtIHRoaXMuZmlyc3RDb2wgKyAocCAtIHRoaXMuZmlyc3RSb3cpIC9cbiAgICAgICAgICAgICAgICAgICAgKHRoaXMubGFzdFJvdyAtIHRoaXMuZmlyc3RSb3cgKyAxKSkgL1xuICAgICAgICAgICAgICAgICAgICAodGhpcy5sYXN0Q29sIC0gdGhpcy5maXJzdENvbCArIDEpO1xuXG4gICAgICAgICAgICAgICAgLy9ub2luc3BlY3Rpb24gSlNVbnJlc29sdmVkRnVuY3Rpb25cbiAgICAgICAgICAgICAgICBwb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgICAgIGNtZDogICAgICBcInByb2dyZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgIHByb2dyZXNzOiBwcm9ncmVzcyxcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiAgIG51bGxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBHZXQgdGhlIGZpbmFsIGJ1ZmZlciAoYXMgZ2VuZXJhdGVkIGJ5IHRoZSBnZW5lcmF0ZSgpIG1ldGhvZCkuXG4gICAgdGhpcy5nZXRCdWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1peEJ1Zldvcms7XG4gICAgfTtcbn07XG5cbnZhciBnUGxheWVyV29ya2VyID0gbmV3IENQbGF5ZXJXb3JrZXIoKTtcblxub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmRhdGEuY21kID09PSBcImdlbmVyYXRlXCIpIHtcbiAgICAgICAgLy8gR2VuZXJhdGUgdGhlIHNvdW5kIGRhdGEuXG4gICAgICAgIGdQbGF5ZXJXb3JrZXIuaW5pdChldmVudC5kYXRhLnNvbmcsIGV2ZW50LmRhdGEub3B0cyk7XG4gICAgICAgIGdQbGF5ZXJXb3JrZXIuZ2VuZXJhdGUoKTtcblxuICAgICAgICAvLyBTaWduYWwgdGhhdCB3ZSBhcmUgZG9uZSwgYW5kIHNlbmQgdGhlIHJlc3VsdGluZyBidWZmZXIgb3ZlciB0byB0aGUgbWFpbiB0aHJlYWQuXG4gICAgICAgIC8vbm9pbnNwZWN0aW9uIEpTVW5yZXNvbHZlZEZ1bmN0aW9uXG4gICAgICAgIHBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIGNtZDogICAgICBcInByb2dyZXNzXCIsXG4gICAgICAgICAgICBwcm9ncmVzczogMSxcbiAgICAgICAgICAgIGJ1ZmZlcjogICBnUGxheWVyV29ya2VyLmdldEJ1ZigpXG4gICAgICAgIH0pO1xuICAgIH1cbn07XG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
