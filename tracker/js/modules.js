/**
 * This file is part of ReSampled SoundBox.
 *
 * Based on SoundBox by Marcus Geelnard (c) 2011-2013
 * 2015 pointofpresence
 * ReSampled.SoundBox (resampled-sound-box) - Online music tracker
 *
 * @version v0.0.1
 * @build Thu Aug 06 2015 23:07:39
 * @link https://github.com/pointofpresence/resampled-sound-box
 * @license GPL-3.0
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 * 1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 * 2. Altered source versions must be plainly marked as such, and must not be
 *    misrepresented as being the original software.
 *
 * 3. This notice may not be removed or altered from any source
 *    distribution.
 */
function rle_encode(e){var t,n,r,a,o="";for(t=0;t<e.length;){for(r=e.charCodeAt(t),n=1;255>n&&t+n<e.length&&(a=e.charCodeAt(t+n),a==r);n++);n>3?(o+=String.fromCharCode(254),o+=String.fromCharCode(n),o+=String.fromCharCode(r)):(o+=String.fromCharCode(r),254==r&&(o+=String.fromCharCode(0)),n=1),t+=n}return o}function rle_decode(e){var t,n,r,a,o="";for(t=0;t<e.length;){if(r=e.charCodeAt(t++),254===r){if(1>t)break;if(a=e.charCodeAt(t++),0!=a){if(1>t)break;for(r=e.charCodeAt(t++),n=0;a>n;n++)o+=String.fromCharCode(r);continue}}o+=String.fromCharCode(r)}return o}function gui_init(){try{var e=new CGUI;e.init()}catch(t){alert("Unexpected error: "+t.message)}}!function(e){var t={change:e.noop},n={change:function(t){e(this).on("change",function(){e(this).next("output").val(e(this).val()),t()})},init:function(n){var r=e.extend(t,n||{});return this.each(function(){{var t=e(this),n=t.data("config")||{};e.extend(r,n)}t.wrap(e("<div/>",{"class":"rs-slider"})),t.after(e("<output/>",{"class":"rangevalue"})),t.next("output").val(parseInt(t.val()))})}};e.fn.rsSlider=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist in jQuery.rsSlider"):n.init.apply(this,arguments)}}(jQuery),gDemoSongs=[{name:"sway",description:" SWAY by m @ Bits'n'Bites, from the 4k demo <a href=\"http://pouet.net/prod.php?which=59203\">SWAY</a>",data:String.fromCharCode(83,66,111,120,8,2,237,154,65,107,19,65,20,199,255,179,51,179,141,166,49,197,82,161,66,48,80,164,122,235,65,177,7,193,67,114,244,86,61,89,232,161,158,84,12,38,177,32,107,183,75,65,171,165,39,167,244,32,4,161,244,27,120,20,84,122,243,43,120,242,27,120,241,30,103,179,219,180,221,100,119,74,117,179,89,120,191,201,236,219,183,111,19,94,38,111,231,237,155,236,251,25,224,170,245,216,3,255,225,65,99,87,112,40,24,159,253,214,250,163,236,7,182,100,22,211,112,161,165,110,192,68,33,104,246,5,12,195,113,182,60,221,55,221,117,215,27,182,143,148,153,54,216,23,12,246,88,255,177,170,173,171,177,239,107,32,117,138,37,195,9,215,78,248,225,68,252,114,144,15,154,161,116,35,122,211,109,56,77,119,45,245,248,41,197,30,239,181,98,37,198,94,197,77,84,48,91,206,58,126,74,197,233,114,130,185,172,125,124,145,96,63,140,139,159,213,156,196,79,195,129,211,208,175,56,57,246,241,239,194,109,234,87,84,182,61,120,109,52,95,129,32,146,232,190,100,232,62,7,131,176,231,124,221,186,196,216,252,125,169,247,88,15,171,191,119,44,135,162,250,91,53,68,87,99,63,16,138,98,129,32,8,130,200,37,59,65,191,43,46,214,241,69,130,253,222,66,245,153,156,18,58,111,91,220,226,194,207,238,220,111,128,236,33,204,217,112,55,162,143,34,75,154,234,214,185,179,101,115,21,241,95,141,234,78,36,85,255,149,82,227,238,127,214,119,82,38,255,235,103,26,123,117,180,81,81,61,15,241,67,16,68,62,177,190,123,186,239,92,6,158,182,182,241,78,50,171,176,60,179,184,43,31,22,120,176,170,62,216,98,62,169,145,243,145,104,230,220,255,172,199,255,138,193,44,147,237,139,116,45,18,4,65,156,15,142,13,240,250,6,216,79,33,110,176,59,130,89,181,214,235,175,53,123,222,95,68,247,243,54,15,165,159,193,153,240,27,55,215,85,42,131,154,252,127,16,239,191,82,121,241,61,207,36,196,15,253,249,65,16,4,17,199,35,15,88,241,38,129,73,212,122,69,122,183,140,234,18,127,43,122,25,156,7,25,60,148,128,144,34,174,182,250,164,39,219,143,186,119,122,114,175,175,239,135,122,218,79,94,73,211,242,98,45,217,156,228,127,71,111,221,49,255,33,51,31,127,227,61,163,201,255,125,28,4,82,139,253,1,61,109,76,225,51,107,176,119,66,127,59,161,191,81,61,99,254,241,234,32,8,98,172,107,242,15,59,96,191,60,61,205,46,99,133,127,150,140,95,223,186,87,219,227,29,187,127,138,95,151,7,213,121,144,197,99,166,228,104,166,216,28,241,55,41,26,150,119,151,13,115,213,155,211,234,246,201,204,189,62,10,255,13,182,149,4,123,5,217,63,163,110,90,93,191,101,200,36,38,255,183,13,246,118,138,227,15,195,248,15,137,159,1,76,119,130,107,52,25,17,4,113,94,186,79,152,238,96,144,19,7,65,77,14,107,106,73,222,62,122,68,253,248,81,245,193,35,167,160,229,79,130,32,8,130,24,61,127,1)},{name:"rechord",description:" re:chord by m @ Bits'n'Bites, from the 4k demo <a href=\"http://www.pouet.net/prod.php?which=60915\">re:chord</a>",base64:"U0JveAgC7ZpRa9NQFMfPzU0ycZ0gOEWYo6CC4AaDPakPPgk-TPDBtz34oEMRQcZkdJTZMEdLSUhDQrexSV_9AH6BoU9-Cz-DH8B6bpKmN0nTTGVNiueXnp5zc9v03Jvb_O9N254HWFR-GaD0jSsA2vICIEoFKuv32COFJTauii2IYAQ1OcJH3Y_rMIjKzrYc4WPTj7dgWqjBW9mw099hz0e2PdlsKpXx5cvL6fIb7PbIsPs38Bxs4Bl45Vux-SdJ5k8QBFEc_Csq-anB8dpVvQvPZhiff8iqK3xJlVXcf6WqoYIHcfCcxszxTsLbCe_l-LHXXj6-vmrkH6Od4c2MfK3Qd0LvJryTKJ8npuM5MbM9W7Zz175_fH_bdu2YWY4lzOy4HWFl_yYV3f85wz8aq1l0j3vHMTv6dCTs8KR3IoyulQRRXlDF0d4zgCdX15QdnSkLvVurDXVFHSj2UM2Hqj5KyWuJ8qRX4nM59QdnXpMHbIZ-q6D853LyX6PBSxAEQQglBwNVHJerfQ2u-1P7_k-4MahlyugNa7IP6XmpJbR3plV1SYjy90Q82OXRWCEIgiBKSR_X4_0PqMyqfseX9kug3Lx9MVTyELFfioGNEPJWjk0rQf6tFg0VgiAIopRr8pcG8O-GBqDp9-GbzvgiKEuevqMHK_JgZS7fWc_6lbyBeufAYczbki87u9DEPLuS3wcLfQPLnSnInyAIgvhPldy1gP0w_L_LPOdfNMYftNRrB9zQQ9Xmvo7zQL1VTdX0GbGlj-RkfIK4LW1PoCWzOfXrf3i8LmYeWDEqPpvTtgs5beuiTdP8wwEzGkMi8grs77-hjaPcjfW_gzNBMad1cSbolr7_90MLqOMMNo18Y2pvRL2Z8dpJsOfPxofzciOMPmbkPGhrU9rXjJ3PdJsIoqyw09cMnr4A9liFz0LPFZ3pq7vRZY1Jz0GU3CMrNkEQBEEQk-U3"},{name:"spacedust",description:" Space Dust by m @ Bits'n'Bites",data:String.fromCharCode(83,66,111,120,8,2,237,154,79,107,19,65,24,198,159,249,179,187,145,52,22,69,161,32,74,160,74,35,30,75,209,67,123,170,244,228,69,208,91,15,241,28,197,67,23,33,68,210,96,13,41,161,151,176,233,178,49,13,1,79,138,31,64,240,32,185,121,240,11,136,159,192,111,161,179,219,77,92,154,29,247,160,197,157,240,254,178,79,158,77,38,153,188,51,236,206,203,187,155,147,21,224,6,175,186,96,19,183,0,44,99,21,27,130,241,157,143,27,247,14,197,129,180,109,238,48,198,69,82,18,176,66,71,10,94,224,191,9,252,227,64,231,56,103,74,25,237,119,50,218,253,225,96,52,28,4,67,157,35,231,244,252,126,224,247,61,95,231,121,143,191,131,70,164,69,164,219,239,4,121,143,241,127,159,191,197,140,19,120,121,53,223,199,127,81,173,64,197,200,147,251,145,135,35,43,149,112,19,75,106,231,130,146,133,91,8,23,81,134,181,240,171,21,165,219,32,136,191,64,76,92,165,22,7,94,84,134,124,199,98,188,248,238,210,122,77,28,56,97,107,156,193,229,84,22,108,156,238,207,247,212,232,152,61,19,205,174,217,241,215,219,139,21,127,207,55,43,126,195,15,127,52,105,49,36,8,99,225,213,35,165,150,196,21,199,217,196,35,155,137,171,159,156,7,95,228,19,153,200,228,243,74,233,169,49,219,204,172,173,154,179,173,137,174,129,235,90,125,182,213,209,14,61,166,141,30,70,120,79,135,58,65,16,196,162,242,211,101,74,96,144,118,116,249,138,95,100,172,188,98,253,46,218,25,103,124,234,179,71,74,71,94,134,242,142,62,118,83,70,160,27,151,217,241,19,4,65,16,89,236,158,106,83,58,215,163,50,252,199,87,148,159,90,142,156,182,51,22,93,75,231,44,129,38,103,120,113,238,155,119,207,228,76,98,122,252,4,65,16,196,34,35,182,92,136,215,225,125,242,146,93,139,106,242,37,20,30,62,179,171,118,242,83,225,159,221,166,178,52,61,141,207,188,30,197,126,18,61,251,248,96,64,77,110,50,111,53,243,63,136,231,63,239,244,52,239,135,227,48,225,222,64,214,125,242,6,8,130,32,206,41,147,99,31,226,254,62,216,119,41,43,236,174,202,213,219,123,47,63,111,219,107,103,235,110,161,74,113,62,85,86,54,212,121,238,171,239,20,31,143,35,55,54,209,155,30,63,65,16,4,145,193,164,165,116,116,25,223,106,123,93,118,104,51,94,216,189,86,238,91,143,11,127,250,82,90,50,127,158,241,67,175,104,174,9,130,32,8,226,159,243,11)},{name:"8bit",description:" 8 Bit One by m @ Bits'n'Bites",data:String.fromCharCode(83,66,111,120,8,2,237,219,49,107,219,64,20,7,240,119,58,217,130,144,216,201,226,146,33,32,98,74,218,177,93,186,52,99,200,84,58,36,75,72,134,102,78,178,9,99,227,202,85,13,65,180,8,19,115,56,24,211,16,98,2,249,16,89,252,141,2,25,187,56,119,82,228,154,243,112,14,4,91,46,255,31,247,116,122,150,100,206,135,204,227,140,220,120,67,84,224,3,143,248,32,32,34,103,185,36,183,100,13,137,220,109,190,97,51,139,89,234,133,180,55,17,151,189,81,107,181,133,140,206,168,253,138,90,157,80,157,35,35,237,155,50,90,99,253,188,181,59,221,81,139,90,237,110,116,33,70,45,148,113,174,206,145,145,246,106,206,162,177,30,0,0,96,30,172,192,35,235,135,87,36,218,43,255,228,77,89,191,223,221,89,238,65,238,208,73,106,184,170,226,106,203,141,239,20,106,121,83,203,235,250,5,149,108,205,196,185,150,7,90,94,211,47,240,178,53,254,208,112,188,142,155,29,0,224,255,172,228,223,60,21,43,68,199,31,191,179,223,14,227,111,247,45,55,180,143,248,75,43,121,207,144,95,107,249,149,150,247,181,252,102,198,51,209,53,228,250,120,255,24,198,123,61,227,241,247,12,199,77,227,233,227,203,0,0,176,144,248,223,136,248,167,128,211,26,95,125,79,123,114,77,254,120,203,118,190,228,215,243,234,232,191,74,110,126,167,122,178,14,111,80,195,151,251,141,120,201,237,171,165,108,173,42,247,107,153,159,137,90,178,14,247,201,175,203,125,63,94,114,203,207,84,165,106,69,238,87,113,171,0,0,64,54,13,61,38,131,24,217,249,114,188,72,47,48,230,166,7,153,68,86,188,53,18,73,196,77,76,230,98,81,39,40,249,28,66,224,86,1,0,128,108,10,146,248,108,47,109,210,125,142,216,67,72,238,105,110,213,78,43,121,98,154,146,39,198,67,76,228,0,0,0,240,234,226,39,222,130,160,72,228,20,182,232,216,102,252,67,143,206,78,236,175,246,243,170,252,249,247,245,41,10,57,158,93,7,0,0,152,189,129,151,4,57,165,221,184,180,171,127,161,97,90,0,0,0,22,195,19)},{name:"4chordsong",description:" 4 Chord Song by m @ Bits'n'Bites, chord test inspired by <a href=\"http://www.youtube.com/watch?v=5pidokakU4I\">Axis of Awsome</a>",data:String.fromCharCode(83,66,111,120,8,2,237,153,65,107,19,81,16,199,231,189,151,77,2,105,14,90,8,138,72,115,80,170,168,24,76,3,70,237,161,164,90,176,74,245,166,168,72,169,199,80,2,45,24,66,36,123,168,49,100,27,82,210,96,212,196,80,20,36,8,222,252,0,30,252,22,130,31,64,4,63,130,190,236,190,109,195,146,237,174,77,163,151,255,111,102,24,246,205,16,102,103,55,12,239,237,167,179,68,19,252,134,78,124,81,23,68,39,194,115,52,45,24,127,190,196,227,122,224,36,39,98,140,9,226,140,145,47,74,125,89,43,229,10,36,101,181,176,86,36,41,185,98,46,79,82,178,249,156,65,150,148,149,84,148,108,40,169,43,169,42,177,243,237,188,134,146,154,18,59,223,206,139,202,26,246,179,139,210,230,165,37,165,101,164,205,12,248,57,31,245,239,119,239,27,213,202,22,141,72,212,99,61,229,18,207,140,220,127,11,247,254,91,184,247,127,175,206,225,22,221,237,127,70,245,255,186,180,132,122,30,9,185,122,158,0,0,0,28,20,241,109,155,248,186,30,36,10,70,22,104,94,78,242,196,179,200,185,219,193,227,65,198,184,226,112,38,249,184,239,196,158,24,110,126,153,110,209,85,229,211,202,95,51,253,34,93,246,81,127,163,213,54,181,241,242,181,169,205,86,219,212,102,171,99,234,184,38,185,205,2,94,86,0,0,0,67,224,73,185,39,191,160,203,105,157,138,117,233,81,136,137,163,211,20,79,104,179,26,27,192,207,48,47,41,95,80,190,168,124,94,249,178,195,87,28,222,222,219,85,29,215,198,238,158,209,162,230,184,182,55,195,17,151,186,236,245,83,46,241,148,163,126,55,202,30,113,195,35,94,247,136,71,60,226,15,240,178,2,0,0,24,2,251,162,247,141,17,77,76,94,162,87,26,19,167,219,137,116,86,36,133,25,101,150,249,161,108,212,77,45,87,107,166,86,140,186,169,21,99,203,84,231,164,207,57,38,61,0,0,0,0,254,30,241,93,151,195,116,157,104,50,44,166,232,67,128,241,99,119,143,172,220,209,158,6,213,164,231,140,11,30,240,241,75,239,149,239,42,191,163,124,103,96,189,165,178,186,244,209,244,77,149,213,161,222,200,119,18,243,56,158,94,153,58,88,253,61,31,245,247,232,243,184,31,84,204,35,62,243,191,251,239,245,117,32,59,226,153,70,11,127,86,0,0,24,62,201,223,173,50,246,88,238,203,179,20,222,161,165,16,19,247,223,240,248,25,109,205,26,222,76,217,8,108,163,201,0,0,0,192,24,217,180,236,119,183,219,165,164,220,129,95,249,69,203,247,216,91,245,105,156,249,30,228,47,208,74,0,0,0,224,223,211,63,93,255,33,247,228,244,53,242,147,102,195,196,181,205,155,233,39,218,195,208,94,138,191,89,238,117,58,90,66,175,1,0,0,128,67,231,15)}],gInstrumentPresets=[{name:"====[LEADS]===="},{name:"Softy",i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,195,6,1,2,135,0,0,32,147,6,121,6]},{name:"Classic 8-bit",i:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,69,3,1,1,23,167,0,32,77,6,25,6]},{name:"Square",i:[1,255,128,0,1,154,128,9,0,0,7,5,52,0,0,0,0,2,255,0,0,32,47,3,146,2]},{name:"Bell",i:[0,255,152,0,0,255,152,12,0,0,2,0,60,0,0,0,0,2,255,0,0,32,47,3,157,2]},{name:"Filter Bass 1",i:[2,100,128,0,3,201,128,0,0,0,0,6,29,0,195,4,1,3,50,184,119,244,147,6,84,6]},{name:"====[PADS]===="},{name:"Base string",i:[2,192,128,0,2,192,140,18,0,0,158,119,158,0,0,0,0,2,5,0,0,32,0,0,24,8]},{name:"Base string (dist)",i:[2,192,128,0,2,192,140,18,0,0,107,115,138,0,136,5,1,2,8,92,21,32,148,5,85,8]},{name:"Evil brass",i:[3,146,140,0,1,224,128,3,0,0,92,0,95,3,179,5,1,2,124,135,11,32,150,3,157,6]},{name:"====[DRUMS]===="},{name:"Bass drum 1",i:[0,255,116,1,0,255,116,0,1,0,4,6,35,0,0,0,0,2,14,0,0,32,0,0,0,0]},{name:"Bass drum 2",i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,2,14,0,1,39,76,5,0,0]},{name:"Bass drum 3",i:[0,255,116,1,0,255,116,0,1,14,4,6,45,0,0,0,0,2,136,15,0,32,0,0,66,6]},{name:"Base tom",i:[0,192,104,1,0,80,99,0,0,0,4,0,66,3,0,0,0,1,0,1,2,32,37,4,0,0]},{name:"Snare 1",i:[0,160,128,1,0,160,128,0,1,210,4,7,41,0,60,4,1,2,255,0,0,32,61,5,32,6]},{name:"Snare 2",i:[0,221,128,1,0,210,128,0,1,255,4,6,62,0,64,7,1,3,255,15,0,32,20,0,24,6]},{name:"Snare 3",i:[3,0,128,0,3,68,128,0,1,218,4,4,40,1,55,4,1,2,67,115,124,190,67,6,39,1]},{name:"Hihat 1",i:[0,0,140,0,0,0,140,0,0,60,4,10,34,0,187,5,0,1,239,135,0,32,108,5,16,4]},{name:"Hihat 2",i:[2,40,140,1,0,0,140,0,0,255,5,0,48,0,0,0,0,3,161,192,0,32,0,0,71,1]},{name:"Open hihat",i:[0,0,128,0,0,0,128,0,0,125,0,1,59,0,0,0,0,1,193,171,0,29,39,3,88,3]},{name:"Smash",i:[0,214,104,1,0,204,104,0,1,229,4,40,21,0,231,6,1,3,183,15,0,32,232,4,74,6]},{name:"Pipe hit",i:[3,255,128,0,0,255,140,0,0,127,2,2,23,0,96,3,1,3,94,79,0,32,84,2,12,4]},{name:"====[F/X]===="},{name:"Wind",i:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,51,2,1,2,58,239,0,32,88,1,157,2]},{name:"Long beat",i:[0,255,106,1,0,255,106,0,1,0,5,7,164,0,0,0,0,2,255,0,2,32,83,5,25,1]},{name:"Siren",i:[1,0,128,0,1,0,128,0,0,255,158,100,158,3,67,4,1,3,57,254,85,171,88,1,157,2]}];var CPlayer=function(){var e,t,n=new Worker("tracker/js/player-worker.js");n.onmessage=function(n){"progress"===n.data.cmd&&(t=n.data.buffer,e&&e(n.data.progress))},this.generate=function(t,r,a){e=a,n.postMessage({cmd:"generate",song:t,opts:r})},this.createWave=function(){var e=t,n=e.length,r=2*n-8,a=r-36,o=44,i=new Uint8Array(o+2*n);i.set([82,73,70,70,255&r,r>>8&255,r>>16&255,r>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&a,a>>8&255,a>>16&255,a>>24&255]);for(var s=0,c=o;n>s;++s){var d=e[s];d=-32767>d?-32767:d>32767?32767:d,i[c++]=255&d,i[c++]=d>>8&255}return i},this.getData=function(e,n){for(var r=2*Math.floor(44100*e),a=new Array(n),o=t,i=0;2*n>i;i+=1){var s=r+i;a[i]=e>0&&s<o.length?o[s]/32768:0}return a}},CJammer=function(){var e,t,n,r,a,o,i,s,c,d=8,f=[],u=131072,l=function(e){return Math.sin(6.283184*e)},p=function(e){return 2*(e%1)-1},m=function(e){return.5>e%1?1:-1},g=function(e){var t=e%1*4;return 2>t?t-1:3-t},v=function(e){return 174.614115728/s*Math.pow(2,(e-128)/12)},h=[l,m,p,g],E=function(o,i){var p,m,g,v,E,w,y,B=i.length;for(g=0;B>g;++g)o[g]=0,i[g]=0;for(p=0;d>p;++p){var _=f[p];if(void 0!=_){var I=h[_.instr[0]],b=_.instr[1],T=_.instr[3],L=h[_.instr[4]],D=_.instr[5],C=_.instr[8],x=_.instr[9],U=Math.round(_.instr[10]*_.instr[10]*4*c),S=Math.round(_.instr[11]*_.instr[11]*4*c),k=Math.round(_.instr[12]*_.instr[12]*4*c),Y=1/k,M=_.o1f,z=_.o2f,P=_.o1t,A=_.o2t,N=U+S+k-_.env;for(B>=N?f[p]=void 0:N=B,m=_.env,g=0;N>g;m++,g++)E=1,U>m?E=m/U:m>=U+S&&(E-=(m-U-S)*Y),v=M,T&&(v*=E*E),P+=v,w=I(P)*b,v=z,C&&(v*=E*E),A+=v,w+=L(A)*D,x&&(w+=(2*Math.random()-1)*x),i[g]+=.002441481*w*E;_.env=m,_.o1t=P,_.o2t=A}}var O,R,j,q=n.pos,F=n.low,X=n.band,H=n.filterActive,$=n.dlyPos,J=u-1,G=h[e[13]],W=e[14]/512,V=Math.pow(2,e[15]-9)/t,Q=e[16],Z=e[17],K=43.23529*e[18]*3.141592/s,ee=1-e[19]/255,te=1e-5*e[20]*32767,ne=e[21]/32,re=e[22]/512,ae=6.283184*Math.pow(2,e[23]-9)/t,oe=e[24]/255,ie=e[25]*t>>1;for(ie>=u&&(ie=u-1),m=0;B>m;m++)g=2*(q+m),w=i[m],w||H?(y=K,Q&&(y*=G(V*g)*W+.5),y=1.5*Math.sin(y),F+=y*X,R=ee*(w-X)-F,X+=y*R,w=3==Z?X:1==Z?R:F,te&&(w*=te,w=1>w?w>-1?l(.25*w):-1:1,w/=te),w*=ne,H=w*w>1e-5,v=Math.sin(ae*g)*re+.5,O=w*(1-v),w*=v):O=0,j=$-ie&J,O+=a[j]*oe,w+=r[j]*oe,r[$]=O,a[$]=w,$=$+1&J,o[m]=O,i[m]=w;for(q+=B;q>2048*t;)q-=2048*t;n.pos=q,n.low=F,n.band=X,n.filterActive=H,n.dlyPos=$};this.start=function(){if(window.AudioContext)o=new AudioContext;else{if(!window.webkitAudioContext)return void(o=void 0);o=new webkitAudioContext,o.createScriptProcessor=o.createJavaScriptNode}s=o.sampleRate,c=s/44100,n={pos:0,low:0,band:0,filterActive:!1,dlyPos:0},r=new Float32Array(u),a=new Float32Array(u),i=o.createScriptProcessor(2048,0,2),i.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0),n=e.outputBuffer.getChannelData(1);E(t,n)},i.connect(o.destination)},this.stop=function(){},this.updateInstr=function(t){e=[];for(var n=0;n<t.length;++n)e.push(t[n])},this.updateRowLen=function(e){t=Math.round(e*c)},this.addNote=function(t){var n,r=(new Date).getTime(),a={startT:r,env:0,o1t:0,o2t:0,o1f:v(t+e[2]-128),o2f:v(t+e[6]-128)*(1+8e-4*e[7]),instr:new Array(13)};for(n=0;13>n;++n)a.instr[n]=e[n];var o=0,i=-100;for(n=0;d>n;++n){if(void 0==f[n])return void(f[n]=a);var s=r-f[n].startT;s>i&&(o=n,i=s)}f[o]=a}};!function(){function e(){this.fc=0,this.dl=0}function t(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0}function n(e,t,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r}function r(){this.next=null,this.len=0,this.ptr=[],this.off=0}function a(n){var r;if(n?1>n?n=1:n>9&&(n=9):n=Ge,me=n,H=!1,fe=!1,null===Lt){for(q=F=X=null,Lt=[],W=[],V=[],Q=[],Z=[],he=[],r=0;bt>r;r++)he[r]=new e;for(Ee=[],r=0;2*wt+1>r;r++)Ee[r]=new e;for(we=[],r=0;Et+2>r;r++)we[r]=new e;for(ye=[],r=0;wt>r;r++)ye[r]=new e;for(Be=[],r=0;2*yt+1>r;r++)Be[r]=new e;_e=new t,Ie=new t,be=new t,Te=[],Le=[],xe=[],Ue=[],Se=[],ke=[],Ye=[],Me=[]}}function o(e){e.next=q,q=e}function i(){var e;return null!==q?(e=q,q=q.next):e=new r,e.next=null,e.len=e.off=0,e}function s(e){return Z[Xe+e]}function c(e,t){return Z[Xe+e]=t}function d(e){Lt[J+$++]=e,J+$===Qe&&R()}function f(e){e&=65535,Qe-2>J+$?(Lt[J+$++]=255&e,Lt[J+$++]=e>>>8):(d(255&e),d(e>>>8))}function u(){ne=(ne<<Tt^255&W[ce+Ke-1])&it,re=s(ne),Z[ce&st]=re,c(ne,ce)}function l(e,t){A(t[e].fc,t[e].dl)}function p(e){return 255&(256>e?Se[e]:Se[256+(e>>7)])}function m(e,t,n){return e[t].fc<e[n].fc||e[t].fc===e[n].fc&&xe[t]<=xe[n]}function g(e,t,n){var r;for(r=0;n>r&&Fe<qe.length;r++)e[t+r]=255&qe[Fe++];return r}function v(){var e;for(e=0;ot>e;e++)Z[Xe+e]=0;if(pe=St[me].max_lazy,ge=St[me].good_length,We||(ve=St[me].nice_length),le=St[me].max_chain,ce=0,te=0,ue=g(W,0,2*Xe),0>=ue)return fe=!0,void(ue=0);for(fe=!1;ft>ue&&!fe;)E();for(ne=0,e=0;Ke-1>e;e++)ne=(ne<<Tt^255&W[e])&it}function h(e){var t,n,r,a,o=le,i=ce,s=se,c=ce>ut?ce-ut:ct,d=ce+et,f=W[i+s-1],u=W[i+s];se>=ge&&(o>>=2);do if(t=e,W[t+s]===u&&W[t+s-1]===f&&W[t]===W[i]&&W[++t]===W[i+1]){for(i+=2,t++;d>i;){for(a=!1,r=0;8>r;r+=1)if(i+=1,t+=1,W[i]!==W[t]){a=!0;break}if(a)break}if(n=et-(d-i),i=d-et,n>s){if(de=e,s=n,We){if(n>=et)break}else if(n>=ve)break;f=W[i+s-1],u=W[i+s]}}while((e=Z[e&st])>c&&0!==--o);return s}function E(){var e,t,n=Ze-ue-ce;if(-1===n)n--;else if(ce>=Xe+ut){for(e=0;Xe>e;e++)W[e]=W[e+Xe];for(de-=Xe,ce-=Xe,te-=Xe,e=0;ot>e;e++)t=s(e),c(e,t>=Xe?t-Xe:ct);for(e=0;Xe>e;e++)t=Z[e],Z[e]=t>=Xe?t-Xe:ct;n+=Xe}fe||(e=g(W,ce+ue,n),0>=e?fe=!0:ue+=e)}function w(){for(;0!==ue&&null===F;){var e;if(u(),re!==ct&&ut>=ce-re&&(ie=h(re),ie>ue&&(ie=ue)),ie>=Ke)if(e=z(ce-de,ie-Ke),ue-=ie,pe>=ie){ie--;do ce++,u();while(0!==--ie);ce++}else ce+=ie,ie=0,ne=255&W[ce],ne=(ne<<Tt^255&W[ce+1])&it;else e=z(0,255&W[ce]),ue--,ce++;for(e&&(M(0),te=ce);ft>ue&&!fe;)E()}}function y(){for(;0!==ue&&null===F;){if(u(),se=ie,ae=de,ie=Ke-1,re!==ct&&pe>se&&ut>=ce-re&&(ie=h(re),ie>ue&&(ie=ue),ie===Ke&&ce-de>dt&&ie--),se>=Ke&&se>=ie){var e;e=z(ce-1-ae,se-Ke),ue-=se-1,se-=2;do ce++,u();while(0!==--se);oe=!1,ie=Ke-1,ce++,e&&(M(0),te=ce)}else oe?(z(0,255&W[ce-1])&&(M(0),te=ce),ce++,ue--):(oe=!0,ce++,ue--);for(;ft>ue&&!fe;)E()}}function B(){fe||(K=0,ee=0,b(),v(),F=null,$=0,J=0,3>=me?(se=Ke-1,ie=0):(ie=Ke-1,oe=!1),G=!1)}function _(e,t,n){var r;return H||(B(),H=!0,0!==ue)?(r=I(e,t,n),r===n?n:G?r:(3>=me?w():y(),0===ue&&(oe&&z(0,255&W[ce-1]),M(1),G=!0),r+I(e,r+t,n-r))):(G=!0,0)}function I(e,t,n){var r,a,i;for(r=0;null!==F&&n>r;){for(a=n-r,a>F.len&&(a=F.len),i=0;a>i;i++)e[t+r+i]=F.ptr[F.off+i];if(F.off+=a,F.len-=a,r+=a,0===F.len){var s;s=F,F=F.next,o(s)}}if(r===n)return r;if($>J){for(a=n-r,a>$-J&&(a=$-J),i=0;a>i;i++)e[t+r+i]=Lt[J+i];J+=a,r+=a,$===J&&($=J=0)}return r}function b(){var e,t,n,r,a;if(0===ye[0].dl){for(_e.dyn_tree=he,_e.static_tree=we,_e.extra_bits=Dt,_e.extra_base=vt+1,_e.elems=Et,_e.max_length=pt,_e.max_code=0,Ie.dyn_tree=Ee,Ie.static_tree=ye,Ie.extra_bits=Ct,Ie.extra_base=0,Ie.elems=wt,Ie.max_length=pt,Ie.max_code=0,be.dyn_tree=Be,be.static_tree=null,be.extra_bits=xt,be.extra_base=0,be.elems=yt,be.max_length=mt,be.max_code=0,n=0,r=0;gt-1>r;r++)for(ke[r]=n,e=0;e<1<<Dt[r];e++)Ue[n++]=r;for(Ue[n-1]=r,a=0,r=0;16>r;r++)for(Ye[r]=a,e=0;e<1<<Ct[r];e++)Se[a++]=r;for(a>>=7;wt>r;r++)for(Ye[r]=a<<7,e=0;e<1<<Ct[r]-7;e++)Se[256+a++]=r;for(t=0;pt>=t;t++)Te[t]=0;for(e=0;143>=e;)we[e++].dl=8,Te[8]++;for(;255>=e;)we[e++].dl=9,Te[9]++;for(;279>=e;)we[e++].dl=7,Te[7]++;for(;287>=e;)we[e++].dl=8,Te[8]++;for(C(we,Et+1),e=0;wt>e;e++)ye[e].dl=5,ye[e].fc=N(e,5);T()}}function T(){var e;for(e=0;Et>e;e++)he[e].fc=0;for(e=0;wt>e;e++)Ee[e].fc=0;for(e=0;yt>e;e++)Be[e].fc=0;he[ht].fc=1,Re=je=0,ze=Pe=Ae=0,Ne=0,Oe=1}function L(e,t){for(var n=Le[t],r=t<<1;De>=r&&(De>r&&m(e,Le[r+1],Le[r])&&r++,!m(e,n,Le[r]));)Le[t]=Le[r],t=r,r<<=1;Le[t]=n}function D(e){var t,n,r,a,o,i,s=e.dyn_tree,c=e.extra_bits,d=e.extra_base,f=e.max_code,u=e.max_length,l=e.static_tree,p=0;for(a=0;pt>=a;a++)Te[a]=0;for(s[Le[Ce]].dl=0,t=Ce+1;bt>t;t++)n=Le[t],a=s[s[n].dl].dl+1,a>u&&(a=u,p++),s[n].dl=a,n>f||(Te[a]++,o=0,n>=d&&(o=c[n-d]),i=s[n].fc,Re+=i*(a+o),null!==l&&(je+=i*(l[n].dl+o)));if(0!==p){do{for(a=u-1;0===Te[a];)a--;Te[a]--,Te[a+1]+=2,Te[u]--,p-=2}while(p>0);for(a=u;0!==a;a--)for(n=Te[a];0!==n;)r=Le[--t],r>f||(s[r].dl!==a&&(Re+=(a-s[r].dl)*s[r].fc,s[r].fc=a),n--)}}function C(e,t){var n,r,a=[],o=0;for(n=1;pt>=n;n++)o=o+Te[n-1]<<1,a[n]=o;for(r=0;t>=r;r++){var i=e[r].dl;0!==i&&(e[r].fc=N(a[i]++,i))}}function x(e){var t,n,r=e.dyn_tree,a=e.static_tree,o=e.elems,i=-1,s=o;for(De=0,Ce=bt,t=0;o>t;t++)0!==r[t].fc?(Le[++De]=i=t,xe[t]=0):r[t].dl=0;for(;2>De;){var c=Le[++De]=2>i?++i:0;r[c].fc=1,xe[c]=0,Re--,null!==a&&(je-=a[c].dl)}for(e.max_code=i,t=De>>1;t>=1;t--)L(r,t);do t=Le[lt],Le[lt]=Le[De--],L(r,lt),n=Le[lt],Le[--Ce]=t,Le[--Ce]=n,r[s].fc=r[t].fc+r[n].fc,xe[s]=xe[t]>xe[n]+1?xe[t]:xe[n]+1,r[t].dl=r[n].dl=s,Le[lt]=s++,L(r,lt);while(De>=2);Le[--Ce]=Le[lt],D(e),C(r,i)}function U(e,t){var n,r,a=-1,o=e[0].dl,i=0,s=7,c=4;for(0===o&&(s=138,c=3),e[t+1].dl=65535,n=0;t>=n;n++)r=o,o=e[n+1].dl,++i<s&&r===o||(c>i?Be[r].fc+=i:0!==r?(r!==a&&Be[r].fc++,Be[Bt].fc++):10>=i?Be[_t].fc++:Be[It].fc++,i=0,a=r,0===o?(s=138,c=3):r===o?(s=6,c=3):(s=7,c=4))}function S(e,t){var n,r,a=-1,o=e[0].dl,i=0,s=7,c=4;for(0===o&&(s=138,c=3),n=0;t>=n;n++)if(r=o,o=e[n+1].dl,!(++i<s&&r===o)){if(c>i){do l(r,Be);while(0!==--i)}else 0!==r?(r!==a&&(l(r,Be),i--),l(Bt,Be),A(i-3,2)):10>=i?(l(_t,Be),A(i-3,3)):(l(It,Be),A(i-11,7));i=0,a=r,0===o?(s=138,c=3):r===o?(s=6,c=3):(s=7,c=4)}}function k(){var e;for(U(he,_e.max_code),U(Ee,Ie.max_code),x(be),e=yt-1;e>=3&&0===Be[Ut[e]].dl;e--);return Re+=3*(e+1)+5+5+4,e}function Y(e,t,n){var r;for(A(e-257,5),A(t-1,5),A(n-4,4),r=0;n>r;r++)A(Be[Ut[r]].dl,3);S(he,e-1),S(Ee,t-1)}function M(e){var t,n,r,a,o;if(a=ce-te,Me[Ae]=Ne,x(_e),x(Ie),r=k(),t=Re+3+7>>3,n=je+3+7>>3,t>=n&&(t=n),t>=a+4&&te>=0)for(A((He<<1)+e,3),O(),f(a),f(~a),o=0;a>o;o++)d(W[te+o]);else n===t?(A(($e<<1)+e,3),P(we,ye)):(A((Je<<1)+e,3),Y(_e.max_code+1,Ie.max_code+1,r+1),P(he,Ee));T(),0!==e&&O()}function z(e,t){if(Q[ze++]=t,0===e?he[t].fc++:(e--,he[Ue[t]+vt+1].fc++,Ee[p(e)].fc++,V[Pe++]=e,Ne|=Oe),Oe<<=1,0===(7&ze)&&(Me[Ae++]=Ne,Ne=0,Oe=1),me>2&&0===(4095&ze)){var n,r=8*ze,a=ce-te;for(n=0;wt>n;n++)r+=Ee[n].fc*(5+Ct[n]);if(r>>=3,Pe<parseInt(ze/2,10)&&r<parseInt(a/2,10))return!0}return ze===nt-1||Pe===at}function P(e,t){var n,r,a,o,i=0,s=0,c=0,d=0;if(0!==ze)do 0===(7&i)&&(d=Me[c++]),r=255&Q[i++],0===(1&d)?l(r,e):(a=Ue[r],l(a+vt+1,e),o=Dt[a],0!==o&&(r-=ke[a],A(r,o)),n=V[s++],a=p(n),l(a,t),o=Ct[a],0!==o&&(n-=Ye[a],A(n,o))),d>>=1;while(ze>i);l(ht,e)}function A(e,t){ee>kt-t?(K|=e<<ee,f(K),K=e>>kt-ee,ee+=t-kt):(K|=e<<ee,ee+=t)}function N(e,t){var n=0;do n|=1&e,e>>=1,n<<=1;while(--t>0);return n>>1}function O(){ee>8?f(K):ee>0&&d(K),K=0,ee=0}function R(){var e,t;if(0!==$){for(e=i(),null===F?F=X=e:X=X.next=e,e.len=$-J,t=0;t<e.len;t++)e.ptr[t]=Lt[J+t];$=J=0}}function j(e,t){var n,r,o;if("string"==typeof e)for(o=e,e=[],n=0;n<o.length;n++)e[n]=o.charCodeAt(n);qe=e,Fe=0,"undefined"==typeof t&&(t=Ge),a(t),r=[];do n=_(r,r.length,1024);while(n>0);for(qe=null,o="",n=0;n<r.length;n++)o+=String.fromCharCode(r[n]);return o}var q,F,X,H,$,J,G,W,V,Q,Z,K,ee,te,ne,re,ae,oe,ie,se,ce,de,fe,ue,le,pe,me,ge,ve,he,Ee,we,ye,Be,_e,Ie,be,Te,Le,De,Ce,xe,Ue,Se,ke,Ye,Me,ze,Pe,Ae,Ne,Oe,Re,je,qe,Fe,Xe=32768,He=0,$e=1,Je=2,Ge=6,We=!1,Ve=32768,Qe=8192,Ze=2*Xe,Ke=3,et=258,tt=16,nt=8192,rt=15,at=nt,ot=1<<rt,it=ot-1,st=Xe-1,ct=0,dt=4096,ft=et+Ke+1,ut=Xe-ft,lt=1,pt=15,mt=7,gt=29,vt=256,ht=256,Et=vt+1+gt,wt=30,yt=19,Bt=16,_t=17,It=18,bt=2*Et+1,Tt=parseInt((rt+Ke-1)/Ke,10),Lt=null;nt>Ve&&console.error("error: INBUFSIZ is too small"),Xe<<1>1<<tt&&console.error("error: WSIZE is too large"),rt>tt-1&&console.error("error: HASH_BITS is too large"),(8>rt||258!==et)&&console.error("error: Code too clever");var Dt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ct=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],xt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ut=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],St=[new n(0,0,0,0),new n(4,4,8,4),new n(4,5,16,8),new n(4,6,32,32),new n(4,4,16,16),new n(8,16,32,32),new n(8,16,128,128),new n(8,32,128,256),new n(32,128,258,1024),new n(32,258,258,4096)],kt=16;window.RawDeflate||(window.RawDeflate={}),window.RawDeflate.deflate=j}(),function(){function e(){this.next=null,this.list=null}function t(){this.e=0,this.b=0,this.n=0,this.t=null}function n(n,r,a,o,i,s){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var c,d,f,u,l,p,m,g,v,h,E,w,y,B,_,I,b,T=[],L=[],D=new t,C=[],x=[],U=[];for(b=this.root=null,p=0;p<this.BMAX+1;p++)T[p]=0;for(p=0;p<this.BMAX+1;p++)L[p]=0;for(p=0;p<this.BMAX;p++)C[p]=null;for(p=0;p<this.N_MAX;p++)x[p]=0;for(p=0;p<this.BMAX+1;p++)U[p]=0;d=r>256?n[256]:this.BMAX,v=n,h=0,p=r;do T[v[h]]++,h++;while(--p>0);if(T[0]===r)return this.root=null,this.m=0,void(this.status=0);for(m=1;m<=this.BMAX&&0===T[m];m++);for(g=m,m>s&&(s=m),p=this.BMAX;0!==p&&0===T[p];p--);for(u=p,s>p&&(s=p),B=1<<m;p>m;m++,B<<=1)if((B-=T[m])<0)return this.status=2,void(this.m=s);if((B-=T[p])<0)return this.status=2,void(this.m=s);for(T[p]+=B,U[1]=m=0,v=T,h=1,y=2;--p>0;)U[y++]=m+=v[h++];v=n,h=0,p=0;do 0!==(m=v[h++])&&(x[U[m]++]=p);while(++p<r);for(r=U[u],U[0]=p=0,v=x,h=0,l=-1,w=L[0]=0,E=null,_=0,null;u>=g;g++)for(c=T[g];c-->0;){for(;g>w+L[1+l];){if(w+=L[1+l],l++,_=(_=u-w)>s?s:_,(f=1<<(m=g-w))>c+1)for(f-=c+1,y=g;++m<_&&!((f<<=1)<=T[++y]);)f-=T[y];for(w+m>d&&d>w&&(m=d-w),_=1<<m,L[1+l]=m,E=[],I=0;_>I;I++)E[I]=new t;b=b?b.next=new e:this.root=new e,b.next=null,b.list=E,C[l]=E,l>0&&(U[l]=p,D.b=L[l],D.e=16+m,D.t=E,m=(p&(1<<w)-1)>>w-L[l],C[l-1][m].e=D.e,C[l-1][m].b=D.b,C[l-1][m].n=D.n,C[l-1][m].t=D.t)}for(D.b=g-w,h>=r?D.e=99:v[h]<a?(D.e=v[h]<256?16:15,D.n=v[h++]):(D.e=i[v[h]-a],D.n=o[v[h++]-a]),f=1<<g-w,m=p>>w;_>m;m+=f)E[m].e=D.e,E[m].b=D.b,E[m].n=D.n,E[m].t=D.t;for(m=1<<g-1;0!==(p&m);m>>=1)p^=m;for(p^=m;(p&(1<<w)-1)!==U[l];)w-=L[l],l--}this.m=L[1],this.status=0!==B&&1!==u?1:0}function r(){return x.length===U?-1:255&x[U++]}function a(e){for(;e>y;)w|=r()<<y,y+=8}function o(e){return w&N[e]}function i(e){w>>=e,y-=e}function s(e,t,n){var r,s,c;if(0===n)return 0;for(c=0;;){for(a(D),s=T.list[o(D)],r=s.e;r>16;){if(99===r)return-1;i(s.b),r-=16,a(r),s=s.t[o(r)],r=s.e}if(i(s.b),16!==r){if(15===r)break;for(a(r),I=s.n+o(r),i(r),a(C),s=L.list[o(C)],r=s.e;r>16;){if(99===r)return-1;i(s.b),r-=16,a(r),s=s.t[o(r)],r=s.e}for(i(s.b),a(r),b=g-s.n-o(r),i(r);I>0&&n>c;)I--,b&=S-1,g&=S-1,e[t+c++]=m[g++]=m[b++];if(c===n)return n}else if(g&=S-1,e[t+c++]=m[g++]=s.n,c===n)return n}return B=-1,c}function c(e,t,n){var r;if(r=7&y,i(r),a(16),r=o(16),i(16),a(16),r!==(65535&~w))return-1;for(i(16),I=r,r=0;I>0&&n>r;)I--,g&=S-1,a(8),e[t+r++]=m[g++]=o(8),i(8);return 0===I&&(B=-1),r}function d(e,t,r){if(!A){var a,o,i=[];for(a=0;144>a;a++)i[a]=8;for(null;256>a;a++)i[a]=9;for(null;280>a;a++)i[a]=7;for(null;288>a;a++)i[a]=8;if(h=7,o=new n(i,288,257,O,R,h),0!==o.status)return console.error("HufBuild error: "+o.status),-1;for(A=o.root,h=o.m,a=0;30>a;a++)i[a]=5;if(E=5,o=new n(i,30,0,j,q,E),o.status>1)return A=null,console.error("HufBuild error: "+o.status),-1;v=o.root,E=o.m}return T=A,L=v,D=h,C=E,s(e,t,r)}function f(e,t,r){var c,d,f,u,l,p,m,g,v,h=[];for(c=0;316>c;c++)h[c]=0;if(a(5),m=257+o(5),i(5),a(5),g=1+o(5),i(5),a(4),p=4+o(4),i(4),m>286||g>30)return-1;for(d=0;p>d;d++)a(3),h[F[d]]=o(3),i(3);for(null;19>d;d++)h[F[d]]=0;if(D=7,v=new n(h,19,19,null,null,D),0!==v.status)return-1;for(T=v.root,D=v.m,u=m+g,c=f=0;u>c;)if(a(D),l=T.list[o(D)],d=l.b,i(d),d=l.n,16>d)h[c++]=f=d;else if(16===d){if(a(2),d=3+o(2),i(2),c+d>u)return-1;for(;d-->0;)h[c++]=f}else if(17===d){if(a(3),d=3+o(3),i(3),c+d>u)return-1;for(;d-->0;)h[c++]=0;f=0}else{if(a(7),d=11+o(7),i(7),c+d>u)return-1;for(;d-->0;)h[c++]=0;f=0}if(D=z,v=new n(h,m,257,O,R,D),0===D&&(v.status=1),0!==v.status&&1!==v.status)return-1;for(T=v.root,D=v.m,c=0;g>c;c++)h[c]=h[c+m];return C=P,v=new n(h,g,0,j,q,C),L=v.root,C=v.m,0===C&&m>257?-1:0!==v.status?-1:s(e,t,r)}function u(){m||(m=[]),g=0,w=0,y=0,B=-1,_=!1,I=b=0,T=null}function l(e,t,n){var r,u;for(r=0;n>r;){if(_&&-1===B)return r;if(I>0){if(B!==k)for(;I>0&&n>r;)I--,b&=S-1,g&=S-1,e[t+r++]=m[g++]=m[b++];else{for(;I>0&&n>r;)I--,g&=S-1,a(8),e[t+r++]=m[g++]=o(8),i(8);0===I&&(B=-1)}if(r===n)return r}if(-1===B){if(_)break;a(1),0!==o(1)&&(_=!0),i(1),a(2),B=o(2),i(2),T=null,I=0}switch(B){case k:u=c(e,t+r,n-r);break;case Y:u=T?s(e,t+r,n-r):d(e,t+r,n-r);break;case M:u=T?s(e,t+r,n-r):f(e,t+r,n-r);break;default:u=-1}if(-1===u)return _?0:-1;r+=u}return r}function p(e){var t,n,r=[];if("string"==typeof e)for(n=e,e=[],t=0;t<n.length;t++)e[t]=n.charCodeAt(t);u(),x=e,U=0;do t=l(r,r.length,1024);while(t>0);for(x=null,n="",t=0;t<r.length;t++)n+=String.fromCharCode(r[t]);return n}var m,g,v,h,E,w,y,B,_,I,b,T,L,D,C,x,U,S=32768,k=0,Y=1,M=2,z=9,P=6,A=null,N=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],O=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],j=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];window.RawDeflate||(window.RawDeflate={}),window.RawDeflate.inflate=p}();var saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(e){"use strict";var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=e.URL||e.webkitURL||e,a=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in a,i=function(n){var r=t.createEvent("MouseEvents");r.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(r)},s=e.webkitRequestFileSystem,c=e.requestFileSystem||s||e.mozRequestFileSystem,d=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},f="application/octet-stream",u=0,l=[],p=function(){for(var e=l.length;e--;){var t=l[e];"string"==typeof t?r.revokeObjectURL(t):t.remove()}l.length=0},m=function(e,t,n){
t=[].concat(t);for(var r=t.length;r--;){var a=e["on"+t[r]];if("function"==typeof a)try{a.call(e,n||e)}catch(o){d(o)}}},g=function(t,r){var d,p,g,v=this,h=t.type,E=!1,w=function(){var e=n().createObjectURL(t);return l.push(e),e},y=function(){m(v,"writestart progress write writeend".split(" "))},B=function(){(E||!d)&&(d=w(t)),p?p.location.href=d:window.open(d,"_blank"),v.readyState=v.DONE,y()},_=function(e){return function(){return v.readyState!==v.DONE?e.apply(this,arguments):void 0}},I={create:!0,exclusive:!1};return v.readyState=v.INIT,r||(r="download"),o?(d=w(t),a.href=d,a.download=r,i(a),v.readyState=v.DONE,void y()):(e.chrome&&h&&h!==f&&(g=t.slice||t.webkitSlice,t=g.call(t,0,t.size,f),E=!0),s&&"download"!==r&&(r+=".download"),(h===f||s)&&(p=e),c?(u+=t.size,void c(e.TEMPORARY,u,_(function(e){e.root.getDirectory("saved",I,_(function(e){var n=function(){e.getFile(r,I,_(function(e){e.createWriter(_(function(n){n.onwriteend=function(t){p.location.href=e.toURL(),l.push(e),v.readyState=v.DONE,m(v,"writeend",t)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&B()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=v["on"+e]}),n.write(t),v.abort=function(){n.abort(),v.readyState=v.DONE},v.readyState=v.WRITING}),B)}),B)};e.getFile(r,{create:!1},_(function(e){e.remove(),n()}),_(function(e){e.code===e.NOT_FOUND_ERR?n():B()}))}),B)}),B)):void B())},v=g.prototype,h=function(e,t){return new g(e,t)};return v.abort=function(){var e=this;e.readyState=e.DONE,m(e,"abort")},v.readyState=v.INIT=0,v.WRITING=1,v.DONE=2,v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null,e.addEventListener("unload",p,!1),h}(self);!function(e){"use strict";function t(){}function n(){this.inputInUse=!1,this.outputInUse=!1;var e=document.createElement("object");e.id="_Jazz"+Math.random()+"ie",e.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",this.activeX=e;var t=document.createElement("object");t.id="_Jazz"+Math.random(),t.type="audio/x-jazz",e.appendChild(t),this.objRef=t;var n=document.createElement("p");n.appendChild(document.createTextNode("This page requires the "));var r=document.createElement("a");r.appendChild(document.createTextNode("Jazz plugin")),r.href="http://jazz-soft.net/",n.appendChild(r),n.appendChild(document.createTextNode(".")),t.appendChild(n);var a=document.getElementById("MIDIPlugin");if(!a){var a=document.createElement("div");a.id="MIDIPlugin",a.style.position="absolute",a.style.visibility="hidden",a.style.left="-9999px",a.style.top="-9999px",document.body.appendChild(a)}a.appendChild(e),this._Jazz=this.objRef.isJazz?this.objRef:this.activeX.isJazz?this.activeX:null,this._Jazz&&(this._Jazz._jazzTimeZero=this._Jazz.Time(),this._Jazz._perfTimeZero=window.performance.now())}function r(){this._jazzInstances=new Array,this._jazzInstances.push(new n),this._promise=new t,this._jazzInstances[0]._Jazz?(this._Jazz=this._jazzInstances[0]._Jazz,window.setTimeout(s.bind(this),3)):window.setTimeout(a.bind(this),3)}function a(){this._promise&&this._promise.fail({code:1})}function o(){this.jazz.MidiOutLong(this.data)}var i,r,s,c,d,f;t.prototype.then=function(e,t){this.accept=e,this.reject=t},t.prototype.succeed=function(e){this.accept&&this.accept(e)},t.prototype.fail=function(e){this.reject&&this.reject(e)},i=function(){var e=new r;return e._promise},s=function(){this._promise&&this._promise.succeed(this)},r.prototype.inputs=function(){if(!this._Jazz)return null;for(var e=this._Jazz.MidiInList(),t=new Array(e.length),n=0;n<e.length;n++)t[n]=new c(this,e[n],n);return t},r.prototype.outputs=function(){if(!this._Jazz)return null;for(var e=this._Jazz.MidiOutList(),t=new Array(e.length),n=0;n<e.length;n++)t[n]=new d(this,e[n],n);return t},c=function(e,t,r){this._listeners=[],this._midiAccess=e,this._index=r,this._inLongSysexMessage=!1,this._sysexBuffer=new Uint8Array,this.id=""+r+"."+t,this.manufacturer="",this.name=t,this.type="input",this.version="",this.onmidimessage=null;for(var a=null,o=0;o<e._jazzInstances.length&&!a;o++)e._jazzInstances[o].inputInUse||(a=e._jazzInstances[o]);a||(a=new n,e._jazzInstances.push(a)),a.inputInUse=!0,this._jazzInstance=a._Jazz,this._input=this._jazzInstance.MidiInOpen(this._index,f.bind(this))},c.prototype.addEventListener=function(e,t,n){if("midimessage"===e){for(var r=0;r<this._listeners.length;r++)if(this._listeners[r]==t)return;this._listeners.push(t)}},c.prototype.removeEventListener=function(e,t,n){if("midimessage"===e)for(var r=0;r<this._listeners.length;r++)if(this._listeners[r]==t)return void this._listeners.splice(r,1)},c.prototype.preventDefault=function(){this._pvtDef=!0},c.prototype.dispatchEvent=function(e){this._pvtDef=!1;for(var t=0;t<this._listeners.length;t++)this._listeners[t].handleEvent?this._listeners[t].handleEvent.bind(this)(e):this._listeners[t].bind(this)(e);return this.onmidimessage&&this.onmidimessage(e),this._pvtDef},c.prototype.appendToSysexBuffer=function(e){var t=this._sysexBuffer.length,n=new Uint8Array(t+e.length);n.set(this._sysexBuffer),n.set(e,t),this._sysexBuffer=n},c.prototype.bufferLongSysex=function(e,t){for(var n=t;n<e.length;){if(247==e[n])return n++,this.appendToSysexBuffer(e.slice(t,n)),n;n++}return this.appendToSysexBuffer(e.slice(t,n)),this._inLongSysexMessage=!0,n},f=function(e,t){var n,r=0,a=!1;for(n=0;n<t.length;n+=r){if(this._inLongSysexMessage){if(n=this.bufferLongSysex(t,n),247!=t[n-1])return;a=!0}else switch(a=!1,240&t[n]){case 128:case 144:case 160:case 176:case 224:r=3;break;case 192:case 208:r=2;break;case 240:switch(t[n]){case 240:if(n=this.bufferLongSysex(t,n),247!=t[n-1])return;a=!0;break;case 241:case 243:r=2;break;case 242:r=3;break;default:r=1}}var o=document.createEvent("Event");o.initEvent("midimessage",!1,!1),o.receivedTime=parseFloat(e.toString())+this._jazzInstance._perfTimeZero,a||this._inLongSysexMessage?(o.data=new Uint8Array(this._sysexBuffer),this._sysexBuffer.length=0,this._inLongSysexMessage=!1):o.data=new Uint8Array(t.slice(n,r+n)),this.dispatchEvent(o)}},d=function(e,t,r){this._listeners=[],this._midiAccess=e,this._index=r,this.id=""+r+"."+t,this.manufacturer="",this.name=t,this.type="output",this.version="";for(var a=null,o=0;o<e._jazzInstances.length&&!a;o++)e._jazzInstances[o].outputInUse||(a=e._jazzInstances[o]);a||(a=new n,e._jazzInstances.push(a)),a.outputInUse=!0,this._jazzInstance=a._Jazz,this._jazzInstance.MidiOutOpen(this.name)},d.prototype.send=function(e,t){var n=0;if(0===e.length)return!1;if(t&&(n=Math.floor(t-window.performance.now())),t&&n>1){var r=new Object;r.jazz=this._jazzInstance,r.data=e,window.setTimeout(o.bind(r),n)}else this._jazzInstance.MidiOutLong(e);return!0},window.navigator.requestMIDIAccess||(window.navigator.requestMIDIAccess=i)}(window),function(e){function t(){for(var t=["moz","webkit","o","ms"],n=t.length,r={value:function(e){return function(){return Date.now()-e}}(Date.now())};n>=0;n--)if(t[n]+"Now"in e.performance)return r.value=function(t){return function(){e.performance[t]()}}(t[n]+"Now"),r;return"timing"in e.performance&&"connectStart"in e.performance.timing&&(r.value=function(e){return function(){Date.now()-e}}(e.performance.timing.connectStart)),r}var n,r={};"performance"in e&&"now"in e.performance||("performance"in e||Object.defineProperty(e,"performance",{get:function(){return r}}),n=t(),Object.defineProperty(e.performance,"now",n))}(window);var CBinParser=function(e){var t=e,n=0;this.getUBYTE=function(){return 255&t.charCodeAt(n++)},this.getUSHORT=function(){var e=255&t.charCodeAt(n)|(255&t.charCodeAt(n+1))<<8;return n+=2,e},this.getULONG=function(){var e=255&t.charCodeAt(n)|(255&t.charCodeAt(n+1))<<8|(255&t.charCodeAt(n+2))<<16|(255&t.charCodeAt(n+3))<<24;return n+=4,e},this.getFLOAT=function(){var e=this.getULONG();if(0==e)return 0;var t=2147483648&e,n=e>>23&255,r=1+(8388607&e)/8388608,a=r*Math.pow(2,n-127);return t?-a:a},this.getTail=function(){var e=t.slice(n);return n=t.length,e}},CBinWriter=function(){var e="";this.putUBYTE=function(t){e+=String.fromCharCode(t)},this.putUSHORT=function(t){e+=String.fromCharCode(255&t,t>>8&255)},this.putULONG=function(t){e+=String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},this.putFLOAT=function(e){var t=0;if(0!=e){var n=0;0>e&&(n=2147483648,e=-e);for(var r=150;8388608>e;)e*=2,r--;for(;e>=16777216;)e/=2,r++;t=n|(255&r)<<23|8388607&e}this.putULONG(t)},this.append=function(t){e+=t},this.getData=function(){return e}},CAudioTimer=function(){var e=null,t=0,n=[0,0,0,0,0,0],r=0;this.setAudioElement=function(t){e=t},this.currentTime=function(){if(!e)return 0;var a,o=.001*(new Date).getTime(),i=o-t,s=e.currentTime,c=s-i;if(.01>s||c>.2||-.2>c)for(i=s,t=o-i,a=0;a<n.length;a++)n[a]=0;var d=0;for(a=0;a<n.length;a++)d+=n[a];return d/=n.length,n[r]=c,r=(r+1)%n.length,i+d},this.reset=function(){t=.001*(new Date).getTime();for(var e=0;e<n.length;e++)n[e]=0}},CGUI=function(){function e(){}var t,n,r,a,o,i="tracker/image/gui/",s=0,c=1,d=2,f=3,u=128,l=36,p=d,m=5,g=0,v=0,h=0,E=0,w=0,y=0,B=0,_=0,I=0,b=0,T=!1,L=!1,D=!1,C=[],x=[],U=[],S=[],k={},Y=null,M=new CAudioTimer,z=new CPlayer,P=new Image,A=new Image,N=new Image,O=new CJammer,R=["C-","C#","D-","D#","E-","F-","F#","G-","G#","A-","A#","B-"],j=[26,1,63,3,116,6,150,8,184,10,238,13,274,15,327,18,362,20,394,22],q=[],F=function(e){var t=e.indexOf("?");return e.slice(0,t>=0?t:e.length)},X=function(e){var t=e.indexOf("?")+1,n=e.indexOf("#")+1||e.length+1,r=e.slice(t,n-1),a={};if(r===e||""===r)return a;for(var o=r.replace(/\+/g," ").split("&"),i=0;i<o.length;i++){var s=o[i].split("="),c=decodeURIComponent(s[0]),d=decodeURIComponent(s[1]);c in a||(a[c]=[]),a[c].push(2===s.length?d:null)}return a},H=function(e){var t=void 0;if(e){var n=e,r="";if(0==n.indexOf("data:")){var a=n.indexOf("base64,");a>0&&(r=n.substr(a+7))}else for(var o=0;o<n.length;++o){var i=n[o];"-"===i&&(i="+"),"_"===i&&(i="/"),r+=i}try{t=atob(r)}catch(s){t=void 0}}return t},J=function(e){for(var n=btoa(e),r="",a=0;a<n.length;++a){var o=n[a];"+"===o&&(o="-"),"/"===o&&(o="_"),"="===o&&(o=""),r+=o}return t+"?data="+r},G=function(e){return Math.round(661500/e)},W=function(){return Math.round(661500/k.rowLen)},V=0,Q=1,Z=2,K=3,ee=4,te=5,ne=6,re=7,ae=8,oe=9,ie=10,se=11,ce=12,de=13,fe=14,ue=15,le=16,pe=17,me=18,ge=19,ve=20,he=21,Ee=22,we=23,ye=24,Be=25,_e=function(){var e,t,n,r,a,o={};o.rowLen=G(120),o.endPattern=2,o.patternLen=32;var i;for(e=0;e<gInstrumentPresets.length;++e)if(gInstrumentPresets[e].i){i=gInstrumentPresets[e];break}for(o.songData=[],e=0;8>e;e++){for(r={},r.i=[],t=0;t<=i.i.length;++t)r.i[t]=i.i[t];for(r.p=[],t=0;u>t;t++)r.p[t]=0;for(r.c=[],t=0;l>t;t++){for(a={},a.n=[],n=0;n<4*o.patternLen;n++)a.n[n]=0;for(a.f=[],n=0;n<2*o.patternLen;n++)a.f[n]=0;r.c[t]=a}o.songData[e]=r}return o.songData[0].p[0]=1,o},Ie=function(e){var t=new CBinWriter;t.putULONG(e.rowLen),t.putUBYTE(e.endPattern-2),t.putUBYTE(e.patternLen);var n,r,a,o,i;for(n=0;8>n;n++){for(o=e.songData[n],t.putUBYTE(o.i[V]),t.putUBYTE(o.i[Q]),t.putUBYTE(o.i[Z]),t.putUBYTE(o.i[K]),t.putUBYTE(o.i[ee]),t.putUBYTE(o.i[te]),t.putUBYTE(o.i[ne]),t.putUBYTE(o.i[re]),t.putUBYTE(o.i[ae]),t.putUBYTE(o.i[oe]),t.putUBYTE(o.i[ie]),t.putUBYTE(o.i[se]),t.putUBYTE(o.i[ce]),t.putUBYTE(o.i[de]),t.putUBYTE(o.i[fe]),t.putUBYTE(o.i[ue]),t.putUBYTE(o.i[le]),t.putUBYTE(o.i[pe]),t.putUBYTE(o.i[me]),t.putUBYTE(o.i[ge]),t.putUBYTE(o.i[ve]),t.putUBYTE(o.i[he]),t.putUBYTE(o.i[Ee]),t.putUBYTE(o.i[we]),t.putUBYTE(o.i[ye]),t.putUBYTE(o.i[Be]),r=0;u>r;r++)t.putUBYTE(o.p[r]);for(r=0;l>r;r++){for(i=o.c[r],a=0;a<4*e.patternLen;a++)t.putUBYTE(i.n[a]);for(a=0;a<2*e.patternLen;a++)t.putUBYTE(i.f[a])}}var s,c,d=t.getData(),f=0;for(n=9;n>0;n--)if(s=RawDeflate.deflate(d,n),c=RawDeflate.inflate(s),d===c){f=2;break}return 0==f&&(s=rle_encode(t.getData()),c=rle_decode(s),d===c?f=1:s=d),t=new CBinWriter,t.putULONG(2020557395),t.putUBYTE(10),t.putUBYTE(f),t.append(s),t.getData()},be=function(e){var t=new CBinParser(e),n={},r=t.getULONG(),a=t.getUBYTE();if(2020557395!=r||1>a||a>10)return void 0;if(a>=8){var o,i=t.getUBYTE(),s=t.getTail();switch(i){default:case 0:o=s;break;case 1:o=rle_decode(s);break;case 2:o=RawDeflate.inflate(s)}t=new CBinParser(o)}n.rowLen=t.getULONG(),n.endPattern=t.getUBYTE()+2,n.patternLen=a>=10?t.getUBYTE():32,n.songData=[];var c,d,f,p,m;for(c=0;8>c;c++){p={},p.i=[],6>a?(p.i[Z]=t.getUBYTE(),p.i[K]=t.getUBYTE(),p.i[Q]=t.getUBYTE(),p.i[V]=t.getUBYTE()):(p.i[V]=t.getUBYTE(),p.i[Q]=t.getUBYTE(),p.i[Z]=t.getUBYTE(),p.i[K]=t.getUBYTE()),6>a?(p.i[ne]=t.getUBYTE(),p.i[re]=t.getUBYTE(),p.i[ae]=t.getUBYTE(),p.i[te]=t.getUBYTE(),p.i[ee]=t.getUBYTE()):(p.i[ee]=t.getUBYTE(),p.i[te]=t.getUBYTE(),p.i[ne]=t.getUBYTE(),p.i[re]=t.getUBYTE(),p.i[ae]=t.getUBYTE()),p.i[oe]=t.getUBYTE(),5>a?(p.i[ie]=Math.round(Math.sqrt(t.getULONG())/2),p.i[se]=Math.round(Math.sqrt(t.getULONG())/2),p.i[ce]=Math.round(Math.sqrt(t.getULONG())/2)):(p.i[ie]=t.getUBYTE(),p.i[se]=t.getUBYTE(),p.i[ce]=t.getUBYTE()),6>a?(p.i[pe]=t.getUBYTE(),p.i[me]=5>a?Math.round(t.getUSHORT()/43.23529):t.getUBYTE(),p.i[ge]=t.getUBYTE(),p.i[Be]=t.getUBYTE(),p.i[ye]=t.getUBYTE(),p.i[we]=t.getUBYTE(),p.i[Ee]=t.getUBYTE(),p.i[ve]=t.getUBYTE(),p.i[he]=t.getUBYTE(),p.i[le]=t.getUBYTE(),p.i[ue]=t.getUBYTE(),p.i[fe]=t.getUBYTE(),p.i[de]=t.getUBYTE()):(p.i[de]=t.getUBYTE(),p.i[fe]=t.getUBYTE(),p.i[ue]=t.getUBYTE(),p.i[le]=t.getUBYTE(),p.i[pe]=t.getUBYTE(),p.i[me]=t.getUBYTE(),p.i[ge]=t.getUBYTE(),p.i[ve]=t.getUBYTE(),p.i[he]=t.getUBYTE(),p.i[Ee]=t.getUBYTE(),p.i[we]=t.getUBYTE(),p.i[ye]=t.getUBYTE(),p.i[Be]=t.getUBYTE());var g=9>a?48:u;for(p.p=[],d=0;g>d;d++)p.p[d]=t.getUBYTE();for(d=g;u>d;d++)p.p[d]=0;var v=9>a?10:l;for(p.c=[],d=0;v>d;d++){if(m={},m.n=[],1==a)for(f=0;f<n.patternLen;f++)m.n[f]=t.getUBYTE(),m.n[f+n.patternLen]=0,m.n[f+2*n.patternLen]=0,m.n[f+3*n.patternLen]=0;else for(f=0;f<4*n.patternLen;f++)m.n[f]=t.getUBYTE();if(m.f=[],4>a)for(f=0;f<2*n.patternLen;f++)m.f[f]=0;else for(f=0;f<2*n.patternLen;f++)m.f[f]=t.getUBYTE();p.c[d]=m}for(d=v;l>d;d++){for(m={},m.n=[],f=0;f<4*n.patternLen;f++)m.n[f]=0;for(m.f=[],f=0;f<2*n.patternLen;f++)m.f[f]=0;p.c[d]=m}3>a&&(2==p.i[V]&&(p.i[Q]=Math.round(p.i[Q]/2)),2==p.i[ee]&&(p.i[te]=Math.round(p.i[te]/2)),2==p.i[de]&&(p.i[fe]=Math.round(p.i[fe]/2)),p.i[he]=p.i[he]<224?p.i[he]+32:255),7>a&&(p.i[ge]=255-p.i[ge]),n.songData[c]=p}return n},Te=function(e){if(3333!=e.length)return void 0;if((255&e.charCodeAt(3332))>48)return void 0;var t=new CBinParser(e),n={};n.rowLen=t.getULONG(),n.patternLen=32,n.songData=[];var r,a,o,i,s,c;for(r=0;8>r;r++){for(i={},i.i=[],i.i[Z]=12*(t.getUBYTE()-8)+128,i.i[Z]+=t.getUBYTE(),t.getUBYTE(),i.i[K]=t.getUBYTE(),i.i[Q]=t.getUBYTE(),i.i[V]=t.getUBYTE(),i.i[ne]=12*(t.getUBYTE()-8)+128,i.i[ne]+=t.getUBYTE(),i.i[re]=t.getUBYTE(),i.i[ae]=t.getUBYTE(),i.i[te]=t.getUBYTE(),i.i[ee]=t.getUBYTE(),i.i[oe]=t.getUBYTE(),t.getUBYTE(),t.getUBYTE(),t.getUBYTE(),i.i[ie]=Math.round(Math.sqrt(t.getULONG())/2),i.i[se]=Math.round(Math.sqrt(t.getULONG())/2),i.i[ce]=Math.round(Math.sqrt(t.getULONG())/2),c=t.getUBYTE(),i.i[pe]=t.getUBYTE(),t.getUBYTE(),t.getUBYTE(),i.i[me]=Math.round(t.getFLOAT()/43.23529),i.i[ge]=255-t.getUBYTE(),i.i[Be]=t.getUBYTE(),i.i[ye]=t.getUBYTE(),i.i[we]=t.getUBYTE(),i.i[Ee]=t.getUBYTE(),i.i[ve]=0,i.i[he]=32,t.getUBYTE(),i.i[le]=t.getUBYTE(),i.i[ue]=t.getUBYTE(),i.i[fe]=t.getUBYTE(),i.i[de]=t.getUBYTE(),i.p=[],a=0;48>a;a++)i.p[a]=t.getUBYTE();for(a=48;u>a;a++)i.p[a]=0;for(i.c=[],a=0;10>a;a++){for(s={},s.n=[],o=0;32>o;o++)s.n[o]=t.getUBYTE(),s.n[o+32]=0,s.n[o+64]=0,s.n[o+96]=0;for(s.f=[],o=0;64>o;o++)s.f[o]=0;i.c[a]=s}for(a=10;l>a;a++){for(s={},s.n=[],o=0;128>o;o++)s.n[o]=0;for(s.f=[],o=0;64>o;o++)s.f[o]=0;i.c[a]=s}t.getUBYTE(),t.getUBYTE(),(i.i[pe]<1||i.i[pe]>3)&&(i.i[pe]=2,i.i[me]=255),i.i[Q]*=c/255,i.i[te]*=c/255,i.i[oe]*=c/255,2==i.i[V]&&(i.i[Q]/=2),2==i.i[ee]&&(i.i[te]/=2),2==i.i[de]&&(i.i[fe]/=2),i.i[Q]=Math.round(i.i[Q]),i.i[te]=Math.round(i.i[te]),i.i[oe]=Math.round(i.i[oe]),i.i[fe]=Math.round(i.i[fe]),n.songData[r]=i}return n.endPattern=t.getUBYTE()+2,n},Le=function(e){var t=be(e);return t||(t=Te(e)),t?t:void alert("Song format not recognized.")},De=function(e){var t,n,r,a,o="";for(o+="    // This music has been exported by SoundBox. You can use it with\n",o+="    // http://sb.bitsnbites.eu/player-small.js in your own product.\n\n",o+="    // See http://sb.bitsnbites.eu/demo.html for an example of how to\n",o+="    // use it in a demo.\n\n",o+="    // Song data\n",o+="    var song = {\n",o+="      songData: [\n",t=0;8>t;t++){var i=e.songData[t];o+="        { // Instrument "+t+"\n",o+="          i: [\n",o+="          "+i.i[V]+", // OSC1_WAVEFORM\n",o+="          "+i.i[Q]+", // OSC1_VOL\n",o+="          "+i.i[Z]+", // OSC1_SEMI\n",o+="          "+i.i[K]+", // OSC1_XENV\n",o+="          "+i.i[ee]+", // OSC2_WAVEFORM\n",o+="          "+i.i[te]+", // OSC2_VOL\n",o+="          "+i.i[ne]+", // OSC2_SEMI\n",o+="          "+i.i[re]+", // OSC2_DETUNE\n",o+="          "+i.i[ae]+", // OSC2_XENV\n",o+="          "+i.i[oe]+", // NOISE_VOL\n",o+="          "+i.i[ie]+", // ENV_ATTACK\n",o+="          "+i.i[se]+", // ENV_SUSTAIN\n",o+="          "+i.i[ce]+", // ENV_RELEASE\n",o+="          "+i.i[de]+", // LFO_WAVEFORM\n",o+="          "+i.i[fe]+", // LFO_AMT\n",o+="          "+i.i[ue]+", // LFO_FREQ\n",o+="          "+i.i[le]+", // LFO_FX_FREQ\n",o+="          "+i.i[pe]+", // FX_FILTER\n",o+="          "+i.i[me]+", // FX_FREQ\n",o+="          "+i.i[ge]+", // FX_RESONANCE\n",o+="          "+i.i[ve]+", // FX_DIST\n",o+="          "+i.i[he]+", // FX_DRIVE\n",o+="          "+i.i[Ee]+", // FX_PAN_AMT\n",o+="          "+i.i[we]+", // FX_PAN_FREQ\n",o+="          "+i.i[ye]+", // FX_DELAY_AMT\n",o+="          "+i.i[Be]+" // FX_DELAY_TIME\n",o+="          ],\n",o+="          // Patterns\n",o+="          p: [";var s=e.endPattern-2,c=0,d=0;for(n=0;s>=n;n++)a=i.p[n],a>c&&(c=a),a&&(d=n);for(n=0;d>=n;n++)a=i.p[n],a&&(o+=a),d>n&&(o+=",");for(o+="],\n",o+="          // Columns\n",o+="          c: [\n",n=0;c>n;n++){for(o+="            {n: [",d=0,r=0;r<4*e.patternLen;r++)i.c[n].n[r]&&(d=r);for(r=0;d>=r;r++){var f=i.c[n].n[r];f&&(o+=f),d>r&&(o+=",")}for(o+="],\n",o+="             f: [",d=0,r=0;r<2*e.patternLen;r++)i.c[n].f[r]&&(d=r);for(r=0;d>=r;r++){var u=i.c[n].f[r];u&&(o+=u),d>r&&(o+=",")}o+="]}",c-1>n&&(o+=","),o+="\n"}o+="          ]\n",o+="        }",7>t&&(o+=","),o+="\n"}return o+="      ],\n",o+="      rowLen: "+e.rowLen+",   // In sample lengths\n",o+="      patternLen: "+e.patternLen+",  // Rows per pattern\n",o+="      endPattern: "+e.endPattern+"  // End pattern\n",o+="    };\n"},Ce=function(e){var t=e.data[0]>>4,n=15&e.data[0],r=e.data[1],a=e.data[2];9!=n&&9==t&&a>0&&Qe(r-12)},xe=function(e){o=a.inputs()[r.selectedIndex],o.onmidimessage=Ce},Ue=function(e){a=e;var t,n="function"==typeof a.inputs?a.inputs():[],i=0;for(t=0;t<n.length;t++){var s=n[t].name.toString().toLowerCase();if(-1!=s.indexOf("keyboard")){i=t;break}}if(r.options.length=0,n.length){for(t=0;t<n.length;t++)r.options[t]=new Option(n[t].name,n[t].fingerprint,t==i,t==i);o=n[i],o.onmidimessage=Ce,r.onchange=xe,r.style.display="inline"}},Se=function(e){},ke=function(){navigator.requestMIDIAccess&&(r=document.getElementById("midiInput"),navigator.requestMIDIAccess().then(Ue,Se))},Ye=function(e){var t=new Image;t.src=e,q.push(t)},Me=function(){for(var e,t,n=document.getElementById("instrPreset"),r=0;r<gInstrumentPresets.length;++r)t=gInstrumentPresets[r],e=document.createElement("option"),e.value=t.i?""+r:"",e.appendChild(document.createTextNode(t.name)),n.appendChild(e)},ze=function(e){var t=0,n=0;if(e.offsetParent)do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return[t,n]},Pe=function(e){var t=null;return e||(e=window.event),e.target?t=e.target:e.srcElement&&(t=e.srcElement),3==t.nodeType&&(t=t.parentNode),t},Ae=function(e,t){var n=[0,0];if(e.pageX&&e.pageY?n=[e.pageX,e.pageY]:e.clientX&&e.clientY?n=[e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.clientY+document.body.scrollTop+document.documentElement.scrollTop]:e.touches&&e.touches.length>0&&(n=[e.touches[0].clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.touches[0].clientY+document.body.scrollTop+document.documentElement.scrollTop]),!t)return n;var r=ze(Pe(e));return[n[0]-r[0],n[1]-r[1]]},Ne=function(){document.getElementById("bpm").blur(),document.getElementById("rpp").blur(),document.getElementById("instrPreset").blur()},Oe=function(e){e!==p&&(p=e,document.getElementById("sequencer").className=p==c?"edit":"",document.getElementById("pattern").className=p==d?"edit":"",document.getElementById("fxtrack").className=p==f?"edit":"",p!=s&&(Ne(),rt(),ot()))},Re=function(){document.getElementById("bpm").value=W(),document.getElementById("rpp").value=k.patternLen},je=function(e,t){for(var n,r=0;u>r;++r)for(var a=0;8>a;++a){if(n=document.getElementById("sc"+a+"r"+r),!t){var o=k.songData[a].p[r];n.innerHTML=o>0?""+(10>=o?o-1:String.fromCharCode(64+o-10)):""}n.className=r>=y&&_>=r&&a>=w&&B>=a?"selected":""}if(e&&(n=document.getElementById("spr"+y),n.scrollIntoView)){var i=document.getElementById("sequencer"),s=n.offsetTop-i.scrollTop;(0>s||s+10>i.offsetHeight)&&n.scrollIntoView(0>s)}},qe=function(e,t){kn();for(var n,r=w==B&&y==_,a=r?k.songData[w].p[y]-1:-1,o=0;o<k.patternLen;++o)for(var i=0;4>i;++i){if(n=document.getElementById("pc"+i+"r"+o),!t){var s="";if(a>=0){var c=k.songData[w].c[a].n[o+i*k.patternLen]-87;c>0&&(s=R[c%12]+Math.floor(c/12))}n.innerHTML!=s&&(n.innerHTML=s)}n.className=o>=v&&E>=o&&i>=g&&h>=i?"selected":""}if(e&r&&(n=document.getElementById("pc0r"+v),n.scrollIntoView)){var d=document.getElementById("pattern"),f=n.offsetTop-d.scrollTop;(0>f||f+10>d.offsetHeight)&&n.scrollIntoView(0>f)}},Fe=function(e,t){for(var n=e.toString(16).toUpperCase(),r=t-n.length,a=0;r>a;++a)n="0"+n;return n},Xe=function(e,t){Yn();for(var n,r=w==B&&y==_,a=r?k.songData[w].p[y]-1:-1,o=0;o<k.patternLen;++o){if(n=document.getElementById("fxr"+o),!t){var i=":";if(a>=0){var s=k.songData[w].c[a].f[o];if(s){var c=k.songData[w].c[a].f[o+k.patternLen];i=Fe(s,2)+":"+Fe(c,2)}}n.innerHTML!=i&&(n.innerHTML=i)}n.className=o>=I&&b>=o?"selected":""}if(e&r&&(n=document.getElementById("fxr"+I),n.scrollIntoView)){var d=document.getElementById("fxtrack"),f=n.offsetTop-d.scrollTop;(0>f||f+10>d.offsetHeight)&&n.scrollIntoView(0>f)}},He=function(e,t){g=e,v=t,h=e,E=t;for(var n=0;n<k.patternLen;++n)for(var r=0;4>r;++r){var a=document.getElementById("pc"+r+"r"+n);a.className=n==t&&r==e?"selected":""}qe(!0,!0)},$e=function(e,t){h=e>=g?e:g,E=t>=v?t:v;for(var n=0;n<k.patternLen;++n)for(var r=0;4>r;++r){var a=document.getElementById("pc"+r+"r"+n);a.className=n>=v&&E>=n&&r>=g&&h>=r?"selected":""}qe(!1,!0)},Je=function(e,t){w=e,y=t,B=e,_=t,je(!0,!0)},Ge=function(e,t){B=e>=w?e:w,_=t>=y?t:y,je(!1,!0)},We=function(e){I=e,b=e;for(var t=0;t<k.patternLen;++t){var n=document.getElementById("fxr"+t);n.className=t>=I&&b>=t?"selected":""}Xe(!0,!0)},Ve=function(e){b=e>=I?e:I;for(var t=0;t<k.patternLen;++t){var n=document.getElementById("fxr"+t);n.className=t>=I&&b>=t?"selected":""}Xe(!1,!0)},Qe=function(e){var t=e+87;if(O.addNote(t),p==d&&w==B&&y==_&&g==h&&v==E){var n=k.songData[w].p[y]-1;if(n>=0)return k.songData[w].c[n].n[v+g*k.patternLen]=t,He(g,(v+1)%k.patternLen),qe(),!0}return!1},Ze=function(e,t,n){n||(e.value=t)},Ke=function(e,t){$(e).prop("checked",!!t)},et=function(){var e=document.getElementById("instrPreset");e.selectedIndex=0},tt=function(e,t){$("[name='"+e+"'][value='"+t+"']").attr("checked","checked").parent().addClass("active").siblings().removeClass("active")},nt=function(e){var t=k.songData[w];tt("osc1_wave",t.i[V]),Ze(document.getElementById("osc1_vol"),t.i[Q]),Ze(document.getElementById("osc1_semi"),t.i[Z]),Ke(document.getElementById("osc1_xenv"),t.i[K]),tt("osc2_wave",t.i[ee]),Ze(document.getElementById("osc2_vol"),t.i[te]),Ze(document.getElementById("osc2_semi"),t.i[ne]),Ze(document.getElementById("osc2_det"),t.i[re]),Ke(document.getElementById("osc2_xenv"),t.i[ae]),Ze(document.getElementById("noise_vol"),t.i[oe]),Ze(document.getElementById("env_att"),t.i[ie]),Ze(document.getElementById("env_sust"),t.i[se]),Ze(document.getElementById("env_rel"),t.i[ce]),tt("lfo_wave",t.i[de]),Ze(document.getElementById("lfo_amt"),t.i[fe]),Ze(document.getElementById("lfo_freq"),t.i[ue]),Ke(document.getElementById("lfo_fxfreq"),t.i[le]),tt("fx_filt",t.i[pe]),Ze(document.getElementById("fx_freq"),t.i[me]),Ze(document.getElementById("fx_res"),t.i[ge]),Ze(document.getElementById("fx_dly_amt"),t.i[ye]),Ze(document.getElementById("fx_dly_time"),t.i[Be]),Ze(document.getElementById("fx_pan_amt"),t.i[Ee]),Ze(document.getElementById("fx_pan_freq"),t.i[we]),Ze(document.getElementById("fx_dist"),t.i[ve]),Ze(document.getElementById("fx_drive"),t.i[he]),e&&et(),O.updateInstr(t.i)},rt=function(){var e=parseInt(document.getElementById("bpm").value);e&&e>=10&&1e3>=e&&(k.rowLen=G(e),O.updateRowLen(k.rowLen))},at=function(e){if(k.patternLen!==e){_t();var t,n,r,a,o,i;for(t=0;8>t;t++)for(n=0;l>n;n++){for(a=k.songData[t].c[n],o=[],i=[],r=0;4*e>r;r++)o[r]=0;for(r=0;2*e>r;r++)i[r]=0;for(r=0;r<Math.min(k.patternLen,e);r++)o[r]=a.n[r],o[r+e]=a.n[r+k.patternLen],o[r+2*e]=a.n[r+2*k.patternLen],o[r+3*e]=a.n[r+3*k.patternLen],i[r]=a.f[r],i[r+e]=a.f[r+k.patternLen];a.n=o,a.f=i}k.patternLen=e}},ot=function(){var e=parseInt(document.getElementById("rpp").value);e&&e>=1&&256>=e&&(at(e),kn(),Yn(),qe(),Xe())},it=function(){var e,t,n;for(k.endPattern=u+1,e=u-1;e>=0;--e){for(n=!0,t=0;8>t;++t)if(k.songData[t].p[e]>0){n=!1;break}if(!n)break;k.endPattern--}rt()},st=function(){var e=document.getElementById("cover");e.style.visibility="visible",e=document.getElementById("dialog"),e.style.visibility="visible",Cn()},ct=function(){var e=document.getElementById("cover");e.style.visibility="hidden",e=document.getElementById("dialog"),e.style.visibility="hidden",Dn()},dt=function(e){var t=document.getElementById("dialog");t.innerHTML="";var n,r;n=document.createElement("img"),n.src=i+"progress.gif",t.appendChild(n),n=document.createTextNode(e),t.appendChild(n),n=document.createElement("div"),n.id="progressBarParent",t.appendChild(n),r=document.createElement("div"),r.id="progressBar",n.appendChild(r),st()},ft=function(e){var t=Le(e);t&&(_t(),k=t,Re(),je(),qe(),Xe(),nt(!0))},ut=function(){var e=document.getElementById("dialog");e.innerHTML="";var t;t=document.createElement("h3"),t.appendChild(document.createTextNode("Open song")),e.appendChild(t),e.appendChild(document.createElement("br"));var n=document.createElement("form"),r=document.createElement("div");r.style.textAlign="left",r.style.marginLeft="30px",r.style.lineHeight="1.8em";for(var a=[],o=0;o<gDemoSongs.length;o++)t=document.createElement("input"),t.type="radio",t.name="radiogroup1",t.value=gDemoSongs[o].name,0===o&&(t.checked=!0),a.push(t),r.appendChild(t),t=document.createElement("span"),t.innerHTML=gDemoSongs[o].description,r.appendChild(t),r.appendChild(document.createElement("br"));var i=document.createElement("input");i.type="radio",i.name="radiogroup1",i.value="custom",r.appendChild(i),r.appendChild(document.createTextNode(" Data URL: "));var s=document.createElement("input");s.type="text",s.size="45",s.title="Paste a saved song data URL here",s.onchange=function(){i.checked=!0},s.onkeydown=s.onchange,s.onclick=s.onchange,r.appendChild(s),n.appendChild(r),t=document.createElement("p"),t.appendChild(document.createTextNode("Hint: You can also drag'n'drop binary files into the editor.")),n.appendChild(t),n.appendChild(document.createElement("br")),t=document.createElement("input"),t.type="submit",t.value="Open",t.title="Open song",t.onclick=function(e){e.preventDefault();var t=null;if(i.checked){var n=X(s.value);t=H(n&&n.data&&n.data[0])}else for(var r=0;r<a.length;r++)if(e=a[r],e.checked){for(var o=0;o<gDemoSongs.length;o++)if(gDemoSongs[o].name===e.value){t=gDemoSongs[o].data?gDemoSongs[o].data:H(gDemoSongs[o].base64);break}break}t&&ft(t),ct()},n.appendChild(t),n.appendChild(document.createTextNode(" ")),t=document.createElement("input"),t.type="submit",t.value="Cancel",t.onclick=function(){return ct(),!1},n.appendChild(t),e.appendChild(n),st()},lt=function(){var e=document.getElementById("dialog");e.innerHTML="";var t,n;t=document.createElement("h3"),t.appendChild(document.createTextNode("Save song")),e.appendChild(t),t=document.createElement("p"),t.appendChild(document.createTextNode("Data URL (copy/paste, bookmark, mail etc):")),e.appendChild(t),t=document.createElement("p"),n=document.createElement("a");var r=J(Ie(k)),a=r.length<70?r:r.slice(0,67)+"...";n.href=r,n.title=r,n.appendChild(document.createTextNode(a)),t.appendChild(n),e.appendChild(t);var o=document.createElement("form");t=document.createElement("input"),t.type="submit",t.value="Save binary",t.title="Save the song as a binary file.",t.onclick=function(){var e="data:application/octet-stream;base64,"+btoa(Ie(k));return window.open(e),ct(),!1},o.appendChild(t),t=document.createElement("input"),t.type="submit",t.value="Close",t.onclick=function(){return ct(),!1},o.appendChild(t),e.appendChild(o),st()},pt=function(){var e=document.getElementById("dialog");e.innerHTML="";var t;t=document.createElement("img"),t.src=i+"logo-big.png",e.appendChild(t),t=document.createElement("p"),t.appendChild(document.createTextNode("an HTML5 synth music tracker")),e.appendChild(t),t=document.createElement("p"),t.innerHTML='Licensed under the <a href="LICENSE">GPL v3</a> license (get the <a href="http://gitorious.org/soundbox/soundbox">source</a>).',t.style.fontStyle="italic",e.appendChild(t),t=document.createElement("p"),t.appendChild(document.createTextNode("To get started, open a demo song.")),e.appendChild(t),t=document.createElement("a"),t.href="help.html",t.appendChild(document.createTextNode("Help")),e.appendChild(t),e.appendChild(document.createElement("br")),e.appendChild(document.createElement("br"));var n=document.createElement("form");t=document.createElement("input"),t.type="submit",t.value="Close",t.onclick=function(){return ct(),!1},n.appendChild(t),e.appendChild(n),st()},mt=function(e){e.preventDefault(),pt()},gt=function(e){return k=_e(),Re(),je(),qe(),Xe(),nt(),Oe(d),He(0,0),Je(0,0),We(0),!1},vt=function(e){e.preventDefault(),ut()},ht=function(e){it(),lt(),e.preventDefault()},Et=function(e){e.preventDefault(),it();var t=function(e){var t=new Blob([e],{type:"application/octet-stream"});saveAs(t,"SoundBox-music.wav")};Bt(t)},wt=function(e){it();var t="data:text/javascript;base64,"+btoa(De(k));return window.open(t),!1},yt=function(e){document.getElementById("statusText").innerHTML=e},Bt=function(e,t){dt("Generating sound...");var n=new Date;z=new CPlayer,z.generate(k,t,function(t){var r=document.getElementById("progressBar");if(r.style.width=Math.floor(200*t)+"px",t>=1){var a=z.createWave(),o=new Date;yt("Generation time: "+(o.getTime()-n.getTime())/1e3+"s"),ct(),e(a)}})},_t=function(){zt(),Y&&(Y.pause(),M.reset())},It=-1,bt=0,Tt=0,Lt=0,Dt=0,Ct=!1,xt=0,Ut=0,St=function(e,t){for(var n=44100*e/k.rowLen,r=Math.floor(n),a=Math.floor(r/k.patternLen)+bt,o=r%k.patternLen,i=0;i<k.patternLen;++i){for(var s=a,c=o-i;0>c;){if(--s,bt>s)return-1;c+=k.patternLen}for(var d=k.songData[t].p[s]-1,f=0;4>f;f++)if(d>=0&&k.songData[t].c[d].n[c+f*k.patternLen]>0)return(i+(n-r))*k.rowLen}return-1},kt=function(e){var t=document.getElementById("playGfxCanvas"),n=P.width>0?P.width:t.width,r=P.height>0?P.height:51,a=t.getContext("2d");if(a){a.drawImage(P,0,0);var o=0,i=0;if(Ct&&e>=0){var s,c,d,f=z.getData(e,1e3),u=0,l=0,p=0,m=0;for(s=1;s<f.length;s+=2)c=f[s-1],d=f[s],u=.8*c+.1*u-.3*p,l=.8*d+.1*l-.3*m,p=c,m=d,o+=u*u,i+=l*l;o=.2*Math.sqrt(o/f.length)+.8*xt,i=.2*Math.sqrt(i/f.length)+.8*Ut,xt=o,Ut=i}var g=o>0?1.3+.5*Math.log(o):-1e3;g=-1>g?-1:g>1?1:g,g*=.57;var v=i>0?1.3+.5*Math.log(i):-1e3;for(v=-1>v?-1:v>1?1:v,v*=.57,a.strokeStyle="rgb(0,0,0)",a.beginPath(),a.moveTo(.25*n,2.1*r),a.lineTo(.25*n+1.8*r*Math.sin(g),2.1*r-1.8*r*Math.cos(g)),a.stroke(),a.beginPath(),a.moveTo(.75*n,2.1*r),a.lineTo(.75*n+1.8*r*Math.sin(v),2.1*r-1.8*r*Math.cos(v)),a.stroke(),a.fillStyle="rgb(0,0,0)",a.fillRect(0,r,n,20),
s=0;8>s;++s){var h=Math.round(26+23*s);if(a.drawImage(A,h,r),s>=Lt&&Dt>=s){var E=k.songData[s].i[ie],w=k.songData[s].i[se],y=k.songData[s].i[ce];E=E*E*4,y=w*w*4+y*y*4;var B=E+y;1e4>B&&(B=1e4,y=B-E);var _=St(e,s);if(_>=0&&B>_){var I;I=E>_?_/E:1-(_-E)/y,a.globalAlpha=I*I,a.drawImage(N,h,r),a.globalAlpha=1}}}}},Yt=function(){if(null!=Y){var e,t,n=M.currentTime();if(Y.ended||Y.duration&&Y.duration-n<.1)return zt(),v=0,E=0,qe(),I=0,b=0,void Xe();var r=Math.floor(44100*n/k.rowLen),a=Math.floor(r/k.patternLen)+bt,o=r%k.patternLen,i=a!=y,s=i||o!=v;if(i)for(a>=0&&(y=a,_=a,je(!0,!0)),e=0;u>e;++e)t=document.getElementById("spr"+e),t.className=e==a?"playpos":"";if(s)for(o>=0&&(v=o,E=o,qe(!0,!i),I=o,b=o,Xe(!0,!i)),e=0;e<k.patternLen;++e)t=document.getElementById("ppr"+e),t.className=e==o?"playpos":"";kt(n)}},Mt=function(){y=bt,_=bt,B=w,je(!0,!0),qe(),Xe(),Ct=!0,It=setInterval(Yt,16)},zt=function(){if(Ct){-1!==It&&(clearInterval(It),It=-1);var e;for(e=0;u>e;++e)document.getElementById("spr"+e).className="";for(e=0;e<k.patternLen;++e)document.getElementById("ppr"+e).className="";kt(-1),Ct=!1}},Pt=function(e){e||(e=window.event),e.preventDefault(),_t(),it(),bt=0,Tt=k.endPattern-2,Lt=0,Dt=7;var t=function(e){if(null==Y)return void alert("Audio element unavailable.");try{Mt(),Y.src=URL.createObjectURL(new Blob([e],{type:"audio/wav"})),M.reset(),Y.play()}catch(t){alert("Error playing: "+t.message)}};Bt(t)},At=function(e){e||(e=window.event),e.preventDefault(),_t(),it();var t={firstRow:y,lastRow:_,firstCol:w,lastCol:B};bt=y,Tt=_,Lt=w,Dt=B;var n=function(e){if(null==Y)return void alert("Audio element unavailable.");try{Mt(),Y.src=URL.createObjectURL(new Blob([e],{type:"audio/wav"})),Y.play(),M.reset()}catch(t){alert("Error playing: "+t.message)}};Bt(n,t)},Nt=function(e){return e||(e=window.event),e.preventDefault(),null==Y?void alert("Audio element unavailable."):void _t()},Ot=function(e){return Oe(s),!0},Rt=function(e){return Oe(s),!0},jt=function(e){return Oe(s),!0},qt=function(e){if(e=e||window.event,e.preventDefault(),w==B){S=[];for(var t=k.songData[w],n=0;n<=t.i.length;++n)S[n]=t.i[n]}},Ft=function(e){if(e=e||window.event,e.preventDefault(),w==B&&S.length>0){var t=k.songData[w];t.i=[];for(var n=0;n<=S.length;++n)t.i[n]=S[n]}nt(!0)},Xt=function(e){if(e=e||window.event,e.preventDefault(),y==_&&w==B){var t=k.songData[w].p[y]-1;if(t>=0){x=[];for(var n=v;E>=n;++n){for(var r=[],a=g;h>=a;++a)r.push(k.songData[w].c[t].n[n+a*k.patternLen]);x.push(r)}}}},Ht=function(e){if(e=e||window.event,e.preventDefault(),y==_&&w==B){var t=k.songData[w].p[y]-1;if(t>=0){for(var n=v,r=0;n<k.patternLen&&r<x.length;++n,++r)for(var a=g,o=0;4>a&&o<x[r].length;++a,++o)k.songData[w].c[t].n[n+a*k.patternLen]=x[r][o];qe()}}},$t=function(e){if(e=e||window.event,e.preventDefault(),y==_&&w==B){var t=k.songData[w].p[y]-1;if(t>=0){for(var n=v;E>=n;++n)for(var r=g;h>=r;++r){var a=k.songData[w].c[t].n[n+r*k.patternLen];a>0&&(k.songData[w].c[t].n[n+r*k.patternLen]=a+1)}qe()}}},Jt=function(e){if(e=e||window.event,e.preventDefault(),y==_&&w==B){var t=k.songData[w].p[y]-1;if(t>=0){for(var n=v;E>=n;++n)for(var r=g;h>=r;++r){var a=k.songData[w].c[t].n[n+r*k.patternLen];a>1&&(k.songData[w].c[t].n[n+r*k.patternLen]=a-1)}qe()}}},Gt=function(e){if(e=e||window.event,e.preventDefault(),y==_&&w==B){var t=k.songData[w].p[y]-1;if(t>=0){for(var n=v;E>=n;++n)for(var r=g;h>=r;++r){var a=k.songData[w].c[t].n[n+r*k.patternLen];a>0&&(k.songData[w].c[t].n[n+r*k.patternLen]=a+12)}qe()}}},Wt=function(e){if(e=e||window.event,e.preventDefault(),y==_&&w==B){var t=k.songData[w].p[y]-1;if(t>=0){for(var n=v;E>=n;++n)for(var r=g;h>=r;++r){var a=k.songData[w].c[t].n[n+r*k.patternLen];a>12&&(k.songData[w].c[t].n[n+r*k.patternLen]=a-12)}qe()}}},Vt=function(e){e=e||window.event,e.preventDefault(),C=[];for(var t=y;_>=t;++t){for(var n=[],r=w;B>=r;++r)n.push(k.songData[r].p[t]);C.push(n)}},Qt=function(e){e=e||window.event,e.preventDefault();for(var t=y,n=0;u>t&&n<C.length;++t,++n)for(var r=w,a=0;8>r&&a<C[n].length;++r,++a)k.songData[r].p[t]=C[n][a];je()},Zt=function(e){e=e||window.event,e.preventDefault();for(var t=y;_>=t;++t)for(var n=w;B>=n;++n){var r=k.songData[n].p[t];l>r&&(k.songData[n].p[t]=r+1)}je(),qe(),Xe()},Kt=function(e){e=e||window.event,e.preventDefault();for(var t=y;_>=t;++t)for(var n=w;B>=n;++n){var r=k.songData[n].p[t];r>0&&(k.songData[n].p[t]=r-1)}je(),qe(),Xe()},en=function(e){if(e=e||window.event,e.preventDefault(),y==_&&w==B){var t=k.songData[w].p[y]-1;if(t>=0){U=[];for(var n=I;b>=n;++n){var r=[];r.push(k.songData[w].c[t].f[n]),r.push(k.songData[w].c[t].f[n+k.patternLen]),U.push(r)}}}},tn=function(e){if(e=e||window.event,e.preventDefault(),y==_&&w==B){var t=k.songData[w].p[y]-1;if(t>=0){for(var n=I,r=0;n<k.patternLen&&r<U.length;++n,++r){var a=U[r];k.songData[w].c[t].f[n]=a[0],k.songData[w].c[t].f[n+k.patternLen]=a[1]}Xe()}}},nn=function(e){if(e=e||window.event,e.preventDefault(),w==B){var t=Pe(e),n=-1;"osc1_xenv"===t.id?n=K:"osc2_xenv"===t.id?n=ae:"lfo_fxfreq"===t.id&&(n=le);var r;if(n>=0&&(r=+$(t).is(":checked"),k.songData[w].i[n]=r),p==f&&y==_&&I==b&&n){var a=k.songData[w].p[y]-1;a>=0&&(k.songData[w].c[a].f[I]=n+1,k.songData[w].c[a].f[I+k.patternLen]=r,Xe())}nt(!0),Ne()}},rn=function(e){if(e=e||window.event,e.preventDefault(),w==B){var t=e.currentTarget.value;if(p==f&&y==_&&I==b){var n=k.songData[w].p[y]-1;n>=0&&(k.songData[w].c[n].f[I]=V+1,k.songData[w].c[n].f[I+k.patternLen]=t,Xe())}k.songData[w].i[V]=t,nt(),Ne()}},an=function(e){if(e=e||window.event,e.preventDefault(),w==B){var t=e.currentTarget.value;if(p==f&&y==_&&I==b){var n=k.songData[w].p[y]-1;n>=0&&(k.songData[w].c[n].f[I]=ee+1,k.songData[w].c[n].f[I+k.patternLen]=t,Xe())}k.songData[w].i[ee]=t,nt(!0),Ne()}},on=function(e){if(e=e||window.event,e.preventDefault(),w==B){var t=e.currentTarget.value;if(p==f&&y==_&&I==b){var n=k.songData[w].p[y]-1;n>=0&&(k.songData[w].c[n].f[I]=de+1,k.songData[w].c[n].f[I+k.patternLen]=t,Xe())}k.songData[w].i[de]=t,nt(!0),Ne()}},sn=function(e){if(e=e||window.event,e.preventDefault(),w==B){var t=e.currentTarget.value;if(p==f&&y==_&&I==b){var n=k.songData[w].p[y]-1;n>=0&&(k.songData[w].c[n].f[I]=pe+1,k.songData[w].c[n].f[I+k.patternLen]=t,Xe())}k.songData[w].i[pe]=t,nt(!0),Ne()}},cn=function(e){e=e||window.event,e.preventDefault(),8>m&&(m++,document.getElementById("keyboardOctave").innerHTML=""+m)},dn=function(e){e=e||window.event,e.preventDefault(),m>1&&(m--,document.getElementById("keyboardOctave").innerHTML=""+m)},fn=function(e){if(e=e||window.event,e.preventDefault(),w==B){var t=Pe(e),n=t.options[t.selectedIndex].value;if(""!==n&&(n=parseInt(n))){for(var r=gInstrumentPresets[n],a=0;a<r.i.length;++a)k.songData[w].i[a]=r.i[a];nt(!1)}}},un=function(e){e=e||window.event;var t=Ae(e,!0),n=0;if(t[1]<68)for(var r=0;r<j.length;r+=2)if(t[0]>=j[r]-10&&t[0]<=j[r]+10){n=j[r+1];break}if(!n){n=2*Math.floor(14*t[0]/420);var a=0;n>=20&&a++,n>=14&&a++,n>=6&&a++,n-=a}Qe(n+12*m)&&e.preventDefault()},ln=function(e){if(e||(e=window.event),e.preventDefault(),!Ct){var t=Pe(e),n=parseInt(t.id.slice(3));We(n),D=!0}Oe(f)},pn=function(e){if(D){e=e||window.event,e.preventDefault();var t=Pe(e),n=parseInt(t.id.slice(3));Ve(n)}},mn=function(e){if(D){e=e||window.event,e.preventDefault();var t=Pe(e),n=parseInt(t.id.slice(3));Ve(n),D=!1}},gn=function(e){if(e=e||window.event,e.preventDefault(),!Ct){var t=Pe(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4));He(n,r),L=!0}Oe(d)},vn=function(e){if(L){e=e||window.event,e.preventDefault();var t=Pe(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4));$e(n,r)}},hn=function(e){if(L){e=e||window.event,e.preventDefault();var t=Pe(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4));$e(n,r),L=!1}},En=function(e){e=e||window.event,e.preventDefault();var t,n=Pe(e),r=parseInt(n.id.slice(2,3));t=Ct?y:parseInt(n.id.slice(4));var a=r!=w||w!=B;Je(r,t),Ct||(T=!0),Oe(c),qe(),Xe(),nt(a)},wn=function(e){if(T){e=e||window.event,e.preventDefault();var t=Pe(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4));Ge(n,r),qe(),Xe(),nt(!0)}},yn=function(e){if(T){e=e||window.event,e.preventDefault();var t=Pe(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4)),a=n!=B||w!=B;Ge(n,r),T=!1,qe(),Xe(),nt(a)}},Bn=null,_n=function(e){w==B&&(e=e||window.event,Bn=Pe(e),Ne())},In=function(e){if(e=e||window.event,e.preventDefault(),Bn){var t=Ae(e,!1),n=ze(Bn.parentNode),r=t[0]-6-n[0];r=0>r?0:r>191?1:r/191,Bn.sliderProps.nonLinear&&(r*=r);var a=Bn.sliderProps.min,o=Bn.sliderProps.max;r=Math.round(a+(o-a)*r),"INPUT"==Bn.tagName&&(r=Bn.value);var i=-1;"osc1_vol"==Bn.id?i=Q:"osc1_semi"==Bn.id?i=Z:"osc2_vol"==Bn.id?i=te:"osc2_semi"==Bn.id?i=ne:"osc2_det"==Bn.id?i=re:"noise_vol"==Bn.id?i=oe:"env_att"==Bn.id?i=ie:"env_sust"==Bn.id?i=se:"env_rel"==Bn.id?i=ce:"lfo_amt"==Bn.id?i=fe:"lfo_freq"==Bn.id?i=ue:"fx_freq"==Bn.id?i=me:"fx_res"==Bn.id?i=ge:"fx_dist"==Bn.id?i=ve:"fx_drive"==Bn.id?i=he:"fx_pan_amt"==Bn.id?i=Ee:"fx_pan_freq"==Bn.id?i=we:"fx_dly_amt"==Bn.id?i=ye:"fx_dly_time"==Bn.id&&(i=Be);var s=k.songData[w];if(p==f&&I==b&&y==_&&w==B){var c=k.songData[w].p[y]-1;c>=0&&(k.songData[w].c[c].f[I]=i+1,k.songData[w].c[c].f[I+k.patternLen]=r,Xe())}i>=0&&(s.i[i]=r),O.updateInstr(s.i),et()}},bn=function(e){},Tn=function(e){e=e||window.event;var t,n,r,a=document.activeElement===document.getElementById("bpm")||document.activeElement===document.getElementById("rpp");if(p==c&&w==B&&y==_){if(e.keyCode>=48&&e.keyCode<=57)return k.songData[w].p[y]=e.keyCode-47,je(),qe(),Xe(),!1;if(e.keyCode>=64&&e.keyCode<=90)return k.songData[w].p[y]=e.keyCode-54,je(),qe(),Xe(),!1}if(p!=c&&!a){switch(r=-1,e.keyCode){case 90:r=0;break;case 83:r=1;break;case 88:r=2;break;case 68:r=3;break;case 67:r=4;break;case 86:r=5;break;case 71:r=6;break;case 66:r=7;break;case 72:r=8;break;case 78:r=9;break;case 74:r=10;break;case 77:r=11;break;case 188:r=12;break;case 76:r=13;break;case 190:r=14;break;case 186:r=15;break;case 191:r=16;break;case 81:r=12;break;case 50:r=13;break;case 87:r=14;break;case 51:r=15;break;case 69:r=16;break;case 82:r=17;break;case 53:r=18;break;case 84:r=19;break;case 54:r=20;break;case 89:r=21;break;case 55:r=22;break;case 85:r=23;break;case 73:r=24;break;case 57:r=25;break;case 79:r=26;break;case 48:r=27;break;case 80:r=28}if(r>=0&&Qe(r+12*m))return!1}var o;switch(e.keyCode){case 39:if(p==c)return Je((w+1)%8,y),qe(),Xe(),nt(!0),!1;if(p==d)return He((g+1)%4,v),!1;break;case 37:if(p==c)return Je((w-1+8)%8,y),qe(),Xe(),nt(!0),!1;if(p==d)return He((g-1+4)%4,v),!1;break;case 40:if(p==c)return Je(w,(y+1)%u),qe(),Xe(),!1;if(p==d)return He(g,(v+1)%k.patternLen),!1;if(p==f)return We((I+1)%k.patternLen),!1;break;case 38:if(p==c)return Je(w,(y-1+u)%u),qe(),Xe(),!1;if(p==d)return He(g,(v-1+k.patternLen)%k.patternLen),!1;if(p==f)return We((I-1+k.patternLen)%k.patternLen),!1;break;case 36:if(p==c)return Je(w,0),qe(),Xe(),!1;if(p==d)return He(g,0),!1;if(p==f)return We(0),!1;break;case 35:if(p==c)return Je(w,u-1),qe(),Xe(),!1;if(p==d)return He(g,k.patternLen-1),!1;if(p==f)return We(k.patternLen-1),!1;break;case 32:if(p!=s)return At(e),!1;break;case 8:case 46:if(p==c){for(t=y;_>=t;++t)for(n=w;B>=n;++n)k.songData[n].p[t]=0;return je(),qe(),Xe(),!1}if(p==d){if(y==_&&w==B){if(o=k.songData[w].p[y]-1,o>=0){for(t=v;E>=t;++t)for(n=g;h>=n;++n)k.songData[w].c[o].n[t+n*k.patternLen]=0;v==E&&He(g,(v+1)%k.patternLen),qe()}return!1}}else if(p==f&&y==_&&w==B){if(o=k.songData[w].p[y]-1,o>=0){for(t=I;b>=t;++t)k.songData[w].c[o].f[t]=0,k.songData[w].c[o].f[t+k.patternLen]=0;I==b&&We((I+1)%k.patternLen),Xe()}return!1}break;case 13:a&&(rt(),ot(),document.getElementById("bpm").blur(),document.getElementById("rpp").blur())}return!0},Ln=function(e){e=e||window.event,e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;if(t.length&&1!=t.length)return void alert("Only open one file at a time.");var n=t[0],r=new FileReader;r.onload=function(e){ft(H(e.target.result))},r.readAsDataURL(n)},Dn=function(){document.onmousedown=null,document.addEventListener("mousemove",In,!1),document.addEventListener("touchmove",In,!1),document.addEventListener("mouseup",bn,!1),document.addEventListener("touchend",bn,!1),document.onkeydown=Tn;var e=document.body.parentNode;e.addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("drop",Ln,!1)},Cn=function(){document.onmousedown=function(){return!0},document.onmousemove=null,document.onmouseup=null,document.onkeydown=null},xn=function(){for(var e,t,n,r=document.getElementById("sequencer-table"),a=0;u>a;a++){e=document.createElement("tr"),a%4===0&&(e.className="beat"),t=document.createElement("th"),t.id="spr"+a,t.textContent=""+a,e.appendChild(t);for(var o=0;8>o;o++)n=document.createElement("td"),n.id="sc"+o+"r"+a,n.textContent=" ",n.addEventListener("mousedown",En,!1),n.addEventListener("mouseover",wn,!1),n.addEventListener("mouseup",yn,!1),e.appendChild(n);r.appendChild(e)}},Un=function(e){for(var t=1;t<e.children.length&&"beat"!==e.children[t].className;)t++;return t},Sn=function(){var e=W(),t=4;return k.patternLen%3===0?t=3:k.patternLen%4===0?t=4:k.patternLen%2===0?t=2:k.patternLen%5===0&&(t=5),e/t>=40&&k.patternLen>24&&k.patternLen%(2*t)===0&&(t*=2),t},kn=function(){var e=Sn(),t=document.getElementById("pattern-table");if(t.children.length!==k.patternLen||Un(t)!==e){for(;t.firstChild;)t.removeChild(t.firstChild);for(var n,r,a,o=0;o<k.patternLen;o++){n=document.createElement("tr"),o%e===0&&(n.className="beat"),r=document.createElement("th"),r.id="ppr"+o,r.textContent=""+o,n.appendChild(r);for(var i=0;4>i;i++)a=document.createElement("td"),a.id="pc"+i+"r"+o,a.textContent=" ",a.addEventListener("mousedown",gn,!1),a.addEventListener("mouseover",vn,!1),a.addEventListener("mouseup",hn,!1),n.appendChild(a);t.appendChild(n)}}},Yn=function(){var e=Sn(),t=document.getElementById("fxtrack-table");if(t.children.length!==k.patternLen||Un(t)!==e){for(;t.firstChild;)t.removeChild(t.firstChild);for(var n,r,a=0;a<k.patternLen;a++)n=document.createElement("tr"),a%e===0&&(n.className="beat"),r=document.createElement("td"),r.id="fxr"+a,r.textContent=String.fromCharCode(160),r.addEventListener("mousedown",ln,!1),r.addEventListener("mouseover",pn,!1),r.addEventListener("mouseup",mn,!1),n.appendChild(r),t.appendChild(n)}};this.init=function(){$(".knob").knob({inline:!1,width:50,height:50,bgColor:"#2b3e50",fgColor:"#df691a",inputColor:"#ebebeb",angleOffset:-125,angleArc:250,cursor:10}),$("input[type=range]").rsSlider({}),t=F(window.location.href),n=X(window.location.href),Ye(i+"progress.gif"),Me(),P.onload=function(){kt(-1)},A.onload=function(){kt(-1)},P.src=i+"playGfxBg.png",A.src=i+"led-off.png",N.src=i+"led-on.png",xn(),document.getElementById("osc1_vol").sliderProps={min:0,max:255},document.getElementById("osc1_semi").sliderProps={min:92,max:164},document.getElementById("osc2_vol").sliderProps={min:0,max:255},document.getElementById("osc2_semi").sliderProps={min:92,max:164},document.getElementById("osc2_det").sliderProps={min:0,max:255,nonLinear:!0},document.getElementById("noise_vol").sliderProps={min:0,max:255},document.getElementById("env_att").sliderProps={min:0,max:255},document.getElementById("env_sust").sliderProps={min:0,max:255},document.getElementById("env_rel").sliderProps={min:0,max:255},document.getElementById("lfo_amt").sliderProps={min:0,max:255},document.getElementById("lfo_freq").sliderProps={min:0,max:16},document.getElementById("fx_freq").sliderProps={min:0,max:255,nonLinear:!0},document.getElementById("fx_res").sliderProps={min:0,max:254},document.getElementById("fx_dist").sliderProps={min:0,max:255,nonLinear:!0},document.getElementById("fx_drive").sliderProps={min:0,max:255},document.getElementById("fx_pan_amt").sliderProps={min:0,max:255},document.getElementById("fx_pan_freq").sliderProps={min:0,max:16},document.getElementById("fx_dly_amt").sliderProps={min:0,max:255},document.getElementById("fx_dly_time").sliderProps={min:0,max:16};try{Y=new Audio,M.setAudioElement(Y),Y.addEventListener("canplay",function(){this.play()},!0)}catch(r){Y=null}var a=H(n&&n.data&&n.data[0]),o=a?Le(a):null;k=o?o:_e(),Re(),je(),qe(),Xe(),nt(!0),Oe(d),Je(0,0),He(0,0),$("#logo").on("click",mt),$("#newSong").on("click",gt),$("#openSong").on("click",vt),$("#openMidi").on("click",e),$("#saveSong").on("click",ht),$("#exportJS").on("click",wt),$("#exportWAV").on("click",Et),$("#playSong").on("click",Pt),$("#playRange").on("click",At),$("#stopPlaying").on("click",Nt),$("#about").on("click",mt),document.getElementById("bpm").onfocus=Ot,document.getElementById("rpp").onfocus=Rt,document.getElementById("sequencerCopy").onmousedown=Vt,document.getElementById("sequencerPaste").onmousedown=Qt,document.getElementById("sequencerPatUp").onmousedown=Zt,document.getElementById("sequencerPatDown").onmousedown=Kt,document.getElementById("patternCopy").onmousedown=Xt,document.getElementById("patternPaste").onmousedown=Ht,document.getElementById("patternNoteUp").onmousedown=$t,document.getElementById("patternNoteDown").onmousedown=Jt,document.getElementById("patternOctaveUp").onmousedown=Gt,document.getElementById("patternOctaveDown").onmousedown=Wt,document.getElementById("fxCopy").onmousedown=en,document.getElementById("fxPaste").onmousedown=tn,document.getElementById("instrPreset").onfocus=jt,document.getElementById("instrPreset").onchange=fn,$("[name=osc1_wave]").on("change",rn),$("#osc1_vol").rsSlider("change",_n),$("#osc1_semi").rsSlider("change",_n),$("#osc1_xenv").on("change",nn),$("[name=osc2_wave]").on("change",an),$("#osc2_vol").rsSlider("change",_n),$("#osc2_semi").rsSlider("change",_n),$("#osc2_det").rsSlider("change",_n),$("#osc2_xenv").on("change",nn),$("#noise_vol").rsSlider("change",_n),$("#env_att").rsSlider("change",_n),$("#env_sust").rsSlider("change",_n),$("#env_rel").rsSlider("change",_n),$("[name=lfo_wave]").on("change",on),$("#lfo_amt").rsSlider("change",_n),$("#lfo_freq").rsSlider("change",_n),$("#lfo_fxfreq").on("change",nn),$("[name=fx_filt]").on("change",sn),$("#fx_freq").rsSlider("change",_n),$("#fx_res").rsSlider("change",_n),$("#fx_dly_amt").rsSlider("change",_n),$("#fx_dly_time").rsSlider("change",_n),$("#fx_pan_amt").rsSlider("change",_n),$("#fx_pan_freq").rsSlider("change",_n),$("#fx_dist").rsSlider("change",_n),$("#fx_drive").rsSlider("change",_n),document.getElementById("octaveDown").addEventListener("mousedown",dn,!1),document.getElementById("octaveDown").addEventListener("touchstart",dn,!1),document.getElementById("octaveUp").addEventListener("mousedown",cn,!1),document.getElementById("octaveUp").addEventListener("touchstart",cn,!1),document.getElementById("keyboard").addEventListener("mousedown",un,!1),document.getElementById("keyboard").addEventListener("touchstart",un,!1),document.getElementById("instrCopy").onmousedown=qt,document.getElementById("instrPaste").onmousedown=Ft,ke(),Dn(),a||pt(),O.start(),O.updateRowLen(k.rowLen)}};