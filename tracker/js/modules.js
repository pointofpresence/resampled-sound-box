/*!
 * This file is part of ReSampled SoundBox.
 *
 * Based on SoundBox by Marcus Geelnard (c) 2011-2013
 * 2015 pointofpresence
 * ReSampled.SoundBox (resampled-sound-box) - Online music tracker
 *
 * @version v0.0.1
 * @build Sun Aug 09 2015 03:32:53
 * @link https://github.com/pointofpresence/resampled-sound-box
 * @license GPL-3.0
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 * 1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 * 2. Altered source versions must be plainly marked as such, and must not be
 *    misrepresented as being the original software.
 *
 * 3. This notice may not be removed or altered from any source
 *    distribution.
 */
function rle_encode(e){var t,n,r,a,o="";for(t=0;t<e.length;){for(r=e.charCodeAt(t),n=1;255>n&&t+n<e.length&&(a=e.charCodeAt(t+n),a==r);n++);n>3?(o+=String.fromCharCode(254),o+=String.fromCharCode(n),o+=String.fromCharCode(r)):(o+=String.fromCharCode(r),254==r&&(o+=String.fromCharCode(0)),n=1),t+=n}return o}function rle_decode(e){var t,n,r,a,o="";for(t=0;t<e.length;){if(r=e.charCodeAt(t++),254===r){if(1>t)break;if(a=e.charCodeAt(t++),0!=a){if(1>t)break;for(r=e.charCodeAt(t++),n=0;a>n;n++)o+=String.fromCharCode(r);continue}}o+=String.fromCharCode(r)}return o}!function(e){var t={change:e.noop},n={change:function(t){e(this).on("change",function(){e(this).next("output").val(e(this).val()),t()})},init:function(n){var r=e.extend(t,n||{});return this.each(function(){{var t=e(this),n=t.data("config")||{};e.extend(r,n)}t.wrap(e("<div/>",{"class":"rs-slider"})),t.after(e("<output/>",{"class":"rangevalue"})),t.next("output").val(parseInt(t.val()))})}};e.fn.rsSlider=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist in jQuery.rsSlider"):n.init.apply(this,arguments)}}(jQuery),gDemoSongs=[{name:"sway",description:" SWAY by m @ Bits'n'Bites, from the 4k demo <a href=\"http://pouet.net/prod.php?which=59203\">SWAY</a>",data:String.fromCharCode(83,66,111,120,8,2,237,154,65,107,19,65,20,199,255,179,51,179,141,166,49,197,82,161,66,48,80,164,122,235,65,177,7,193,67,114,244,86,61,89,232,161,158,84,12,38,177,32,107,183,75,65,171,165,39,167,244,32,4,161,244,27,120,20,84,122,243,43,120,242,27,120,241,30,103,179,219,180,221,100,119,74,117,179,89,120,191,201,236,219,183,111,19,94,38,111,231,237,155,236,251,25,224,170,245,216,3,255,225,65,99,87,112,40,24,159,253,214,250,163,236,7,182,100,22,211,112,161,165,110,192,68,33,104,246,5,12,195,113,182,60,221,55,221,117,215,27,182,143,148,153,54,216,23,12,246,88,255,177,170,173,171,177,239,107,32,117,138,37,195,9,215,78,248,225,68,252,114,144,15,154,161,116,35,122,211,109,56,77,119,45,245,248,41,197,30,239,181,98,37,198,94,197,77,84,48,91,206,58,126,74,197,233,114,130,185,172,125,124,145,96,63,140,139,159,213,156,196,79,195,129,211,208,175,56,57,246,241,239,194,109,234,87,84,182,61,120,109,52,95,129,32,146,232,190,100,232,62,7,131,176,231,124,221,186,196,216,252,125,169,247,88,15,171,191,119,44,135,162,250,91,53,68,87,99,63,16,138,98,129,32,8,130,200,37,59,65,191,43,46,214,241,69,130,253,222,66,245,153,156,18,58,111,91,220,226,194,207,238,220,111,128,236,33,204,217,112,55,162,143,34,75,154,234,214,185,179,101,115,21,241,95,141,234,78,36,85,255,149,82,227,238,127,214,119,82,38,255,235,103,26,123,117,180,81,81,61,15,241,67,16,68,62,177,190,123,186,239,92,6,158,182,182,241,78,50,171,176,60,179,184,43,31,22,120,176,170,62,216,98,62,169,145,243,145,104,230,220,255,172,199,255,138,193,44,147,237,139,116,45,18,4,65,156,15,142,13,240,250,6,216,79,33,110,176,59,130,89,181,214,235,175,53,123,222,95,68,247,243,54,15,165,159,193,153,240,27,55,215,85,42,131,154,252,127,16,239,191,82,121,241,61,207,36,196,15,253,249,65,16,4,17,199,35,15,88,241,38,129,73,212,122,69,122,183,140,234,18,127,43,122,25,156,7,25,60,148,128,144,34,174,182,250,164,39,219,143,186,119,122,114,175,175,239,135,122,218,79,94,73,211,242,98,45,217,156,228,127,71,111,221,49,255,33,51,31,127,227,61,163,201,255,125,28,4,82,139,253,1,61,109,76,225,51,107,176,119,66,127,59,161,191,81,61,99,254,241,234,32,8,98,172,107,242,15,59,96,191,60,61,205,46,99,133,127,150,140,95,223,186,87,219,227,29,187,127,138,95,151,7,213,121,144,197,99,166,228,104,166,216,28,241,55,41,26,150,119,151,13,115,213,155,211,234,246,201,204,189,62,10,255,13,182,149,4,123,5,217,63,163,110,90,93,191,101,200,36,38,255,183,13,246,118,138,227,15,195,248,15,137,159,1,76,119,130,107,52,25,17,4,113,94,186,79,152,238,96,144,19,7,65,77,14,107,106,73,222,62,122,68,253,248,81,245,193,35,167,160,229,79,130,32,8,130,24,61,127,1)},{name:"rechord",description:" re:chord by m @ Bits'n'Bites, from the 4k demo <a href=\"http://www.pouet.net/prod.php?which=60915\">re:chord</a>",base64:"U0JveAgC7ZpRa9NQFMfPzU0ycZ0gOEWYo6CC4AaDPakPPgk-TPDBtz34oEMRQcZkdJTZMEdLSUhDQrexSV_9AH6BoU9-Cz-DH8B6bpKmN0nTTGVNiueXnp5zc9v03Jvb_O9N254HWFR-GaD0jSsA2vICIEoFKuv32COFJTauii2IYAQ1OcJH3Y_rMIjKzrYc4WPTj7dgWqjBW9mw099hz0e2PdlsKpXx5cvL6fIb7PbIsPs38Bxs4Bl45Vux-SdJ5k8QBFEc_Csq-anB8dpVvQvPZhiff8iqK3xJlVXcf6WqoYIHcfCcxszxTsLbCe_l-LHXXj6-vmrkH6Od4c2MfK3Qd0LvJryTKJ8npuM5MbM9W7Zz175_fH_bdu2YWY4lzOy4HWFl_yYV3f85wz8aq1l0j3vHMTv6dCTs8KR3IoyulQRRXlDF0d4zgCdX15QdnSkLvVurDXVFHSj2UM2Hqj5KyWuJ8qRX4nM59QdnXpMHbIZ-q6D853LyX6PBSxAEQQglBwNVHJerfQ2u-1P7_k-4MahlyugNa7IP6XmpJbR3plV1SYjy90Q82OXRWCEIgiBKSR_X4_0PqMyqfseX9kug3Lx9MVTyELFfioGNEPJWjk0rQf6tFg0VgiAIopRr8pcG8O-GBqDp9-GbzvgiKEuevqMHK_JgZS7fWc_6lbyBeufAYczbki87u9DEPLuS3wcLfQPLnSnInyAIgvhPldy1gP0w_L_LPOdfNMYftNRrB9zQQ9Xmvo7zQL1VTdX0GbGlj-RkfIK4LW1PoCWzOfXrf3i8LmYeWDEqPpvTtgs5beuiTdP8wwEzGkMi8grs77-hjaPcjfW_gzNBMad1cSbolr7_90MLqOMMNo18Y2pvRL2Z8dpJsOfPxofzciOMPmbkPGhrU9rXjJ3PdJsIoqyw09cMnr4A9liFz0LPFZ3pq7vRZY1Jz0GU3CMrNkEQBEEQk-U3"},{name:"spacedust",description:" Space Dust by m @ Bits'n'Bites",data:String.fromCharCode(83,66,111,120,8,2,237,154,79,107,19,65,24,198,159,249,179,187,145,52,22,69,161,32,74,160,74,35,30,75,209,67,123,170,244,228,69,208,91,15,241,28,197,67,23,33,68,210,96,13,41,161,151,176,233,178,49,13,1,79,138,31,64,240,32,185,121,240,11,136,159,192,111,161,179,219,77,92,154,29,247,160,197,157,240,254,178,79,158,77,38,153,188,51,236,206,203,187,155,147,21,224,6,175,186,96,19,183,0,44,99,21,27,130,241,157,143,27,247,14,197,129,180,109,238,48,198,69,82,18,176,66,71,10,94,224,191,9,252,227,64,231,56,103,74,25,237,119,50,218,253,225,96,52,28,4,67,157,35,231,244,252,126,224,247,61,95,231,121,143,191,131,70,164,69,164,219,239,4,121,143,241,127,159,191,197,140,19,120,121,53,223,199,127,81,173,64,197,200,147,251,145,135,35,43,149,112,19,75,106,231,130,146,133,91,8,23,81,134,181,240,171,21,165,219,32,136,191,64,76,92,165,22,7,94,84,134,124,199,98,188,248,238,210,122,77,28,56,97,107,156,193,229,84,22,108,156,238,207,247,212,232,152,61,19,205,174,217,241,215,219,139,21,127,207,55,43,126,195,15,127,52,105,49,36,8,99,225,213,35,165,150,196,21,199,217,196,35,155,137,171,159,156,7,95,228,19,153,200,228,243,74,233,169,49,219,204,172,173,154,179,173,137,174,129,235,90,125,182,213,209,14,61,166,141,30,70,120,79,135,58,65,16,196,162,242,211,101,74,96,144,118,116,249,138,95,100,172,188,98,253,46,218,25,103,124,234,179,71,74,71,94,134,242,142,62,118,83,70,160,27,151,217,241,19,4,65,16,89,236,158,106,83,58,215,163,50,252,199,87,148,159,90,142,156,182,51,22,93,75,231,44,129,38,103,120,113,238,155,119,207,228,76,98,122,252,4,65,16,196,34,35,182,92,136,215,225,125,242,146,93,139,106,242,37,20,30,62,179,171,118,242,83,225,159,221,166,178,52,61,141,207,188,30,197,126,18,61,251,248,96,64,77,110,50,111,53,243,63,136,231,63,239,244,52,239,135,227,48,225,222,64,214,125,242,6,8,130,32,206,41,147,99,31,226,254,62,216,119,41,43,236,174,202,213,219,123,47,63,111,219,107,103,235,110,161,74,113,62,85,86,54,212,121,238,171,239,20,31,143,35,55,54,209,155,30,63,65,16,4,145,193,164,165,116,116,25,223,106,123,93,118,104,51,94,216,189,86,238,91,143,11,127,250,82,90,50,127,158,241,67,175,104,174,9,130,32,8,226,159,243,11)},{name:"8bit",description:" 8 Bit One by m @ Bits'n'Bites",data:String.fromCharCode(83,66,111,120,8,2,237,219,49,107,219,64,20,7,240,119,58,217,130,144,216,201,226,146,33,32,98,74,218,177,93,186,52,99,200,84,58,36,75,72,134,102,78,178,9,99,227,202,85,13,65,180,8,19,115,56,24,211,16,98,2,249,16,89,252,141,2,25,187,56,119,82,228,154,243,112,14,4,91,46,255,31,247,116,122,150,100,206,135,204,227,140,220,120,67,84,224,3,143,248,32,32,34,103,185,36,183,100,13,137,220,109,190,97,51,139,89,234,133,180,55,17,151,189,81,107,181,133,140,206,168,253,138,90,157,80,157,35,35,237,155,50,90,99,253,188,181,59,221,81,139,90,237,110,116,33,70,45,148,113,174,206,145,145,246,106,206,162,177,30,0,0,96,30,172,192,35,235,135,87,36,218,43,255,228,77,89,191,223,221,89,238,65,238,208,73,106,184,170,226,106,203,141,239,20,106,121,83,203,235,250,5,149,108,205,196,185,150,7,90,94,211,47,240,178,53,254,208,112,188,142,155,29,0,224,255,172,228,223,60,21,43,68,199,31,191,179,223,14,227,111,247,45,55,180,143,248,75,43,121,207,144,95,107,249,149,150,247,181,252,102,198,51,209,53,228,250,120,255,24,198,123,61,227,241,247,12,199,77,227,233,227,203,0,0,176,144,248,223,136,248,167,128,211,26,95,125,79,123,114,77,254,120,203,118,190,228,215,243,234,232,191,74,110,126,167,122,178,14,111,80,195,151,251,141,120,201,237,171,165,108,173,42,247,107,153,159,137,90,178,14,247,201,175,203,125,63,94,114,203,207,84,165,106,69,238,87,113,171,0,0,64,54,13,61,38,131,24,217,249,114,188,72,47,48,230,166,7,153,68,86,188,53,18,73,196,77,76,230,98,81,39,40,249,28,66,224,86,1,0,128,108,10,146,248,108,47,109,210,125,142,216,67,72,238,105,110,213,78,43,121,98,154,146,39,198,67,76,228,0,0,0,240,234,226,39,222,130,160,72,228,20,182,232,216,102,252,67,143,206,78,236,175,246,243,170,252,249,247,245,41,10,57,158,93,7,0,0,152,189,129,151,4,57,165,221,184,180,171,127,161,97,90,0,0,0,22,195,19)},{name:"4chordsong",description:" 4 Chord Song by m @ Bits'n'Bites, chord test inspired by <a href=\"http://www.youtube.com/watch?v=5pidokakU4I\">Axis of Awsome</a>",data:String.fromCharCode(83,66,111,120,8,2,237,153,65,107,19,81,16,199,231,189,151,77,2,105,14,90,8,138,72,115,80,170,168,24,76,3,70,237,161,164,90,176,74,245,166,168,72,169,199,80,2,45,24,66,36,123,168,49,100,27,82,210,96,212,196,80,20,36,8,222,252,0,30,252,22,130,31,64,4,63,130,190,236,190,109,195,146,237,174,77,163,151,255,111,102,24,246,205,16,102,103,55,12,239,237,167,179,68,19,252,134,78,124,81,23,68,39,194,115,52,45,24,127,190,196,227,122,224,36,39,98,140,9,226,140,145,47,74,125,89,43,229,10,36,101,181,176,86,36,41,185,98,46,79,82,178,249,156,65,150,148,149,84,148,108,40,169,43,169,42,177,243,237,188,134,146,154,18,59,223,206,139,202,26,246,179,139,210,230,165,37,165,101,164,205,12,248,57,31,245,239,119,239,27,213,202,22,141,72,212,99,61,229,18,207,140,220,127,11,247,254,91,184,247,127,175,206,225,22,221,237,127,70,245,255,186,180,132,122,30,9,185,122,158,0,0,0,28,20,241,109,155,248,186,30,36,10,70,22,104,94,78,242,196,179,200,185,219,193,227,65,198,184,226,112,38,249,184,239,196,158,24,110,126,153,110,209,85,229,211,202,95,51,253,34,93,246,81,127,163,213,54,181,241,242,181,169,205,86,219,212,102,171,99,234,184,38,185,205,2,94,86,0,0,0,67,224,73,185,39,191,160,203,105,157,138,117,233,81,136,137,163,211,20,79,104,179,26,27,192,207,48,47,41,95,80,190,168,124,94,249,178,195,87,28,222,222,219,85,29,215,198,238,158,209,162,230,184,182,55,195,17,151,186,236,245,83,46,241,148,163,126,55,202,30,113,195,35,94,247,136,71,60,226,15,240,178,2,0,0,24,2,251,162,247,141,17,77,76,94,162,87,26,19,167,219,137,116,86,36,133,25,101,150,249,161,108,212,77,45,87,107,166,86,140,186,169,21,99,203,84,231,164,207,57,38,61,0,0,0,0,254,30,241,93,151,195,116,157,104,50,44,166,232,67,128,241,99,119,143,172,220,209,158,6,213,164,231,140,11,30,240,241,75,239,149,239,42,191,163,124,103,96,189,165,178,186,244,209,244,77,149,213,161,222,200,119,18,243,56,158,94,153,58,88,253,61,31,245,247,232,243,184,31,84,204,35,62,243,191,251,239,245,117,32,59,226,153,70,11,127,86,0,0,24,62,201,223,173,50,246,88,238,203,179,20,222,161,165,16,19,247,223,240,248,25,109,205,26,222,76,217,8,108,163,201,0,0,0,192,24,217,180,236,119,183,219,165,164,220,129,95,249,69,203,247,216,91,245,105,156,249,30,228,47,208,74,0,0,0,224,223,211,63,93,255,33,247,228,244,53,242,147,102,195,196,181,205,155,233,39,218,195,208,94,138,191,89,238,117,58,90,66,175,1,0,0,128,67,231,15)}],gInstrumentPresets=[{name:"====[LEADS]===="},{name:"Softy",i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,195,6,1,2,135,0,0,32,147,6,121,6]},{name:"Classic 8-bit",i:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,69,3,1,1,23,167,0,32,77,6,25,6]},{name:"Square",i:[1,255,128,0,1,154,128,9,0,0,7,5,52,0,0,0,0,2,255,0,0,32,47,3,146,2]},{name:"Bell",i:[0,255,152,0,0,255,152,12,0,0,2,0,60,0,0,0,0,2,255,0,0,32,47,3,157,2]},{name:"Filter Bass 1",i:[2,100,128,0,3,201,128,0,0,0,0,6,29,0,195,4,1,3,50,184,119,244,147,6,84,6]},{name:"====[PADS]===="},{name:"Base string",i:[2,192,128,0,2,192,140,18,0,0,158,119,158,0,0,0,0,2,5,0,0,32,0,0,24,8]},{name:"Base string (dist)",i:[2,192,128,0,2,192,140,18,0,0,107,115,138,0,136,5,1,2,8,92,21,32,148,5,85,8]},{name:"Evil brass",i:[3,146,140,0,1,224,128,3,0,0,92,0,95,3,179,5,1,2,124,135,11,32,150,3,157,6]},{name:"====[DRUMS]===="},{name:"Bass drum 1",i:[0,255,116,1,0,255,116,0,1,0,4,6,35,0,0,0,0,2,14,0,0,32,0,0,0,0]},{name:"Bass drum 2",i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,2,14,0,1,39,76,5,0,0]},{name:"Bass drum 3",i:[0,255,116,1,0,255,116,0,1,14,4,6,45,0,0,0,0,2,136,15,0,32,0,0,66,6]},{name:"Base tom",i:[0,192,104,1,0,80,99,0,0,0,4,0,66,3,0,0,0,1,0,1,2,32,37,4,0,0]},{name:"Snare 1",i:[0,160,128,1,0,160,128,0,1,210,4,7,41,0,60,4,1,2,255,0,0,32,61,5,32,6]},{name:"Snare 2",i:[0,221,128,1,0,210,128,0,1,255,4,6,62,0,64,7,1,3,255,15,0,32,20,0,24,6]},{name:"Snare 3",i:[3,0,128,0,3,68,128,0,1,218,4,4,40,1,55,4,1,2,67,115,124,190,67,6,39,1]},{name:"Hihat 1",i:[0,0,140,0,0,0,140,0,0,60,4,10,34,0,187,5,0,1,239,135,0,32,108,5,16,4]},{name:"Hihat 2",i:[2,40,140,1,0,0,140,0,0,255,5,0,48,0,0,0,0,3,161,192,0,32,0,0,71,1]},{name:"Open hihat",i:[0,0,128,0,0,0,128,0,0,125,0,1,59,0,0,0,0,1,193,171,0,29,39,3,88,3]},{name:"Smash",i:[0,214,104,1,0,204,104,0,1,229,4,40,21,0,231,6,1,3,183,15,0,32,232,4,74,6]},{name:"Pipe hit",i:[3,255,128,0,0,255,140,0,0,127,2,2,23,0,96,3,1,3,94,79,0,32,84,2,12,4]},{name:"====[F/X]===="},{name:"Wind",i:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,51,2,1,2,58,239,0,32,88,1,157,2]},{name:"Long beat",i:[0,255,106,1,0,255,106,0,1,0,5,7,164,0,0,0,0,2,255,0,2,32,83,5,25,1]},{name:"Siren",i:[1,0,128,0,1,0,128,0,0,255,158,100,158,3,67,4,1,3,57,254,85,171,88,1,157,2]}];var CPlayer=function(){var e,t,n=new Worker("tracker/js/player-worker.js");n.onmessage=function(n){"progress"===n.data.cmd&&(t=n.data.buffer,e&&e(n.data.progress))},this.generate=function(t,r,a){e=a,n.postMessage({cmd:"generate",song:t,opts:r})},this.createWave=function(){var e=t,n=e.length,r=2*n-8,a=r-36,o=44,i=new Uint8Array(o+2*n);i.set([82,73,70,70,255&r,r>>8&255,r>>16&255,r>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&a,a>>8&255,a>>16&255,a>>24&255]);for(var s=0,f=o;n>s;++s){var c=e[s];c=-32767>c?-32767:c>32767?32767:c,i[f++]=255&c,i[f++]=c>>8&255}return i},this.getData=function(e,n){for(var r=2*Math.floor(44100*e),a=new Array(n),o=t,i=0;2*n>i;i+=1){var s=r+i;a[i]=e>0&&s<o.length?o[s]/32768:0}return a}},CJammer=function(){var e,t,n,r,a,o,i,s,f,c=8,d=[],u=131072,l=function(e){return Math.sin(6.283184*e)},p=function(e){return 2*(e%1)-1},m=function(e){return.5>e%1?1:-1},g=function(e){var t=e%1*4;return 2>t?t-1:3-t},v=function(e){return 174.614115728/s*Math.pow(2,(e-128)/12)},h=[l,m,p,g],E=function(o,i){var p,m,g,v,E,w,B,y=i.length;for(g=0;y>g;++g)o[g]=0,i[g]=0;for(p=0;c>p;++p){var _=d[p];if(void 0!=_){var b=h[_.instr[0]],I=_.instr[1],L=_.instr[3],T=h[_.instr[4]],D=_.instr[5],U=_.instr[8],x=_.instr[9],C=Math.round(_.instr[10]*_.instr[10]*4*f),S=Math.round(_.instr[11]*_.instr[11]*4*f),Y=Math.round(_.instr[12]*_.instr[12]*4*f),k=1/Y,M=_.o1f,A=_.o2f,R=_.o1t,z=_.o2t,O=C+S+Y-_.env;for(y>=O?d[p]=void 0:O=y,m=_.env,g=0;O>g;m++,g++)E=1,C>m?E=m/C:m>=C+S&&(E-=(m-C-S)*k),v=M,L&&(v*=E*E),R+=v,w=b(R)*I,v=A,U&&(v*=E*E),z+=v,w+=T(z)*D,x&&(w+=(2*Math.random()-1)*x),i[g]+=.002441481*w*E;_.env=m,_.o1t=R,_.o2t=z}}var P,N,j,$=n.pos,q=n.low,F=n.band,X=n.filterActive,J=n.dlyPos,H=u-1,W=h[e[13]],G=e[14]/512,V=Math.pow(2,e[15]-9)/t,Q=e[16],Z=e[17],K=43.23529*e[18]*3.141592/s,ee=1-e[19]/255,te=1e-5*e[20]*32767,ne=e[21]/32,re=e[22]/512,ae=6.283184*Math.pow(2,e[23]-9)/t,oe=e[24]/255,ie=e[25]*t>>1;for(ie>=u&&(ie=u-1),m=0;y>m;m++)g=2*($+m),w=i[m],w||X?(B=K,Q&&(B*=W(V*g)*G+.5),B=1.5*Math.sin(B),q+=B*F,N=ee*(w-F)-q,F+=B*N,w=3==Z?F:1==Z?N:q,te&&(w*=te,w=1>w?w>-1?l(.25*w):-1:1,w/=te),w*=ne,X=w*w>1e-5,v=Math.sin(ae*g)*re+.5,P=w*(1-v),w*=v):P=0,j=J-ie&H,P+=a[j]*oe,w+=r[j]*oe,r[J]=P,a[J]=w,J=J+1&H,o[m]=P,i[m]=w;for($+=y;$>2048*t;)$-=2048*t;n.pos=$,n.low=q,n.band=F,n.filterActive=X,n.dlyPos=J};this.start=function(){if(window.AudioContext)o=new AudioContext;else{if(!window.webkitAudioContext)return void(o=void 0);o=new webkitAudioContext,o.createScriptProcessor=o.createJavaScriptNode}s=o.sampleRate,f=s/44100,n={pos:0,low:0,band:0,filterActive:!1,dlyPos:0},r=new Float32Array(u),a=new Float32Array(u),i=o.createScriptProcessor(2048,0,2),i.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0),n=e.outputBuffer.getChannelData(1);E(t,n)},i.connect(o.destination)},this.stop=function(){},this.updateInstr=function(t){e=[];for(var n=0;n<t.length;++n)e.push(t[n])},this.updateRowLen=function(e){t=Math.round(e*f)},this.addNote=function(t){var n,r=(new Date).getTime(),a={startT:r,env:0,o1t:0,o2t:0,o1f:v(t+e[2]-128),o2f:v(t+e[6]-128)*(1+8e-4*e[7]),instr:new Array(13)};for(n=0;13>n;++n)a.instr[n]=e[n];var o=0,i=-100;for(n=0;c>n;++n){if(void 0==d[n])return void(d[n]=a);var s=r-d[n].startT;s>i&&(o=n,i=s)}d[o]=a}};if(function(){function e(){this.fc=0,this.dl=0}function t(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0}function n(e,t,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r}function r(){this.next=null,this.len=0,this.ptr=[],this.off=0}function a(n){var r;if(n?1>n?n=1:n>9&&(n=9):n=We,me=n,X=!1,de=!1,null===Tt){for($=q=F=null,Tt=[],G=[],V=[],Q=[],Z=[],he=[],r=0;It>r;r++)he[r]=new e;for(Ee=[],r=0;2*wt+1>r;r++)Ee[r]=new e;for(we=[],r=0;Et+2>r;r++)we[r]=new e;for(Be=[],r=0;wt>r;r++)Be[r]=new e;for(ye=[],r=0;2*Bt+1>r;r++)ye[r]=new e;_e=new t,be=new t,Ie=new t,Le=[],Te=[],xe=[],Ce=[],Se=[],Ye=[],ke=[],Me=[]}}function o(e){e.next=$,$=e}function i(){var e;return null!==$?(e=$,$=$.next):e=new r,e.next=null,e.len=e.off=0,e}function s(e){return Z[Fe+e]}function f(e,t){return Z[Fe+e]=t}function c(e){Tt[H+J++]=e,H+J===Qe&&N()}function d(e){e&=65535,Qe-2>H+J?(Tt[H+J++]=255&e,Tt[H+J++]=e>>>8):(c(255&e),c(e>>>8))}function u(){ne=(ne<<Lt^255&G[fe+Ke-1])&it,re=s(ne),Z[fe&st]=re,f(ne,fe)}function l(e,t){z(t[e].fc,t[e].dl)}function p(e){return 255&(256>e?Se[e]:Se[256+(e>>7)])}function m(e,t,n){return e[t].fc<e[n].fc||e[t].fc===e[n].fc&&xe[t]<=xe[n]}function g(e,t,n){var r;for(r=0;n>r&&qe<$e.length;r++)e[t+r]=255&$e[qe++];return r}function v(){var e;for(e=0;ot>e;e++)Z[Fe+e]=0;if(pe=St[me].max_lazy,ge=St[me].good_length,Ge||(ve=St[me].nice_length),le=St[me].max_chain,fe=0,te=0,ue=g(G,0,2*Fe),0>=ue)return de=!0,void(ue=0);for(de=!1;dt>ue&&!de;)E();for(ne=0,e=0;Ke-1>e;e++)ne=(ne<<Lt^255&G[e])&it}function h(e){var t,n,r,a,o=le,i=fe,s=se,f=fe>ut?fe-ut:ft,c=fe+et,d=G[i+s-1],u=G[i+s];se>=ge&&(o>>=2);do if(t=e,G[t+s]===u&&G[t+s-1]===d&&G[t]===G[i]&&G[++t]===G[i+1]){for(i+=2,t++;c>i;){for(a=!1,r=0;8>r;r+=1)if(i+=1,t+=1,G[i]!==G[t]){a=!0;break}if(a)break}if(n=et-(c-i),i=c-et,n>s){if(ce=e,s=n,Ge){if(n>=et)break}else if(n>=ve)break;d=G[i+s-1],u=G[i+s]}}while((e=Z[e&st])>f&&0!==--o);return s}function E(){var e,t,n=Ze-ue-fe;if(-1===n)n--;else if(fe>=Fe+ut){for(e=0;Fe>e;e++)G[e]=G[e+Fe];for(ce-=Fe,fe-=Fe,te-=Fe,e=0;ot>e;e++)t=s(e),f(e,t>=Fe?t-Fe:ft);for(e=0;Fe>e;e++)t=Z[e],Z[e]=t>=Fe?t-Fe:ft;n+=Fe}de||(e=g(G,fe+ue,n),0>=e?de=!0:ue+=e)}function w(){for(;0!==ue&&null===q;){var e;if(u(),re!==ft&&ut>=fe-re&&(ie=h(re),ie>ue&&(ie=ue)),ie>=Ke)if(e=A(fe-ce,ie-Ke),ue-=ie,pe>=ie){ie--;do fe++,u();while(0!==--ie);fe++}else fe+=ie,ie=0,ne=255&G[fe],ne=(ne<<Lt^255&G[fe+1])&it;else e=A(0,255&G[fe]),ue--,fe++;for(e&&(M(0),te=fe);dt>ue&&!de;)E()}}function B(){for(;0!==ue&&null===q;){if(u(),se=ie,ae=ce,ie=Ke-1,re!==ft&&pe>se&&ut>=fe-re&&(ie=h(re),ie>ue&&(ie=ue),ie===Ke&&fe-ce>ct&&ie--),se>=Ke&&se>=ie){var e;e=A(fe-1-ae,se-Ke),ue-=se-1,se-=2;do fe++,u();while(0!==--se);oe=!1,ie=Ke-1,fe++,e&&(M(0),te=fe)}else oe?(A(0,255&G[fe-1])&&(M(0),te=fe),fe++,ue--):(oe=!0,fe++,ue--);for(;dt>ue&&!de;)E()}}function y(){de||(K=0,ee=0,I(),v(),q=null,J=0,H=0,3>=me?(se=Ke-1,ie=0):(ie=Ke-1,oe=!1),W=!1)}function _(e,t,n){var r;return X||(y(),X=!0,0!==ue)?(r=b(e,t,n),r===n?n:W?r:(3>=me?w():B(),0===ue&&(oe&&A(0,255&G[fe-1]),M(1),W=!0),r+b(e,r+t,n-r))):(W=!0,0)}function b(e,t,n){var r,a,i;for(r=0;null!==q&&n>r;){for(a=n-r,a>q.len&&(a=q.len),i=0;a>i;i++)e[t+r+i]=q.ptr[q.off+i];if(q.off+=a,q.len-=a,r+=a,0===q.len){var s;s=q,q=q.next,o(s)}}if(r===n)return r;if(J>H){for(a=n-r,a>J-H&&(a=J-H),i=0;a>i;i++)e[t+r+i]=Tt[H+i];H+=a,r+=a,J===H&&(J=H=0)}return r}function I(){var e,t,n,r,a;if(0===Be[0].dl){for(_e.dyn_tree=he,_e.static_tree=we,_e.extra_bits=Dt,_e.extra_base=vt+1,_e.elems=Et,_e.max_length=pt,_e.max_code=0,be.dyn_tree=Ee,be.static_tree=Be,be.extra_bits=Ut,be.extra_base=0,be.elems=wt,be.max_length=pt,be.max_code=0,Ie.dyn_tree=ye,Ie.static_tree=null,Ie.extra_bits=xt,Ie.extra_base=0,Ie.elems=Bt,Ie.max_length=mt,Ie.max_code=0,n=0,r=0;gt-1>r;r++)for(Ye[r]=n,e=0;e<1<<Dt[r];e++)Ce[n++]=r;for(Ce[n-1]=r,a=0,r=0;16>r;r++)for(ke[r]=a,e=0;e<1<<Ut[r];e++)Se[a++]=r;for(a>>=7;wt>r;r++)for(ke[r]=a<<7,e=0;e<1<<Ut[r]-7;e++)Se[256+a++]=r;for(t=0;pt>=t;t++)Le[t]=0;for(e=0;143>=e;)we[e++].dl=8,Le[8]++;for(;255>=e;)we[e++].dl=9,Le[9]++;for(;279>=e;)we[e++].dl=7,Le[7]++;for(;287>=e;)we[e++].dl=8,Le[8]++;for(U(we,Et+1),e=0;wt>e;e++)Be[e].dl=5,Be[e].fc=O(e,5);L()}}function L(){var e;for(e=0;Et>e;e++)he[e].fc=0;for(e=0;wt>e;e++)Ee[e].fc=0;for(e=0;Bt>e;e++)ye[e].fc=0;he[ht].fc=1,Ne=je=0,Ae=Re=ze=0,Oe=0,Pe=1}function T(e,t){for(var n=Te[t],r=t<<1;De>=r&&(De>r&&m(e,Te[r+1],Te[r])&&r++,!m(e,n,Te[r]));)Te[t]=Te[r],t=r,r<<=1;Te[t]=n}function D(e){var t,n,r,a,o,i,s=e.dyn_tree,f=e.extra_bits,c=e.extra_base,d=e.max_code,u=e.max_length,l=e.static_tree,p=0;for(a=0;pt>=a;a++)Le[a]=0;for(s[Te[Ue]].dl=0,t=Ue+1;It>t;t++)n=Te[t],a=s[s[n].dl].dl+1,a>u&&(a=u,p++),s[n].dl=a,n>d||(Le[a]++,o=0,n>=c&&(o=f[n-c]),i=s[n].fc,Ne+=i*(a+o),null!==l&&(je+=i*(l[n].dl+o)));if(0!==p){do{for(a=u-1;0===Le[a];)a--;Le[a]--,Le[a+1]+=2,Le[u]--,p-=2}while(p>0);for(a=u;0!==a;a--)for(n=Le[a];0!==n;)r=Te[--t],r>d||(s[r].dl!==a&&(Ne+=(a-s[r].dl)*s[r].fc,s[r].fc=a),n--)}}function U(e,t){var n,r,a=[],o=0;for(n=1;pt>=n;n++)o=o+Le[n-1]<<1,a[n]=o;for(r=0;t>=r;r++){var i=e[r].dl;0!==i&&(e[r].fc=O(a[i]++,i))}}function x(e){var t,n,r=e.dyn_tree,a=e.static_tree,o=e.elems,i=-1,s=o;for(De=0,Ue=It,t=0;o>t;t++)0!==r[t].fc?(Te[++De]=i=t,xe[t]=0):r[t].dl=0;for(;2>De;){var f=Te[++De]=2>i?++i:0;r[f].fc=1,xe[f]=0,Ne--,null!==a&&(je-=a[f].dl)}for(e.max_code=i,t=De>>1;t>=1;t--)T(r,t);do t=Te[lt],Te[lt]=Te[De--],T(r,lt),n=Te[lt],Te[--Ue]=t,Te[--Ue]=n,r[s].fc=r[t].fc+r[n].fc,xe[s]=xe[t]>xe[n]+1?xe[t]:xe[n]+1,r[t].dl=r[n].dl=s,Te[lt]=s++,T(r,lt);while(De>=2);Te[--Ue]=Te[lt],D(e),U(r,i)}function C(e,t){var n,r,a=-1,o=e[0].dl,i=0,s=7,f=4;for(0===o&&(s=138,f=3),e[t+1].dl=65535,n=0;t>=n;n++)r=o,o=e[n+1].dl,++i<s&&r===o||(f>i?ye[r].fc+=i:0!==r?(r!==a&&ye[r].fc++,ye[yt].fc++):10>=i?ye[_t].fc++:ye[bt].fc++,i=0,a=r,0===o?(s=138,f=3):r===o?(s=6,f=3):(s=7,f=4))}function S(e,t){var n,r,a=-1,o=e[0].dl,i=0,s=7,f=4;for(0===o&&(s=138,f=3),n=0;t>=n;n++)if(r=o,o=e[n+1].dl,!(++i<s&&r===o)){if(f>i){do l(r,ye);while(0!==--i)}else 0!==r?(r!==a&&(l(r,ye),i--),l(yt,ye),z(i-3,2)):10>=i?(l(_t,ye),z(i-3,3)):(l(bt,ye),z(i-11,7));i=0,a=r,0===o?(s=138,f=3):r===o?(s=6,f=3):(s=7,f=4)}}function Y(){var e;for(C(he,_e.max_code),C(Ee,be.max_code),x(Ie),e=Bt-1;e>=3&&0===ye[Ct[e]].dl;e--);return Ne+=3*(e+1)+5+5+4,e}function k(e,t,n){var r;for(z(e-257,5),z(t-1,5),z(n-4,4),r=0;n>r;r++)z(ye[Ct[r]].dl,3);S(he,e-1),S(Ee,t-1)}function M(e){var t,n,r,a,o;if(a=fe-te,Me[ze]=Oe,x(_e),x(be),r=Y(),t=Ne+3+7>>3,n=je+3+7>>3,t>=n&&(t=n),t>=a+4&&te>=0)for(z((Xe<<1)+e,3),P(),d(a),d(~a),o=0;a>o;o++)c(G[te+o]);else n===t?(z((Je<<1)+e,3),R(we,Be)):(z((He<<1)+e,3),k(_e.max_code+1,be.max_code+1,r+1),R(he,Ee));L(),0!==e&&P()}function A(e,t){if(Q[Ae++]=t,0===e?he[t].fc++:(e--,he[Ce[t]+vt+1].fc++,Ee[p(e)].fc++,V[Re++]=e,Oe|=Pe),Pe<<=1,0===(7&Ae)&&(Me[ze++]=Oe,Oe=0,Pe=1),me>2&&0===(4095&Ae)){var n,r=8*Ae,a=fe-te;for(n=0;wt>n;n++)r+=Ee[n].fc*(5+Ut[n]);if(r>>=3,Re<parseInt(Ae/2,10)&&r<parseInt(a/2,10))return!0}return Ae===nt-1||Re===at}function R(e,t){var n,r,a,o,i=0,s=0,f=0,c=0;if(0!==Ae)do 0===(7&i)&&(c=Me[f++]),r=255&Q[i++],0===(1&c)?l(r,e):(a=Ce[r],l(a+vt+1,e),o=Dt[a],0!==o&&(r-=Ye[a],z(r,o)),n=V[s++],a=p(n),l(a,t),o=Ut[a],0!==o&&(n-=ke[a],z(n,o))),c>>=1;while(Ae>i);l(ht,e)}function z(e,t){ee>Yt-t?(K|=e<<ee,d(K),K=e>>Yt-ee,ee+=t-Yt):(K|=e<<ee,ee+=t)}function O(e,t){var n=0;do n|=1&e,e>>=1,n<<=1;while(--t>0);return n>>1}function P(){ee>8?d(K):ee>0&&c(K),K=0,ee=0}function N(){var e,t;if(0!==J){for(e=i(),null===q?q=F=e:F=F.next=e,e.len=J-H,t=0;t<e.len;t++)e.ptr[t]=Tt[H+t];J=H=0}}function j(e,t){var n,r,o;if("string"==typeof e)for(o=e,e=[],n=0;n<o.length;n++)e[n]=o.charCodeAt(n);$e=e,qe=0,"undefined"==typeof t&&(t=We),a(t),r=[];do n=_(r,r.length,1024);while(n>0);for($e=null,o="",n=0;n<r.length;n++)o+=String.fromCharCode(r[n]);return o}var $,q,F,X,J,H,W,G,V,Q,Z,K,ee,te,ne,re,ae,oe,ie,se,fe,ce,de,ue,le,pe,me,ge,ve,he,Ee,we,Be,ye,_e,be,Ie,Le,Te,De,Ue,xe,Ce,Se,Ye,ke,Me,Ae,Re,ze,Oe,Pe,Ne,je,$e,qe,Fe=32768,Xe=0,Je=1,He=2,We=6,Ge=!1,Ve=32768,Qe=8192,Ze=2*Fe,Ke=3,et=258,tt=16,nt=8192,rt=15,at=nt,ot=1<<rt,it=ot-1,st=Fe-1,ft=0,ct=4096,dt=et+Ke+1,ut=Fe-dt,lt=1,pt=15,mt=7,gt=29,vt=256,ht=256,Et=vt+1+gt,wt=30,Bt=19,yt=16,_t=17,bt=18,It=2*Et+1,Lt=parseInt((rt+Ke-1)/Ke,10),Tt=null;nt>Ve&&console.error("error: INBUFSIZ is too small"),Fe<<1>1<<tt&&console.error("error: WSIZE is too large"),rt>tt-1&&console.error("error: HASH_BITS is too large"),(8>rt||258!==et)&&console.error("error: Code too clever");var Dt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ut=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],xt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ct=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],St=[new n(0,0,0,0),new n(4,4,8,4),new n(4,5,16,8),new n(4,6,32,32),new n(4,4,16,16),new n(8,16,32,32),new n(8,16,128,128),new n(8,32,128,256),new n(32,128,258,1024),new n(32,258,258,4096)],Yt=16;window.RawDeflate||(window.RawDeflate={}),window.RawDeflate.deflate=j}(),function(){function e(){this.next=null,this.list=null}function t(){this.e=0,this.b=0,this.n=0,this.t=null}function n(n,r,a,o,i,s){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var f,c,d,u,l,p,m,g,v,h,E,w,B,y,_,b,I,L=[],T=[],D=new t,U=[],x=[],C=[];for(I=this.root=null,p=0;p<this.BMAX+1;p++)L[p]=0;for(p=0;p<this.BMAX+1;p++)T[p]=0;for(p=0;p<this.BMAX;p++)U[p]=null;for(p=0;p<this.N_MAX;p++)x[p]=0;for(p=0;p<this.BMAX+1;p++)C[p]=0;c=r>256?n[256]:this.BMAX,v=n,h=0,p=r;do L[v[h]]++,h++;while(--p>0);if(L[0]===r)return this.root=null,this.m=0,void(this.status=0);for(m=1;m<=this.BMAX&&0===L[m];m++);for(g=m,m>s&&(s=m),p=this.BMAX;0!==p&&0===L[p];p--);for(u=p,s>p&&(s=p),y=1<<m;p>m;m++,y<<=1)if((y-=L[m])<0)return this.status=2,void(this.m=s);if((y-=L[p])<0)return this.status=2,void(this.m=s);for(L[p]+=y,C[1]=m=0,v=L,h=1,B=2;--p>0;)C[B++]=m+=v[h++];v=n,h=0,p=0;do 0!==(m=v[h++])&&(x[C[m]++]=p);while(++p<r);for(r=C[u],C[0]=p=0,v=x,h=0,l=-1,w=T[0]=0,E=null,_=0,null;u>=g;g++)for(f=L[g];f-->0;){for(;g>w+T[1+l];){if(w+=T[1+l],l++,_=(_=u-w)>s?s:_,(d=1<<(m=g-w))>f+1)for(d-=f+1,B=g;++m<_&&!((d<<=1)<=L[++B]);)d-=L[B];for(w+m>c&&c>w&&(m=c-w),_=1<<m,T[1+l]=m,E=[],b=0;_>b;b++)E[b]=new t;I=I?I.next=new e:this.root=new e,I.next=null,I.list=E,U[l]=E,l>0&&(C[l]=p,D.b=T[l],D.e=16+m,D.t=E,m=(p&(1<<w)-1)>>w-T[l],U[l-1][m].e=D.e,U[l-1][m].b=D.b,U[l-1][m].n=D.n,U[l-1][m].t=D.t)}for(D.b=g-w,h>=r?D.e=99:v[h]<a?(D.e=v[h]<256?16:15,D.n=v[h++]):(D.e=i[v[h]-a],D.n=o[v[h++]-a]),d=1<<g-w,m=p>>w;_>m;m+=d)E[m].e=D.e,E[m].b=D.b,E[m].n=D.n,E[m].t=D.t;for(m=1<<g-1;0!==(p&m);m>>=1)p^=m;for(p^=m;(p&(1<<w)-1)!==C[l];)w-=T[l],l--}this.m=T[1],this.status=0!==y&&1!==u?1:0}function r(){return x.length===C?-1:255&x[C++]}function a(e){for(;e>B;)w|=r()<<B,B+=8}function o(e){return w&O[e]}function i(e){w>>=e,B-=e}function s(e,t,n){var r,s,f;if(0===n)return 0;for(f=0;;){for(a(D),s=L.list[o(D)],r=s.e;r>16;){if(99===r)return-1;i(s.b),r-=16,a(r),s=s.t[o(r)],r=s.e}if(i(s.b),16!==r){if(15===r)break;for(a(r),b=s.n+o(r),i(r),a(U),s=T.list[o(U)],r=s.e;r>16;){if(99===r)return-1;i(s.b),r-=16,a(r),s=s.t[o(r)],r=s.e}for(i(s.b),a(r),I=g-s.n-o(r),i(r);b>0&&n>f;)b--,I&=S-1,g&=S-1,e[t+f++]=m[g++]=m[I++];if(f===n)return n}else if(g&=S-1,e[t+f++]=m[g++]=s.n,f===n)return n}return y=-1,f}function f(e,t,n){var r;if(r=7&B,i(r),a(16),r=o(16),i(16),a(16),r!==(65535&~w))return-1;for(i(16),b=r,r=0;b>0&&n>r;)b--,g&=S-1,a(8),e[t+r++]=m[g++]=o(8),i(8);return 0===b&&(y=-1),r}function c(e,t,r){if(!z){var a,o,i=[];for(a=0;144>a;a++)i[a]=8;for(null;256>a;a++)i[a]=9;for(null;280>a;a++)i[a]=7;for(null;288>a;a++)i[a]=8;if(h=7,o=new n(i,288,257,P,N,h),0!==o.status)return console.error("HufBuild error: "+o.status),-1;for(z=o.root,h=o.m,a=0;30>a;a++)i[a]=5;if(E=5,o=new n(i,30,0,j,$,E),o.status>1)return z=null,console.error("HufBuild error: "+o.status),-1;v=o.root,E=o.m}return L=z,T=v,D=h,U=E,s(e,t,r)}function d(e,t,r){var f,c,d,u,l,p,m,g,v,h=[];for(f=0;316>f;f++)h[f]=0;if(a(5),m=257+o(5),i(5),a(5),g=1+o(5),i(5),a(4),p=4+o(4),i(4),m>286||g>30)return-1;for(c=0;p>c;c++)a(3),h[q[c]]=o(3),i(3);for(null;19>c;c++)h[q[c]]=0;if(D=7,v=new n(h,19,19,null,null,D),0!==v.status)return-1;for(L=v.root,D=v.m,u=m+g,f=d=0;u>f;)if(a(D),l=L.list[o(D)],c=l.b,i(c),c=l.n,16>c)h[f++]=d=c;else if(16===c){if(a(2),c=3+o(2),i(2),f+c>u)return-1;for(;c-->0;)h[f++]=d}else if(17===c){if(a(3),c=3+o(3),i(3),f+c>u)return-1;for(;c-->0;)h[f++]=0;d=0}else{if(a(7),c=11+o(7),i(7),f+c>u)return-1;for(;c-->0;)h[f++]=0;d=0}if(D=A,v=new n(h,m,257,P,N,D),0===D&&(v.status=1),0!==v.status&&1!==v.status)return-1;for(L=v.root,D=v.m,f=0;g>f;f++)h[f]=h[f+m];return U=R,v=new n(h,g,0,j,$,U),T=v.root,U=v.m,0===U&&m>257?-1:0!==v.status?-1:s(e,t,r)}function u(){m||(m=[]),g=0,w=0,B=0,y=-1,_=!1,b=I=0,L=null}function l(e,t,n){var r,u;for(r=0;n>r;){if(_&&-1===y)return r;if(b>0){if(y!==Y)for(;b>0&&n>r;)b--,I&=S-1,g&=S-1,e[t+r++]=m[g++]=m[I++];else{for(;b>0&&n>r;)b--,g&=S-1,a(8),e[t+r++]=m[g++]=o(8),i(8);0===b&&(y=-1)}if(r===n)return r}if(-1===y){if(_)break;a(1),0!==o(1)&&(_=!0),i(1),a(2),y=o(2),i(2),L=null,b=0}switch(y){case Y:u=f(e,t+r,n-r);break;case k:u=L?s(e,t+r,n-r):c(e,t+r,n-r);break;case M:u=L?s(e,t+r,n-r):d(e,t+r,n-r);break;default:u=-1}if(-1===u)return _?0:-1;r+=u}return r}function p(e){var t,n,r=[];if("string"==typeof e)for(n=e,e=[],t=0;t<n.length;t++)e[t]=n.charCodeAt(t);u(),x=e,C=0;do t=l(r,r.length,1024);while(t>0);for(x=null,n="",t=0;t<r.length;t++)n+=String.fromCharCode(r[t]);return n}var m,g,v,h,E,w,B,y,_,b,I,L,T,D,U,x,C,S=32768,Y=0,k=1,M=2,A=9,R=6,z=null,O=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],P=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],j=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];window.RawDeflate||(window.RawDeflate={}),window.RawDeflate.inflate=p}(),"function"!=typeof Blob||"undefined"==typeof URL)if("function"==typeof Blob&&"undefined"!=typeof webkitURL)var URL=webkitURL;else var Blob=function(e){"use strict";var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},r=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},a=n.prototype,o=r.prototype,i=e.FileReaderSync,s=function(e){this.code=this[this.name=e]},f="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=f.length,d=e.URL||e.webkitURL||e,u=d.createObjectURL,l=d.revokeObjectURL,p=d,m=e.btoa,g=e.atob,v=!1,h=function(e){
v=!e},E=e.ArrayBuffer,w=e.Uint8Array;for(r.fake=o.fake=!0;c--;)s.prototype[f[c]]=c+1;try{w&&h.apply(0,new w(3528e4))}catch(B){}return d.createObjectURL||(p=e.URL={}),p.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof r?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):m?t+";base64,"+m(e.data):t+","+encodeURIComponent(e.data)):u?u.call(d,e):void 0},p.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&l&&l.call(d,e)},a.append=function(e){var n=this.data;if(w&&(e instanceof E||e instanceof w))if(v)n.push(String.fromCharCode.apply(String,new w(e)));else{for(var a="",o=new w(e),f=0,c=o.length;c>f;f++)a+=String.fromCharCode(o[f]);n.push(a)}else if("Blob"===t(e)||"File"===t(e)){if(!i)throw new s("NOT_READABLE_ERR");var d=new i;n.push(d.readAsBinaryString(e))}else e instanceof r?"base64"===e.encoding&&g?n.push(g(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},a.getBlob=function(e){return arguments.length||(e=null),new r(this.data.join(""),e,"raw")},a.toString=function(){return"[object BlobBuilder]"},o.slice=function(e,t,n){var a=arguments.length;return 3>a&&(n=null),new r(this.data.slice(e,a>1?t:this.data.length),n,this.encoding)},o.toString=function(){return"[object Blob]"},n}(e);return function(e,n){var r=n?n.type||"":"",a=new t;if(e)for(var o=0,i=e.length;i>o;o++)a.append(e[o]);return a.getBlob(r)}}(self);var saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(e){"use strict";var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=e.URL||e.webkitURL||e,a=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in a,i=function(n){var r=t.createEvent("MouseEvents");r.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(r)},s=e.webkitRequestFileSystem,f=e.requestFileSystem||s||e.mozRequestFileSystem,c=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},d="application/octet-stream",u=0,l=[],p=function(){for(var e=l.length;e--;){var t=l[e];"string"==typeof t?r.revokeObjectURL(t):t.remove()}l.length=0},m=function(e,t,n){t=[].concat(t);for(var r=t.length;r--;){var a=e["on"+t[r]];if("function"==typeof a)try{a.call(e,n||e)}catch(o){c(o)}}},g=function(t,r){var c,p,g,v=this,h=t.type,E=!1,w=function(){var e=n().createObjectURL(t);return l.push(e),e},B=function(){m(v,"writestart progress write writeend".split(" "))},y=function(){(E||!c)&&(c=w(t)),p?p.location.href=c:window.open(c,"_blank"),v.readyState=v.DONE,B()},_=function(e){return function(){return v.readyState!==v.DONE?e.apply(this,arguments):void 0}},b={create:!0,exclusive:!1};return v.readyState=v.INIT,r||(r="download"),o?(c=w(t),a.href=c,a.download=r,i(a),v.readyState=v.DONE,void B()):(e.chrome&&h&&h!==d&&(g=t.slice||t.webkitSlice,t=g.call(t,0,t.size,d),E=!0),s&&"download"!==r&&(r+=".download"),(h===d||s)&&(p=e),f?(u+=t.size,void f(e.TEMPORARY,u,_(function(e){e.root.getDirectory("saved",b,_(function(e){var n=function(){e.getFile(r,b,_(function(e){e.createWriter(_(function(n){n.onwriteend=function(t){p.location.href=e.toURL(),l.push(e),v.readyState=v.DONE,m(v,"writeend",t)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&y()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=v["on"+e]}),n.write(t),v.abort=function(){n.abort(),v.readyState=v.DONE},v.readyState=v.WRITING}),y)}),y)};e.getFile(r,{create:!1},_(function(e){e.remove(),n()}),_(function(e){e.code===e.NOT_FOUND_ERR?n():y()}))}),y)}),y)):void y())},v=g.prototype,h=function(e,t){return new g(e,t)};return v.abort=function(){var e=this;e.readyState=e.DONE,m(e,"abort")},v.readyState=v.INIT=0,v.WRITING=1,v.DONE=2,v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null,e.addEventListener("unload",p,!1),h}(self);!function(e){"use strict";function t(){}function n(){this.inputInUse=!1,this.outputInUse=!1;var e=document.createElement("object");e.id="_Jazz"+Math.random()+"ie",e.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",this.activeX=e;var t=document.createElement("object");t.id="_Jazz"+Math.random(),t.type="audio/x-jazz",e.appendChild(t),this.objRef=t;var n=document.createElement("p");n.appendChild(document.createTextNode("This page requires the "));var r=document.createElement("a");r.appendChild(document.createTextNode("Jazz plugin")),r.href="http://jazz-soft.net/",n.appendChild(r),n.appendChild(document.createTextNode(".")),t.appendChild(n);var a=document.getElementById("MIDIPlugin");if(!a){var a=document.createElement("div");a.id="MIDIPlugin",a.style.position="absolute",a.style.visibility="hidden",a.style.left="-9999px",a.style.top="-9999px",document.body.appendChild(a)}a.appendChild(e),this._Jazz=this.objRef.isJazz?this.objRef:this.activeX.isJazz?this.activeX:null,this._Jazz&&(this._Jazz._jazzTimeZero=this._Jazz.Time(),this._Jazz._perfTimeZero=window.performance.now())}function r(){this._jazzInstances=new Array,this._jazzInstances.push(new n),this._promise=new t,this._jazzInstances[0]._Jazz?(this._Jazz=this._jazzInstances[0]._Jazz,window.setTimeout(s.bind(this),3)):window.setTimeout(a.bind(this),3)}function a(){this._promise&&this._promise.fail({code:1})}function o(){this.jazz.MidiOutLong(this.data)}var i,r,s,f,c,d;t.prototype.then=function(e,t){this.accept=e,this.reject=t},t.prototype.succeed=function(e){this.accept&&this.accept(e)},t.prototype.fail=function(e){this.reject&&this.reject(e)},i=function(){var e=new r;return e._promise},s=function(){this._promise&&this._promise.succeed(this)},r.prototype.inputs=function(){if(!this._Jazz)return null;for(var e=this._Jazz.MidiInList(),t=new Array(e.length),n=0;n<e.length;n++)t[n]=new f(this,e[n],n);return t},r.prototype.outputs=function(){if(!this._Jazz)return null;for(var e=this._Jazz.MidiOutList(),t=new Array(e.length),n=0;n<e.length;n++)t[n]=new c(this,e[n],n);return t},f=function(e,t,r){this._listeners=[],this._midiAccess=e,this._index=r,this._inLongSysexMessage=!1,this._sysexBuffer=new Uint8Array,this.id=""+r+"."+t,this.manufacturer="",this.name=t,this.type="input",this.version="",this.onmidimessage=null;for(var a=null,o=0;o<e._jazzInstances.length&&!a;o++)e._jazzInstances[o].inputInUse||(a=e._jazzInstances[o]);a||(a=new n,e._jazzInstances.push(a)),a.inputInUse=!0,this._jazzInstance=a._Jazz,this._input=this._jazzInstance.MidiInOpen(this._index,d.bind(this))},f.prototype.addEventListener=function(e,t,n){if("midimessage"===e){for(var r=0;r<this._listeners.length;r++)if(this._listeners[r]==t)return;this._listeners.push(t)}},f.prototype.removeEventListener=function(e,t,n){if("midimessage"===e)for(var r=0;r<this._listeners.length;r++)if(this._listeners[r]==t)return void this._listeners.splice(r,1)},f.prototype.preventDefault=function(){this._pvtDef=!0},f.prototype.dispatchEvent=function(e){this._pvtDef=!1;for(var t=0;t<this._listeners.length;t++)this._listeners[t].handleEvent?this._listeners[t].handleEvent.bind(this)(e):this._listeners[t].bind(this)(e);return this.onmidimessage&&this.onmidimessage(e),this._pvtDef},f.prototype.appendToSysexBuffer=function(e){var t=this._sysexBuffer.length,n=new Uint8Array(t+e.length);n.set(this._sysexBuffer),n.set(e,t),this._sysexBuffer=n},f.prototype.bufferLongSysex=function(e,t){for(var n=t;n<e.length;){if(247==e[n])return n++,this.appendToSysexBuffer(e.slice(t,n)),n;n++}return this.appendToSysexBuffer(e.slice(t,n)),this._inLongSysexMessage=!0,n},d=function(e,t){var n,r=0,a=!1;for(n=0;n<t.length;n+=r){if(this._inLongSysexMessage){if(n=this.bufferLongSysex(t,n),247!=t[n-1])return;a=!0}else switch(a=!1,240&t[n]){case 128:case 144:case 160:case 176:case 224:r=3;break;case 192:case 208:r=2;break;case 240:switch(t[n]){case 240:if(n=this.bufferLongSysex(t,n),247!=t[n-1])return;a=!0;break;case 241:case 243:r=2;break;case 242:r=3;break;default:r=1}}var o=document.createEvent("Event");o.initEvent("midimessage",!1,!1),o.receivedTime=parseFloat(e.toString())+this._jazzInstance._perfTimeZero,a||this._inLongSysexMessage?(o.data=new Uint8Array(this._sysexBuffer),this._sysexBuffer.length=0,this._inLongSysexMessage=!1):o.data=new Uint8Array(t.slice(n,r+n)),this.dispatchEvent(o)}},c=function(e,t,r){this._listeners=[],this._midiAccess=e,this._index=r,this.id=""+r+"."+t,this.manufacturer="",this.name=t,this.type="output",this.version="";for(var a=null,o=0;o<e._jazzInstances.length&&!a;o++)e._jazzInstances[o].outputInUse||(a=e._jazzInstances[o]);a||(a=new n,e._jazzInstances.push(a)),a.outputInUse=!0,this._jazzInstance=a._Jazz,this._jazzInstance.MidiOutOpen(this.name)},c.prototype.send=function(e,t){var n=0;if(0===e.length)return!1;if(t&&(n=Math.floor(t-window.performance.now())),t&&n>1){var r=new Object;r.jazz=this._jazzInstance,r.data=e,window.setTimeout(o.bind(r),n)}else this._jazzInstance.MidiOutLong(e);return!0},window.navigator.requestMIDIAccess||(window.navigator.requestMIDIAccess=i)}(window),function(e){function t(){for(var t=["moz","webkit","o","ms"],n=t.length,r={value:function(e){return function(){return Date.now()-e}}(Date.now())};n>=0;n--)if(t[n]+"Now"in e.performance)return r.value=function(t){return function(){e.performance[t]()}}(t[n]+"Now"),r;return"timing"in e.performance&&"connectStart"in e.performance.timing&&(r.value=function(e){return function(){Date.now()-e}}(e.performance.timing.connectStart)),r}var n,r={};"performance"in e&&"now"in e.performance||("performance"in e||Object.defineProperty(e,"performance",{get:function(){return r}}),n=t(),Object.defineProperty(e.performance,"now",n))}(window);var CBinParser=function(e){var t=e,n=0;this.getUBYTE=function(){return 255&t.charCodeAt(n++)},this.getUSHORT=function(){var e=255&t.charCodeAt(n)|(255&t.charCodeAt(n+1))<<8;return n+=2,e},this.getULONG=function(){var e=255&t.charCodeAt(n)|(255&t.charCodeAt(n+1))<<8|(255&t.charCodeAt(n+2))<<16|(255&t.charCodeAt(n+3))<<24;return n+=4,e},this.getFLOAT=function(){var e=this.getULONG();if(0==e)return 0;var t=2147483648&e,n=e>>23&255,r=1+(8388607&e)/8388608,a=r*Math.pow(2,n-127);return t?-a:a},this.getTail=function(){var e=t.slice(n);return n=t.length,e}},CBinWriter=function(){var e="";this.putUBYTE=function(t){e+=String.fromCharCode(t)},this.putUSHORT=function(t){e+=String.fromCharCode(255&t,t>>8&255)},this.putULONG=function(t){e+=String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},this.putFLOAT=function(e){var t=0;if(0!=e){var n=0;0>e&&(n=2147483648,e=-e);for(var r=150;8388608>e;)e*=2,r--;for(;e>=16777216;)e/=2,r++;t=n|(255&r)<<23|8388607&e}this.putULONG(t)},this.append=function(t){e+=t},this.getData=function(){return e}},CAudioTimer=function(){var e=null,t=0,n=[0,0,0,0,0,0],r=0;this.setAudioElement=function(t){e=t},this.currentTime=function(){if(!e)return 0;var a,o=.001*(new Date).getTime(),i=o-t,s=e.currentTime,f=s-i;if(.01>s||f>.2||-.2>f)for(i=s,t=o-i,a=0;a<n.length;a++)n[a]=0;var c=0;for(a=0;a<n.length;a++)c+=n[a];return c/=n.length,n[r]=f,r=(r+1)%n.length,i+c},this.reset=function(){t=.001*(new Date).getTime();for(var e=0;e<n.length;e++)n[e]=0}},CGUI=function(){function e(){}var t,n,r,a,o,i=0,s=1,f=2,c=3,d=128,u=36,l=f,p=5,m=0,g=0,v=0,h=0,E=0,w=0,B=0,y=0,_=0,b=0,I=!1,L=!1,T=!1,D=[],U=[],x=[],C=[],S={},Y=null,k=new CAudioTimer,M=new CPlayer,A=new CJammer,R=["C-","C#","D-","D#","E-","F-","F#","G-","G#","A-","A#","B-"],z=[26,1,63,3,116,6,150,8,184,10,238,13,274,15,327,18,362,20,394,22],O=function(e){var t=e.indexOf("?");return e.slice(0,t>=0?t:e.length)},P=function(e){var t=e.indexOf("?")+1,n=e.indexOf("#")+1||e.length+1,r=e.slice(t,n-1),a={};if(r===e||""===r)return a;for(var o=r.replace(/\+/g," ").split("&"),i=0;i<o.length;i++){var s=o[i].split("="),f=decodeURIComponent(s[0]),c=decodeURIComponent(s[1]);f in a||(a[f]=[]),a[f].push(2===s.length?c:null)}return a},N=function(e){var t=void 0;if(e){var n=e,r="";if(0==n.indexOf("data:")){var a=n.indexOf("base64,");a>0&&(r=n.substr(a+7))}else for(var o=0;o<n.length;++o){var i=n[o];"-"===i&&(i="+"),"_"===i&&(i="/"),r+=i}try{t=atob(r)}catch(s){t=void 0}}return t},j=function(e){for(var n=btoa(e),r="",a=0;a<n.length;++a){var o=n[a];"+"===o&&(o="-"),"/"===o&&(o="_"),"="===o&&(o=""),r+=o}return t+"?data="+r},q=function(e){return Math.round(661500/e)},F=function(){return Math.round(661500/S.rowLen)},X=0,J=1,H=2,W=3,G=4,V=5,Q=6,Z=7,K=8,ee=9,te=10,ne=11,re=12,ae=13,oe=14,ie=15,se=16,fe=17,ce=18,de=19,ue=20,le=21,pe=22,me=23,ge=24,ve=25,he=function(){var e,t,n,r,a,o={};o.rowLen=q(120),o.endPattern=2,o.patternLen=32;var i;for(e=0;e<gInstrumentPresets.length;++e)if(gInstrumentPresets[e].i){i=gInstrumentPresets[e];break}for(o.songData=[],e=0;8>e;e++){for(r={},r.i=[],t=0;t<=i.i.length;++t)r.i[t]=i.i[t];for(r.p=[],t=0;d>t;t++)r.p[t]=0;for(r.c=[],t=0;u>t;t++){for(a={},a.n=[],n=0;n<4*o.patternLen;n++)a.n[n]=0;for(a.f=[],n=0;n<2*o.patternLen;n++)a.f[n]=0;r.c[t]=a}o.songData[e]=r}return o.songData[0].p[0]=1,o},Ee=function(e){var t=new CBinWriter;t.putULONG(e.rowLen),t.putUBYTE(e.endPattern-2),t.putUBYTE(e.patternLen);var n,r,a,o,i;for(n=0;8>n;n++){for(o=e.songData[n],t.putUBYTE(o.i[X]),t.putUBYTE(o.i[J]),t.putUBYTE(o.i[H]),t.putUBYTE(o.i[W]),t.putUBYTE(o.i[G]),t.putUBYTE(o.i[V]),t.putUBYTE(o.i[Q]),t.putUBYTE(o.i[Z]),t.putUBYTE(o.i[K]),t.putUBYTE(o.i[ee]),t.putUBYTE(o.i[te]),t.putUBYTE(o.i[ne]),t.putUBYTE(o.i[re]),t.putUBYTE(o.i[ae]),t.putUBYTE(o.i[oe]),t.putUBYTE(o.i[ie]),t.putUBYTE(o.i[se]),t.putUBYTE(o.i[fe]),t.putUBYTE(o.i[ce]),t.putUBYTE(o.i[de]),t.putUBYTE(o.i[ue]),t.putUBYTE(o.i[le]),t.putUBYTE(o.i[pe]),t.putUBYTE(o.i[me]),t.putUBYTE(o.i[ge]),t.putUBYTE(o.i[ve]),r=0;d>r;r++)t.putUBYTE(o.p[r]);for(r=0;u>r;r++){for(i=o.c[r],a=0;a<4*e.patternLen;a++)t.putUBYTE(i.n[a]);for(a=0;a<2*e.patternLen;a++)t.putUBYTE(i.f[a])}}var s,f,c=t.getData(),l=0;for(n=9;n>0;n--)if(s=RawDeflate.deflate(c,n),f=RawDeflate.inflate(s),c===f){l=2;break}return 0==l&&(s=rle_encode(t.getData()),f=rle_decode(s),c===f?l=1:s=c),t=new CBinWriter,t.putULONG(2020557395),t.putUBYTE(10),t.putUBYTE(l),t.append(s),t.getData()},we=function(e){var t=new CBinParser(e),n={},r=t.getULONG(),a=t.getUBYTE();if(2020557395!=r||1>a||a>10)return void 0;if(a>=8){var o,i=t.getUBYTE(),s=t.getTail();switch(i){default:case 0:o=s;break;case 1:o=rle_decode(s);break;case 2:o=RawDeflate.inflate(s)}t=new CBinParser(o)}n.rowLen=t.getULONG(),n.endPattern=t.getUBYTE()+2,n.patternLen=a>=10?t.getUBYTE():32,n.songData=[];var f,c,l,p,m;for(f=0;8>f;f++){p={},p.i=[],6>a?(p.i[H]=t.getUBYTE(),p.i[W]=t.getUBYTE(),p.i[J]=t.getUBYTE(),p.i[X]=t.getUBYTE()):(p.i[X]=t.getUBYTE(),p.i[J]=t.getUBYTE(),p.i[H]=t.getUBYTE(),p.i[W]=t.getUBYTE()),6>a?(p.i[Q]=t.getUBYTE(),p.i[Z]=t.getUBYTE(),p.i[K]=t.getUBYTE(),p.i[V]=t.getUBYTE(),p.i[G]=t.getUBYTE()):(p.i[G]=t.getUBYTE(),p.i[V]=t.getUBYTE(),p.i[Q]=t.getUBYTE(),p.i[Z]=t.getUBYTE(),p.i[K]=t.getUBYTE()),p.i[ee]=t.getUBYTE(),5>a?(p.i[te]=Math.round(Math.sqrt(t.getULONG())/2),p.i[ne]=Math.round(Math.sqrt(t.getULONG())/2),p.i[re]=Math.round(Math.sqrt(t.getULONG())/2)):(p.i[te]=t.getUBYTE(),p.i[ne]=t.getUBYTE(),p.i[re]=t.getUBYTE()),6>a?(p.i[fe]=t.getUBYTE(),p.i[ce]=5>a?Math.round(t.getUSHORT()/43.23529):t.getUBYTE(),p.i[de]=t.getUBYTE(),p.i[ve]=t.getUBYTE(),p.i[ge]=t.getUBYTE(),p.i[me]=t.getUBYTE(),p.i[pe]=t.getUBYTE(),p.i[ue]=t.getUBYTE(),p.i[le]=t.getUBYTE(),p.i[se]=t.getUBYTE(),p.i[ie]=t.getUBYTE(),p.i[oe]=t.getUBYTE(),p.i[ae]=t.getUBYTE()):(p.i[ae]=t.getUBYTE(),p.i[oe]=t.getUBYTE(),p.i[ie]=t.getUBYTE(),p.i[se]=t.getUBYTE(),p.i[fe]=t.getUBYTE(),p.i[ce]=t.getUBYTE(),p.i[de]=t.getUBYTE(),p.i[ue]=t.getUBYTE(),p.i[le]=t.getUBYTE(),p.i[pe]=t.getUBYTE(),p.i[me]=t.getUBYTE(),p.i[ge]=t.getUBYTE(),p.i[ve]=t.getUBYTE());var g=9>a?48:d;for(p.p=[],c=0;g>c;c++)p.p[c]=t.getUBYTE();for(c=g;d>c;c++)p.p[c]=0;var v=9>a?10:u;for(p.c=[],c=0;v>c;c++){if(m={},m.n=[],1==a)for(l=0;l<n.patternLen;l++)m.n[l]=t.getUBYTE(),m.n[l+n.patternLen]=0,m.n[l+2*n.patternLen]=0,m.n[l+3*n.patternLen]=0;else for(l=0;l<4*n.patternLen;l++)m.n[l]=t.getUBYTE();if(m.f=[],4>a)for(l=0;l<2*n.patternLen;l++)m.f[l]=0;else for(l=0;l<2*n.patternLen;l++)m.f[l]=t.getUBYTE();p.c[c]=m}for(c=v;u>c;c++){for(m={},m.n=[],l=0;l<4*n.patternLen;l++)m.n[l]=0;for(m.f=[],l=0;l<2*n.patternLen;l++)m.f[l]=0;p.c[c]=m}3>a&&(2==p.i[X]&&(p.i[J]=Math.round(p.i[J]/2)),2==p.i[G]&&(p.i[V]=Math.round(p.i[V]/2)),2==p.i[ae]&&(p.i[oe]=Math.round(p.i[oe]/2)),p.i[le]=p.i[le]<224?p.i[le]+32:255),7>a&&(p.i[de]=255-p.i[de]),n.songData[f]=p}return n},Be=function(e){if(3333!=e.length)return void 0;if((255&e.charCodeAt(3332))>48)return void 0;var t=new CBinParser(e),n={};n.rowLen=t.getULONG(),n.patternLen=32,n.songData=[];var r,a,o,i,s,f;for(r=0;8>r;r++){for(i={},i.i=[],i.i[H]=12*(t.getUBYTE()-8)+128,i.i[H]+=t.getUBYTE(),t.getUBYTE(),i.i[W]=t.getUBYTE(),i.i[J]=t.getUBYTE(),i.i[X]=t.getUBYTE(),i.i[Q]=12*(t.getUBYTE()-8)+128,i.i[Q]+=t.getUBYTE(),i.i[Z]=t.getUBYTE(),i.i[K]=t.getUBYTE(),i.i[V]=t.getUBYTE(),i.i[G]=t.getUBYTE(),i.i[ee]=t.getUBYTE(),t.getUBYTE(),t.getUBYTE(),t.getUBYTE(),i.i[te]=Math.round(Math.sqrt(t.getULONG())/2),i.i[ne]=Math.round(Math.sqrt(t.getULONG())/2),i.i[re]=Math.round(Math.sqrt(t.getULONG())/2),f=t.getUBYTE(),i.i[fe]=t.getUBYTE(),t.getUBYTE(),t.getUBYTE(),i.i[ce]=Math.round(t.getFLOAT()/43.23529),i.i[de]=255-t.getUBYTE(),i.i[ve]=t.getUBYTE(),i.i[ge]=t.getUBYTE(),i.i[me]=t.getUBYTE(),i.i[pe]=t.getUBYTE(),i.i[ue]=0,i.i[le]=32,t.getUBYTE(),i.i[se]=t.getUBYTE(),i.i[ie]=t.getUBYTE(),i.i[oe]=t.getUBYTE(),i.i[ae]=t.getUBYTE(),i.p=[],a=0;48>a;a++)i.p[a]=t.getUBYTE();for(a=48;d>a;a++)i.p[a]=0;for(i.c=[],a=0;10>a;a++){for(s={},s.n=[],o=0;32>o;o++)s.n[o]=t.getUBYTE(),s.n[o+32]=0,s.n[o+64]=0,s.n[o+96]=0;for(s.f=[],o=0;64>o;o++)s.f[o]=0;i.c[a]=s}for(a=10;u>a;a++){for(s={},s.n=[],o=0;128>o;o++)s.n[o]=0;for(s.f=[],o=0;64>o;o++)s.f[o]=0;i.c[a]=s}t.getUBYTE(),t.getUBYTE(),(i.i[fe]<1||i.i[fe]>3)&&(i.i[fe]=2,i.i[ce]=255),i.i[J]*=f/255,i.i[V]*=f/255,i.i[ee]*=f/255,2==i.i[X]&&(i.i[J]/=2),2==i.i[G]&&(i.i[V]/=2),2==i.i[ae]&&(i.i[oe]/=2),i.i[J]=Math.round(i.i[J]),i.i[V]=Math.round(i.i[V]),i.i[ee]=Math.round(i.i[ee]),i.i[oe]=Math.round(i.i[oe]),n.songData[r]=i}return n.endPattern=t.getUBYTE()+2,n},ye=function(e){var t=we(e);return t||(t=Be(e)),t?t:void alert("Song format not recognized.")},_e=function(e){var t,n,r,a,o="";for(o+="    // This music has been exported by SoundBox. You can use it with\n",o+="    // http://sb.bitsnbites.eu/player-small.js in your own product.\n\n",o+="    // See http://sb.bitsnbites.eu/demo.html for an example of how to\n",o+="    // use it in a demo.\n\n",o+="    // Song data\n",o+="    var song = {\n",o+="      songData: [\n",t=0;8>t;t++){var i=e.songData[t];o+="        { // Instrument "+t+"\n",o+="          i: [\n",o+="          "+i.i[X]+", // OSC1_WAVEFORM\n",o+="          "+i.i[J]+", // OSC1_VOL\n",o+="          "+i.i[H]+", // OSC1_SEMI\n",o+="          "+i.i[W]+", // OSC1_XENV\n",o+="          "+i.i[G]+", // OSC2_WAVEFORM\n",o+="          "+i.i[V]+", // OSC2_VOL\n",o+="          "+i.i[Q]+", // OSC2_SEMI\n",o+="          "+i.i[Z]+", // OSC2_DETUNE\n",o+="          "+i.i[K]+", // OSC2_XENV\n",o+="          "+i.i[ee]+", // NOISE_VOL\n",o+="          "+i.i[te]+", // ENV_ATTACK\n",o+="          "+i.i[ne]+", // ENV_SUSTAIN\n",o+="          "+i.i[re]+", // ENV_RELEASE\n",o+="          "+i.i[ae]+", // LFO_WAVEFORM\n",o+="          "+i.i[oe]+", // LFO_AMT\n",o+="          "+i.i[ie]+", // LFO_FREQ\n",o+="          "+i.i[se]+", // LFO_FX_FREQ\n",o+="          "+i.i[fe]+", // FX_FILTER\n",o+="          "+i.i[ce]+", // FX_FREQ\n",o+="          "+i.i[de]+", // FX_RESONANCE\n",o+="          "+i.i[ue]+", // FX_DIST\n",o+="          "+i.i[le]+", // FX_DRIVE\n",o+="          "+i.i[pe]+", // FX_PAN_AMT\n",o+="          "+i.i[me]+", // FX_PAN_FREQ\n",o+="          "+i.i[ge]+", // FX_DELAY_AMT\n",o+="          "+i.i[ve]+" // FX_DELAY_TIME\n",o+="          ],\n",o+="          // Patterns\n",o+="          p: [";var s=e.endPattern-2,f=0,c=0;for(n=0;s>=n;n++)a=i.p[n],a>f&&(f=a),a&&(c=n);for(n=0;c>=n;n++)a=i.p[n],a&&(o+=a),c>n&&(o+=",");for(o+="],\n",o+="          // Columns\n",o+="          c: [\n",n=0;f>n;n++){for(o+="            {n: [",c=0,r=0;r<4*e.patternLen;r++)i.c[n].n[r]&&(c=r);for(r=0;c>=r;r++){var d=i.c[n].n[r];d&&(o+=d),c>r&&(o+=",")}for(o+="],\n",o+="             f: [",c=0,r=0;r<2*e.patternLen;r++)i.c[n].f[r]&&(c=r);for(r=0;c>=r;r++){var u=i.c[n].f[r];u&&(o+=u),c>r&&(o+=",")}o+="]}",f-1>n&&(o+=","),o+="\n"}o+="          ]\n",o+="        }",7>t&&(o+=","),o+="\n"}return o+="      ],\n",o+="      rowLen: "+e.rowLen+",   // In sample lengths\n",o+="      patternLen: "+e.patternLen+",  // Rows per pattern\n",o+="      endPattern: "+e.endPattern+"  // End pattern\n",o+="    };\n"},be=function(e){var t=e.data[0]>>4,n=15&e.data[0],r=e.data[1],a=e.data[2];9!=n&&9==t&&a>0&&Xe(r-12)},Ie=function(e){o=a.inputs()[r.selectedIndex],o.onmidimessage=be},Le=function(e){a=e;var t,n="function"==typeof a.inputs?a.inputs():[],i=0;for(t=0;t<n.length;t++){var s=n[t].name.toString().toLowerCase();if(-1!=s.indexOf("keyboard")){i=t;break}}if(r.options.length=0,n.length){for(t=0;t<n.length;t++)r.options[t]=new Option(n[t].name,n[t].fingerprint,t==i,t==i);o=n[i],o.onmidimessage=be,r.onchange=Ie,r.style.display="inline"}},Te=function(e){},De=function(){navigator.requestMIDIAccess&&(r=document.getElementById("midiInput"),navigator.requestMIDIAccess().then(Le,Te))},Ue=function(){for(var e,t,n=document.getElementById("instrPreset"),r=0;r<gInstrumentPresets.length;++r)t=gInstrumentPresets[r],e=document.createElement("option"),e.value=t.i?""+r:"",e.appendChild(document.createTextNode(t.name)),n.appendChild(e)},xe=function(e){var t=0,n=0;if(e.offsetParent)do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return[t,n]},Ce=function(e){var t=null;return e||(e=window.event),e.target?t=e.target:e.srcElement&&(t=e.srcElement),3==t.nodeType&&(t=t.parentNode),t},Se=function(e,t){var n=[0,0];if(e.pageX&&e.pageY?n=[e.pageX,e.pageY]:e.clientX&&e.clientY?n=[e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.clientY+document.body.scrollTop+document.documentElement.scrollTop]:e.touches&&e.touches.length>0&&(n=[e.touches[0].clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.touches[0].clientY+document.body.scrollTop+document.documentElement.scrollTop]),!t)return n;var r=xe(Ce(e));return[n[0]-r[0],n[1]-r[1]]},Ye=function(){document.getElementById("bpm").blur(),document.getElementById("rpp").blur(),document.getElementById("instrPreset").blur()},ke=function(e){e!==l&&(l=e,document.getElementById("sequencer").className=l==s?"edit":"",document.getElementById("pattern").className=l==f?"edit":"",document.getElementById("fxtrack").className=l==c?"edit":"",l!=i&&(Ye(),Qe(),Ke()))},Me=function(){document.getElementById("bpm").value=F(),document.getElementById("rpp").value=S.patternLen},Ae=function(e,t){for(var n,r=0;d>r;++r)for(var a=0;8>a;++a){if(n=document.getElementById("sc"+a+"r"+r),!t){var o=S.songData[a].p[r];n.innerHTML=o>0?""+(10>=o?o-1:String.fromCharCode(64+o-10)):""}n.className=r>=w&&y>=r&&a>=E&&B>=a?"selected":""}if(e&&(n=document.getElementById("spr"+w),n.scrollIntoView)){var i=document.getElementById("sequencer"),s=n.offsetTop-i.scrollTop;(0>s||s+10>i.offsetHeight)&&n.scrollIntoView(0>s)}},Re=function(e,t){In();for(var n,r=E==B&&w==y,a=r?S.songData[E].p[w]-1:-1,o=0;o<S.patternLen;++o)for(var i=0;4>i;++i){if(n=document.getElementById("pc"+i+"r"+o),!t){var s="";if(a>=0){var f=S.songData[E].c[a].n[o+i*S.patternLen]-87;f>0&&(s=R[f%12]+Math.floor(f/12))}n.innerHTML!=s&&(n.innerHTML=s)}n.className=o>=g&&h>=o&&i>=m&&v>=i?"selected":""}if(e&r&&(n=document.getElementById("pc0r"+g),n.scrollIntoView)){var c=document.getElementById("pattern"),d=n.offsetTop-c.scrollTop;(0>d||d+10>c.offsetHeight)&&n.scrollIntoView(0>d)}},ze=function(e,t){for(var n=e.toString(16).toUpperCase(),r=t-n.length,a=0;r>a;++a)n="0"+n;return n},Oe=function(e,t){Ln();for(var n,r=E==B&&w==y,a=r?S.songData[E].p[w]-1:-1,o=0;o<S.patternLen;++o){if(n=document.getElementById("fxr"+o),!t){var i=":";if(a>=0){var s=S.songData[E].c[a].f[o];if(s){var f=S.songData[E].c[a].f[o+S.patternLen];i=ze(s,2)+":"+ze(f,2)}}n.innerHTML!=i&&(n.innerHTML=i)}n.className=o>=_&&b>=o?"selected":""}if(e&r&&(n=document.getElementById("fxr"+_),n.scrollIntoView)){var c=document.getElementById("fxtrack"),d=n.offsetTop-c.scrollTop;(0>d||d+10>c.offsetHeight)&&n.scrollIntoView(0>d)}},Pe=function(e,t){m=e,g=t,v=e,h=t;for(var n=0;n<S.patternLen;++n)for(var r=0;4>r;++r){var a=document.getElementById("pc"+r+"r"+n);a.className=n==t&&r==e?"selected":""}Re(!0,!0)},Ne=function(e,t){v=e>=m?e:m,h=t>=g?t:g;for(var n=0;n<S.patternLen;++n)for(var r=0;4>r;++r){var a=document.getElementById("pc"+r+"r"+n);a.className=n>=g&&h>=n&&r>=m&&v>=r?"selected":""}Re(!1,!0)},je=function(e,t){E=e,w=t,B=e,y=t,Ae(!0,!0)},$e=function(e,t){B=e>=E?e:E,y=t>=w?t:w,Ae(!1,!0)},qe=function(e){_=e,b=e;for(var t=0;t<S.patternLen;++t){var n=document.getElementById("fxr"+t);n.className=t>=_&&b>=t?"selected":""}Oe(!0,!0)},Fe=function(e){b=e>=_?e:_;for(var t=0;t<S.patternLen;++t){var n=document.getElementById("fxr"+t);n.className=t>=_&&b>=t?"selected":""}Oe(!1,!0)},Xe=function(e){var t=e+87;if(A.addNote(t),l==f&&E==B&&w==y&&m==v&&g==h){var n=S.songData[E].p[w]-1;if(n>=0)return S.songData[E].c[n].n[g+m*S.patternLen]=t,Pe(m,(g+1)%S.patternLen),Re(),!0}return!1},Je=function(e,t,n){n||(e.value=t)},He=function(e,t){$(e).prop("checked",!!t)},We=function(){var e=document.getElementById("instrPreset");e.selectedIndex=0},Ge=function(e,t){$("[name='"+e+"'][value='"+t+"']").attr("checked","checked").parent().addClass("active").siblings().removeClass("active")},Ve=function(e){var t=S.songData[E];Ge("osc1_wave",t.i[X]),Je(document.getElementById("osc1_vol"),t.i[J]),Je(document.getElementById("osc1_semi"),t.i[H]),He(document.getElementById("osc1_xenv"),t.i[W]),Ge("osc2_wave",t.i[G]),Je(document.getElementById("osc2_vol"),t.i[V]),Je(document.getElementById("osc2_semi"),t.i[Q]),Je(document.getElementById("osc2_det"),t.i[Z]),He(document.getElementById("osc2_xenv"),t.i[K]),Je(document.getElementById("noise_vol"),t.i[ee]),Je(document.getElementById("env_att"),t.i[te]),Je(document.getElementById("env_sust"),t.i[ne]),Je(document.getElementById("env_rel"),t.i[re]),Ge("lfo_wave",t.i[ae]),Je(document.getElementById("lfo_amt"),t.i[oe]),Je(document.getElementById("lfo_freq"),t.i[ie]),He(document.getElementById("lfo_fxfreq"),t.i[se]),Ge("fx_filt",t.i[fe]),Je(document.getElementById("fx_freq"),t.i[ce]),Je(document.getElementById("fx_res"),t.i[de]),Je(document.getElementById("fx_dly_amt"),t.i[ge]),Je(document.getElementById("fx_dly_time"),t.i[ve]),Je(document.getElementById("fx_pan_amt"),t.i[pe]),Je(document.getElementById("fx_pan_freq"),t.i[me]),Je(document.getElementById("fx_dist"),t.i[ue]),Je(document.getElementById("fx_drive"),t.i[le]),e&&We(),A.updateInstr(t.i)},Qe=function(){var e=parseInt(document.getElementById("bpm").value);e&&e>=10&&1e3>=e&&(S.rowLen=q(e),A.updateRowLen(S.rowLen))},Ze=function(e){if(S.patternLen!==e){gt();var t,n,r,a,o,i;for(t=0;8>t;t++)for(n=0;u>n;n++){for(a=S.songData[t].c[n],o=[],i=[],r=0;4*e>r;r++)o[r]=0;for(r=0;2*e>r;r++)i[r]=0;for(r=0;r<Math.min(S.patternLen,e);r++)o[r]=a.n[r],o[r+e]=a.n[r+S.patternLen],o[r+2*e]=a.n[r+2*S.patternLen],o[r+3*e]=a.n[r+3*S.patternLen],i[r]=a.f[r],i[r+e]=a.f[r+S.patternLen];a.n=o,a.f=i}S.patternLen=e}},Ke=function(){var e=parseInt(document.getElementById("rpp").value);e&&e>=1&&256>=e&&(Ze(e),In(),Ln(),Re(),Oe())},et=function(){var e,t,n;for(S.endPattern=d+1,e=d-1;e>=0;--e){for(n=!0,t=0;8>t;++t)if(S.songData[t].p[e]>0){n=!1;break}if(!n)break;S.endPattern--}Qe()},tt=function(e){var t=$("#modal-progress"),n=$("#modal-progressLabel"),r=$("#progressBar");n.text(e),r.css("width","0%"),t.modal()},nt=function(e){var t=ye(e);t&&(gt(),S=t,Me(),Ae(),Re(),Oe(),Ve(!0))},rt=function(){var e=$("#modal-open"),t=e.find(".modal-body"),n=t.find("form").get(0);n.innerHTML="";for(var r=document.createElement("div"),a=0;a<gDemoSongs.length;a++){var o=$("<div />",{"class":"radio"}),i=$("<label />");i.append($("<input/>",{type:"radio",name:"radiogroup1",value:gDemoSongs[a].name,checked:0===a})).append($("<span/>",{html:gDemoSongs[a].description})),o.append(i),r.appendChild(o.get(0))}o=$("<div />",{"class":"radio"}),i=$("<label />"),i.append($("<input/>",{type:"radio",name:"radiogroup1",value:"custom",id:"open-custom-radio"})).append($("<span/>",{html:"Data URL:"})),o.append(i),r.appendChild(o.get(0));var s=document.createElement("input");s.type="text",s.className="form-control input-sm",s.id="open-data-url",s.title="Paste a saved song data URL here",s.placeholder=s.title,s.onchange=function(){$("#open-custom-radio").prop("checked",!0)},s.onkeydown=s.onchange,s.onclick=s.onchange,s.onpaste=s.onchange,r.appendChild(s),n.appendChild(r),e.modal()},at=function(e){e.preventDefault();var t=null,n=$("#modal-open"),r=n.find(":radio:checked");if(r&&r.length){if("custom"==r.val()){var a=P($("#open-data-url").val());t=N(a&&a.data&&a.data[0])}else for(var o=r.val(),i=0;i<gDemoSongs.length;i++)if(gDemoSongs[i].name===o){t=gDemoSongs[i].data?gDemoSongs[i].data:N(gDemoSongs[i].base64);break}t&&nt(t),n.modal("hide")}},ot=function(){var e=$("#modal-save"),t=$("#save-song-data"),n=$("#save-song-button"),r=j(Ee(S)),a=r.length<70?r:r.slice(0,67)+"...";t.attr("title",r),t.attr("href",r),t.text(a),n.on("click",function(t){t.preventDefault();var n="data:application/octet-stream;base64,"+btoa(Ee(S));window.open(n),e.modal("hide")}),e.modal()},it=function(){$("#modal-about").modal()},st=function(e){e.preventDefault(),it()},ft=function(e){return S=he(),Me(),Ae(),Re(),Oe(),Ve(),ke(f),Pe(0,0),je(0,0),qe(0),!1},ct=function(e){e.preventDefault(),rt()},dt=function(e){et(),ot(),e.preventDefault()},ut=function(e){e.preventDefault(),et();var t=function(e){var t=new Blob([e],{type:"application/octet-stream"});saveAs(t,"rendered.wav")};mt(t)},lt=function(e){et();var t="data:text/javascript;base64,"+btoa(_e(S));return window.open(t),!1},pt=function(e){document.getElementById("statusText").innerHTML=e},mt=function(e,t){tt("Generating sound...");var n=new Date;M=new CPlayer,M.generate(S,t,function(t){var r=document.getElementById("progressBar");if(r.style.width=Math.floor(100*t)+"%",t>=1){var a=M.createWave(),o=new Date;pt("Generation time: "+(o.getTime()-n.getTime())/1e3+"s"),$("#modal-progress").modal("hide"),e(a)}})},gt=function(){var e=$(".led");e.css("opacity",0),Ut(),Y&&(Y.pause(),k.reset())},vt=-1,ht=0,Et=0,wt=0,Bt=0,yt=!1,_t=0,bt=0,It=function(e,t){for(var n=44100*e/S.rowLen,r=Math.floor(n),a=Math.floor(r/S.patternLen)+ht,o=r%S.patternLen,i=0;i<S.patternLen;++i){for(var s=a,f=o-i;0>f;){if(--s,ht>s)return-1;f+=S.patternLen}for(var c=S.songData[t].p[s]-1,d=0;4>d;d++)if(c>=0&&S.songData[t].c[c].n[f+d*S.patternLen]>0)return(i+(n-r))*S.rowLen}return-1},Lt=function(e){var t=0,n=0;if(yt&&e>=0){var r,a,o,i=M.getData(e,1e3),s=0,f=0,c=0,d=0;for(r=1;r<i.length;r+=2)a=i[r-1],o=i[r],s=.8*a+.1*s-.3*c,f=.8*o+.1*f-.3*d,c=a,d=o,t+=s*s,n+=f*f;t=.2*Math.sqrt(t/i.length)+.8*_t,n=.2*Math.sqrt(n/i.length)+.8*bt,_t=t,bt=n}Tn.css("width",Math.min(Math.floor(100*t*5),100)+"%"),Dn.css("width",Math.min(Math.floor(100*n*5),100)+"%");var u=$(".led");for(r=0;8>r;++r)if(r>=wt&&Bt>=r){var l=S.songData[r].i[te],p=S.songData[r].i[ne],m=S.songData[r].i[re];l=l*l*4,m=p*p*4+m*m*4;var g=l+m;1e4>g&&(g=1e4,m=g-l);var v=It(e,r);if(v>=0&&g>v){var h;h=l>v?v/l:1-(v-l)/m,u.eq(r).css("opacity",h)}}},Tt=function(){if(null!=Y){var e,t,n=k.currentTime();if(Y.ended||Y.duration&&Y.duration-n<.1)return Ut(),g=0,h=0,Re(),_=0,b=0,void Oe();var r=Math.floor(44100*n/S.rowLen),a=Math.floor(r/S.patternLen)+ht,o=r%S.patternLen,i=a!=w,s=i||o!=g;if(i)for(a>=0&&(w=a,y=a,Ae(!0,!0)),e=0;d>e;++e)t=document.getElementById("spr"+e),t.className=e==a?"playpos":"";if(s)for(o>=0&&(g=o,h=o,Re(!0,!i),_=o,b=o,Oe(!0,!i)),e=0;e<S.patternLen;++e)t=document.getElementById("ppr"+e),t.className=e==o?"playpos":"";Lt(n)}},Dt=function(){w=ht,y=ht,B=E,Ae(!0,!0),Re(),Oe(),yt=!0,vt=setInterval(Tt,16)},Ut=function(){if(yt){-1!==vt&&(clearInterval(vt),
vt=-1);var e;for(e=0;d>e;++e)document.getElementById("spr"+e).className="";for(e=0;e<S.patternLen;++e)document.getElementById("ppr"+e).className="";Lt(-1),yt=!1}},xt=function(e){e||(e=window.event),e.preventDefault(),gt(),et(),ht=0,Et=S.endPattern-2,wt=0,Bt=7;var t=function(e){if(null==Y)return void alert("Audio element unavailable.");try{Dt(),Y.src=URL.createObjectURL(new Blob([e],{type:"audio/wav"})),k.reset(),Y.play()}catch(t){alert("Error playing: "+t.message)}};mt(t)},Ct=function(e){e||(e=window.event),e.preventDefault(),gt(),et();var t={firstRow:w,lastRow:y,firstCol:E,lastCol:B};ht=w,Et=y,wt=E,Bt=B;var n=function(e){if(null==Y)return void alert("Audio element unavailable.");try{Dt(),Y.src=URL.createObjectURL(new Blob([e],{type:"audio/wav"})),Y.play(),k.reset()}catch(t){alert("Error playing: "+t.message)}};mt(n,t)},St=function(e){return e||(e=window.event),e.preventDefault(),null==Y?void alert("Audio element unavailable."):void gt()},Yt=function(e){return ke(i),!0},kt=function(e){return ke(i),!0},Mt=function(e){return ke(i),!0},At=function(e){if(e=e||window.event,e.preventDefault(),E==B){C=[];for(var t=S.songData[E],n=0;n<=t.i.length;++n)C[n]=t.i[n]}},Rt=function(e){if(e=e||window.event,e.preventDefault(),E==B&&C.length>0){var t=S.songData[E];t.i=[];for(var n=0;n<=C.length;++n)t.i[n]=C[n]}Ve(!0)},zt=function(e){if(e=e||window.event,e.preventDefault(),w==y&&E==B){var t=S.songData[E].p[w]-1;if(t>=0){U=[];for(var n=g;h>=n;++n){for(var r=[],a=m;v>=a;++a)r.push(S.songData[E].c[t].n[n+a*S.patternLen]);U.push(r)}}}},Ot=function(e){if(e=e||window.event,e.preventDefault(),w==y&&E==B){var t=S.songData[E].p[w]-1;if(t>=0){for(var n=g,r=0;n<S.patternLen&&r<U.length;++n,++r)for(var a=m,o=0;4>a&&o<U[r].length;++a,++o)S.songData[E].c[t].n[n+a*S.patternLen]=U[r][o];Re()}}},Pt=function(e){if(e=e||window.event,e.preventDefault(),w==y&&E==B){var t=S.songData[E].p[w]-1;if(t>=0){for(var n=g;h>=n;++n)for(var r=m;v>=r;++r){var a=S.songData[E].c[t].n[n+r*S.patternLen];a>0&&(S.songData[E].c[t].n[n+r*S.patternLen]=a+1)}Re()}}},Nt=function(e){if(e=e||window.event,e.preventDefault(),w==y&&E==B){var t=S.songData[E].p[w]-1;if(t>=0){for(var n=g;h>=n;++n)for(var r=m;v>=r;++r){var a=S.songData[E].c[t].n[n+r*S.patternLen];a>1&&(S.songData[E].c[t].n[n+r*S.patternLen]=a-1)}Re()}}},jt=function(e){if(e=e||window.event,e.preventDefault(),w==y&&E==B){var t=S.songData[E].p[w]-1;if(t>=0){for(var n=g;h>=n;++n)for(var r=m;v>=r;++r){var a=S.songData[E].c[t].n[n+r*S.patternLen];a>0&&(S.songData[E].c[t].n[n+r*S.patternLen]=a+12)}Re()}}},$t=function(e){if(e=e||window.event,e.preventDefault(),w==y&&E==B){var t=S.songData[E].p[w]-1;if(t>=0){for(var n=g;h>=n;++n)for(var r=m;v>=r;++r){var a=S.songData[E].c[t].n[n+r*S.patternLen];a>12&&(S.songData[E].c[t].n[n+r*S.patternLen]=a-12)}Re()}}},qt=function(e){e=e||window.event,e.preventDefault(),D=[];for(var t=w;y>=t;++t){for(var n=[],r=E;B>=r;++r)n.push(S.songData[r].p[t]);D.push(n)}},Ft=function(e){e=e||window.event,e.preventDefault();for(var t=w,n=0;d>t&&n<D.length;++t,++n)for(var r=E,a=0;8>r&&a<D[n].length;++r,++a)S.songData[r].p[t]=D[n][a];Ae()},Xt=function(e){e=e||window.event,e.preventDefault();for(var t=w;y>=t;++t)for(var n=E;B>=n;++n){var r=S.songData[n].p[t];u>r&&(S.songData[n].p[t]=r+1)}Ae(),Re(),Oe()},Jt=function(e){e=e||window.event,e.preventDefault();for(var t=w;y>=t;++t)for(var n=E;B>=n;++n){var r=S.songData[n].p[t];r>0&&(S.songData[n].p[t]=r-1)}Ae(),Re(),Oe()},Ht=function(e){if(e=e||window.event,e.preventDefault(),w==y&&E==B){var t=S.songData[E].p[w]-1;if(t>=0){x=[];for(var n=_;b>=n;++n){var r=[];r.push(S.songData[E].c[t].f[n]),r.push(S.songData[E].c[t].f[n+S.patternLen]),x.push(r)}}}},Wt=function(e){if(e=e||window.event,e.preventDefault(),w==y&&E==B){var t=S.songData[E].p[w]-1;if(t>=0){for(var n=_,r=0;n<S.patternLen&&r<x.length;++n,++r){var a=x[r];S.songData[E].c[t].f[n]=a[0],S.songData[E].c[t].f[n+S.patternLen]=a[1]}Oe()}}},Gt=function(e){if(e=e||window.event,e.preventDefault(),E==B){var t=Ce(e),n=-1;"osc1_xenv"===t.id?n=W:"osc2_xenv"===t.id?n=K:"lfo_fxfreq"===t.id&&(n=se);var r;if(n>=0&&(r=+$(t).is(":checked"),S.songData[E].i[n]=r),l==c&&w==y&&_==b&&n){var a=S.songData[E].p[w]-1;a>=0&&(S.songData[E].c[a].f[_]=n+1,S.songData[E].c[a].f[_+S.patternLen]=r,Oe())}Ve(!0),Ye()}},Vt=function(e){if(e=e||window.event,e.preventDefault(),E==B){var t=e.currentTarget.value;if(l==c&&w==y&&_==b){var n=S.songData[E].p[w]-1;n>=0&&(S.songData[E].c[n].f[_]=X+1,S.songData[E].c[n].f[_+S.patternLen]=t,Oe())}S.songData[E].i[X]=t,Ve(),Ye()}},Qt=function(e){if(e=e||window.event,e.preventDefault(),E==B){var t=e.currentTarget.value;if(l==c&&w==y&&_==b){var n=S.songData[E].p[w]-1;n>=0&&(S.songData[E].c[n].f[_]=G+1,S.songData[E].c[n].f[_+S.patternLen]=t,Oe())}S.songData[E].i[G]=t,Ve(!0),Ye()}},Zt=function(e){if(e=e||window.event,e.preventDefault(),E==B){var t=e.currentTarget.value;if(l==c&&w==y&&_==b){var n=S.songData[E].p[w]-1;n>=0&&(S.songData[E].c[n].f[_]=ae+1,S.songData[E].c[n].f[_+S.patternLen]=t,Oe())}S.songData[E].i[ae]=t,Ve(!0),Ye()}},Kt=function(e){if(e=e||window.event,e.preventDefault(),E==B){var t=e.currentTarget.value;if(l==c&&w==y&&_==b){var n=S.songData[E].p[w]-1;n>=0&&(S.songData[E].c[n].f[_]=fe+1,S.songData[E].c[n].f[_+S.patternLen]=t,Oe())}S.songData[E].i[fe]=t,Ve(!0),Ye()}},en=function(e){e=e||window.event,e.preventDefault(),8>p&&(p++,document.getElementById("keyboardOctave").innerHTML=""+p)},tn=function(e){e=e||window.event,e.preventDefault(),p>1&&(p--,document.getElementById("keyboardOctave").innerHTML=""+p)},nn=function(e){if(e=e||window.event,e.preventDefault(),E==B){var t=Ce(e),n=t.options[t.selectedIndex].value;if(""!==n&&(n=parseInt(n))){for(var r=gInstrumentPresets[n],a=0;a<r.i.length;++a)S.songData[E].i[a]=r.i[a];Ve(!1)}}},rn=function(e){e=e||window.event;var t=Se(e,!0),n=0;if(t[1]<68)for(var r=0;r<z.length;r+=2)if(t[0]>=z[r]-10&&t[0]<=z[r]+10){n=z[r+1];break}if(!n){n=2*Math.floor(14*t[0]/420);var a=0;n>=20&&a++,n>=14&&a++,n>=6&&a++,n-=a}Xe(n+12*p)&&e.preventDefault()},an=function(e){if(e||(e=window.event),e.preventDefault(),!yt){var t=Ce(e),n=parseInt(t.id.slice(3));qe(n),T=!0}ke(c)},on=function(e){if(T){e=e||window.event,e.preventDefault();var t=Ce(e),n=parseInt(t.id.slice(3));Fe(n)}},sn=function(e){if(T){e=e||window.event,e.preventDefault();var t=Ce(e),n=parseInt(t.id.slice(3));Fe(n),T=!1}},fn=function(e){if(e=e||window.event,e.preventDefault(),!yt){var t=Ce(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4));Pe(n,r),L=!0}ke(f)},cn=function(e){if(L){e=e||window.event,e.preventDefault();var t=Ce(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4));Ne(n,r)}},dn=function(e){if(L){e=e||window.event,e.preventDefault();var t=Ce(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4));Ne(n,r),L=!1}},un=function(e){e=e||window.event,e.preventDefault();var t,n=Ce(e),r=parseInt(n.id.slice(2,3));t=yt?w:parseInt(n.id.slice(4));var a=r!=E||E!=B;je(r,t),yt||(I=!0),ke(s),Re(),Oe(),Ve(a)},ln=function(e){if(I){e=e||window.event,e.preventDefault();var t=Ce(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4));$e(n,r),Re(),Oe(),Ve(!0)}},pn=function(e){if(I){e=e||window.event,e.preventDefault();var t=Ce(e),n=parseInt(t.id.slice(2,3)),r=parseInt(t.id.slice(4)),a=n!=B||E!=B;$e(n,r),I=!1,Re(),Oe(),Ve(a)}},mn=null,gn=function(e){E==B&&(e=e||window.event,mn=Ce(e),Ye())},vn=function(e){if(e=e||window.event,e.preventDefault(),mn){var t=Se(e,!1),n=xe(mn.parentNode),r=t[0]-6-n[0];r=0>r?0:r>191?1:r/191,mn.sliderProps.nonLinear&&(r*=r);var a=mn.sliderProps.min,o=mn.sliderProps.max;r=Math.round(a+(o-a)*r),"INPUT"==mn.tagName&&(r=mn.value);var i=-1;"osc1_vol"==mn.id?i=J:"osc1_semi"==mn.id?i=H:"osc2_vol"==mn.id?i=V:"osc2_semi"==mn.id?i=Q:"osc2_det"==mn.id?i=Z:"noise_vol"==mn.id?i=ee:"env_att"==mn.id?i=te:"env_sust"==mn.id?i=ne:"env_rel"==mn.id?i=re:"lfo_amt"==mn.id?i=oe:"lfo_freq"==mn.id?i=ie:"fx_freq"==mn.id?i=ce:"fx_res"==mn.id?i=de:"fx_dist"==mn.id?i=ue:"fx_drive"==mn.id?i=le:"fx_pan_amt"==mn.id?i=pe:"fx_pan_freq"==mn.id?i=me:"fx_dly_amt"==mn.id?i=ge:"fx_dly_time"==mn.id&&(i=ve);var s=S.songData[E];if(l==c&&_==b&&w==y&&E==B){var f=S.songData[E].p[w]-1;f>=0&&(S.songData[E].c[f].f[_]=i+1,S.songData[E].c[f].f[_+S.patternLen]=r,Oe())}i>=0&&(s.i[i]=r),A.updateInstr(s.i),We()}},hn=function(e){},En=function(e){e=e||window.event;var t,n,r,a=document.activeElement===document.getElementById("bpm")||document.activeElement===document.getElementById("rpp");if(l==s&&E==B&&w==y){if(e.keyCode>=48&&e.keyCode<=57)return S.songData[E].p[w]=e.keyCode-47,Ae(),Re(),Oe(),!1;if(e.keyCode>=64&&e.keyCode<=90)return S.songData[E].p[w]=e.keyCode-54,Ae(),Re(),Oe(),!1}if(l!=s&&!a){switch(r=-1,e.keyCode){case 90:r=0;break;case 83:r=1;break;case 88:r=2;break;case 68:r=3;break;case 67:r=4;break;case 86:r=5;break;case 71:r=6;break;case 66:r=7;break;case 72:r=8;break;case 78:r=9;break;case 74:r=10;break;case 77:r=11;break;case 188:r=12;break;case 76:r=13;break;case 190:r=14;break;case 186:r=15;break;case 191:r=16;break;case 81:r=12;break;case 50:r=13;break;case 87:r=14;break;case 51:r=15;break;case 69:r=16;break;case 82:r=17;break;case 53:r=18;break;case 84:r=19;break;case 54:r=20;break;case 89:r=21;break;case 55:r=22;break;case 85:r=23;break;case 73:r=24;break;case 57:r=25;break;case 79:r=26;break;case 48:r=27;break;case 80:r=28}if(r>=0&&Xe(r+12*p))return!1}var o;switch(e.keyCode){case 39:if(l==s)return je((E+1)%8,w),Re(),Oe(),Ve(!0),!1;if(l==f)return Pe((m+1)%4,g),!1;break;case 37:if(l==s)return je((E-1+8)%8,w),Re(),Oe(),Ve(!0),!1;if(l==f)return Pe((m-1+4)%4,g),!1;break;case 40:if(l==s)return je(E,(w+1)%d),Re(),Oe(),!1;if(l==f)return Pe(m,(g+1)%S.patternLen),!1;if(l==c)return qe((_+1)%S.patternLen),!1;break;case 38:if(l==s)return je(E,(w-1+d)%d),Re(),Oe(),!1;if(l==f)return Pe(m,(g-1+S.patternLen)%S.patternLen),!1;if(l==c)return qe((_-1+S.patternLen)%S.patternLen),!1;break;case 36:if(l==s)return je(E,0),Re(),Oe(),!1;if(l==f)return Pe(m,0),!1;if(l==c)return qe(0),!1;break;case 35:if(l==s)return je(E,d-1),Re(),Oe(),!1;if(l==f)return Pe(m,S.patternLen-1),!1;if(l==c)return qe(S.patternLen-1),!1;break;case 32:if(l!=i)return Ct(e),!1;break;case 8:case 46:if(l==s){for(t=w;y>=t;++t)for(n=E;B>=n;++n)S.songData[n].p[t]=0;return Ae(),Re(),Oe(),!1}if(l==f){if(w==y&&E==B){if(o=S.songData[E].p[w]-1,o>=0){for(t=g;h>=t;++t)for(n=m;v>=n;++n)S.songData[E].c[o].n[t+n*S.patternLen]=0;g==h&&Pe(m,(g+1)%S.patternLen),Re()}return!1}}else if(l==c&&w==y&&E==B){if(o=S.songData[E].p[w]-1,o>=0){for(t=_;b>=t;++t)S.songData[E].c[o].f[t]=0,S.songData[E].c[o].f[t+S.patternLen]=0;_==b&&qe((_+1)%S.patternLen),Oe()}return!1}break;case 13:a&&(Qe(),Ke(),document.getElementById("bpm").blur(),document.getElementById("rpp").blur())}return!0},wn=function(e){e=e||window.event,e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;if(t.length&&1!=t.length)return void alert("Only open one file at a time.");var n=t[0],r=new FileReader;r.onload=function(e){nt(N(e.target.result))},r.readAsDataURL(n)},Bn=function(){document.onmousedown=null,document.addEventListener("mousemove",vn,!1),document.addEventListener("touchmove",vn,!1),document.addEventListener("mouseup",hn,!1),document.addEventListener("touchend",hn,!1),document.onkeydown=En;var e=document.body.parentNode;e.addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("drop",wn,!1)},yn=function(){for(var e,t,n,r=document.getElementById("sequencer-table"),a=0;d>a;a++){e=document.createElement("tr"),a%4===0&&(e.className="beat"),t=document.createElement("th"),t.id="spr"+a,t.textContent=""+a,e.appendChild(t);for(var o=0;8>o;o++)n=document.createElement("td"),n.id="sc"+o+"r"+a,n.textContent=" ",n.addEventListener("mousedown",un,!1),n.addEventListener("mouseover",ln,!1),n.addEventListener("mouseup",pn,!1),e.appendChild(n);r.appendChild(e)}},_n=function(e){for(var t=1;t<e.children.length&&"beat"!==e.children[t].className;)t++;return t},bn=function(){var e=F(),t=4;return S.patternLen%3===0?t=3:S.patternLen%4===0?t=4:S.patternLen%2===0?t=2:S.patternLen%5===0&&(t=5),e/t>=40&&S.patternLen>24&&S.patternLen%(2*t)===0&&(t*=2),t},In=function(){var e=bn(),t=document.getElementById("pattern-table");if(t.children.length!==S.patternLen||_n(t)!==e){for(;t.firstChild;)t.removeChild(t.firstChild);for(var n,r,a,o=0;o<S.patternLen;o++){n=document.createElement("tr"),o%e===0&&(n.className="beat"),r=document.createElement("th"),r.id="ppr"+o,r.textContent=""+o,n.appendChild(r);for(var i=0;4>i;i++)a=document.createElement("td"),a.id="pc"+i+"r"+o,a.textContent=" ",a.addEventListener("mousedown",fn,!1),a.addEventListener("mouseover",cn,!1),a.addEventListener("mouseup",dn,!1),n.appendChild(a);t.appendChild(n)}}},Ln=function(){var e=bn(),t=document.getElementById("fxtrack-table");if(t.children.length!==S.patternLen||_n(t)!==e){for(;t.firstChild;)t.removeChild(t.firstChild);for(var n,r,a=0;a<S.patternLen;a++)n=document.createElement("tr"),a%e===0&&(n.className="beat"),r=document.createElement("td"),r.id="fxr"+a,r.textContent=String.fromCharCode(160),r.addEventListener("mousedown",an,!1),r.addEventListener("mouseover",on,!1),r.addEventListener("mouseup",sn,!1),n.appendChild(r),t.appendChild(n)}},Tn=$("#pan-left"),Dn=$("#pan-right");this.init=function(){$(".knob").knob({inline:!1,width:50,height:50,bgColor:"#2b3e50",fgColor:"#df691a",inputColor:"#ebebeb",angleOffset:-125,angleArc:250,cursor:10}),$("input[type=range]").rsSlider({}),t=O(window.location.href),n=P(window.location.href),Ue(),yn(),document.getElementById("osc1_vol").sliderProps={min:0,max:255},document.getElementById("osc1_semi").sliderProps={min:92,max:164},document.getElementById("osc2_vol").sliderProps={min:0,max:255},document.getElementById("osc2_semi").sliderProps={min:92,max:164},document.getElementById("osc2_det").sliderProps={min:0,max:255,nonLinear:!0},document.getElementById("noise_vol").sliderProps={min:0,max:255},document.getElementById("env_att").sliderProps={min:0,max:255},document.getElementById("env_sust").sliderProps={min:0,max:255},document.getElementById("env_rel").sliderProps={min:0,max:255},document.getElementById("lfo_amt").sliderProps={min:0,max:255},document.getElementById("lfo_freq").sliderProps={min:0,max:16},document.getElementById("fx_freq").sliderProps={min:0,max:255,nonLinear:!0},document.getElementById("fx_res").sliderProps={min:0,max:254},document.getElementById("fx_dist").sliderProps={min:0,max:255,nonLinear:!0},document.getElementById("fx_drive").sliderProps={min:0,max:255},document.getElementById("fx_pan_amt").sliderProps={min:0,max:255},document.getElementById("fx_pan_freq").sliderProps={min:0,max:16},document.getElementById("fx_dly_amt").sliderProps={min:0,max:255},document.getElementById("fx_dly_time").sliderProps={min:0,max:16};try{Y=new Audio,k.setAudioElement(Y),Y.addEventListener("canplay",function(){this.play()},!0)}catch(r){Y=null}var a=N(n&&n.data&&n.data[0]),o=a?ye(a):null;S=o?o:he(),Me(),Ae(),Re(),Oe(),Ve(!0),ke(f),je(0,0),Pe(0,0),$("#logo").on("click",st),$("#newSong").on("click",ft),$("#openSong").on("click",ct),$("#openMidi").on("click",e),$("#saveSong").on("click",dt),$("#exportJS").on("click",lt),$("#exportWAV").on("click",ut),$("#playSong").on("click",xt),$("#playRange").on("click",Ct),$("#stopPlaying").on("click",St),$("#about").on("click",st),document.getElementById("bpm").onfocus=Yt,document.getElementById("rpp").onfocus=kt,document.getElementById("sequencerCopy").onmousedown=qt,document.getElementById("sequencerPaste").onmousedown=Ft,document.getElementById("sequencerPatUp").onmousedown=Xt,document.getElementById("sequencerPatDown").onmousedown=Jt,document.getElementById("patternCopy").onmousedown=zt,document.getElementById("patternPaste").onmousedown=Ot,document.getElementById("patternNoteUp").onmousedown=Pt,document.getElementById("patternNoteDown").onmousedown=Nt,document.getElementById("patternOctaveUp").onmousedown=jt,document.getElementById("patternOctaveDown").onmousedown=$t,document.getElementById("fxCopy").onmousedown=Ht,document.getElementById("fxPaste").onmousedown=Wt,document.getElementById("instrPreset").onfocus=Mt,document.getElementById("instrPreset").onchange=nn,$("[name=osc1_wave]").on("change",Vt),$("#osc1_vol").rsSlider("change",gn),$("#osc1_semi").rsSlider("change",gn),$("#osc1_xenv").on("change",Gt),$("[name=osc2_wave]").on("change",Qt),$("#osc2_vol").rsSlider("change",gn),$("#osc2_semi").rsSlider("change",gn),$("#osc2_det").rsSlider("change",gn),$("#osc2_xenv").on("change",Gt),$("#noise_vol").rsSlider("change",gn),$("#env_att").rsSlider("change",gn),$("#env_sust").rsSlider("change",gn),$("#env_rel").rsSlider("change",gn),$("[name=lfo_wave]").on("change",Zt),$("#lfo_amt").rsSlider("change",gn),$("#lfo_freq").rsSlider("change",gn),$("#lfo_fxfreq").on("change",Gt),$("[name=fx_filt]").on("change",Kt),$("#fx_freq").rsSlider("change",gn),$("#fx_res").rsSlider("change",gn),$("#fx_dly_amt").rsSlider("change",gn),$("#fx_dly_time").rsSlider("change",gn),$("#fx_pan_amt").rsSlider("change",gn),$("#fx_pan_freq").rsSlider("change",gn),$("#fx_dist").rsSlider("change",gn),$("#fx_drive").rsSlider("change",gn),document.getElementById("octaveDown").addEventListener("mousedown",tn,!1),document.getElementById("octaveDown").addEventListener("touchstart",tn,!1),document.getElementById("octaveUp").addEventListener("mousedown",en,!1),document.getElementById("octaveUp").addEventListener("touchstart",en,!1),document.getElementById("keyboard").addEventListener("mousedown",rn,!1),document.getElementById("keyboard").addEventListener("touchstart",rn,!1),document.getElementById("instrCopy").onmousedown=At,document.getElementById("instrPaste").onmousedown=Rt,$("#open-song-button").on("click",at),De(),Bn(),a||it(),A.start(),A.updateRowLen(S.rowLen),$("body").addClass("loaded")}};$(function(){try{var e=new CGUI;e.init()}catch(t){alert("Unexpected error: "+t.message)}});